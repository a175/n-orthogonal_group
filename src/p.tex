% !TeX root =./x2.tex
% !TeX program = pdfLaTeX
\chapter{準備}
ここでは, 線形代数の基本的な事項について復習する.
この原稿を通して使う基本的な用語や記号を定義することが主な目的であり,
必要最低限の準備をするため, 証明などは他の文献に任せる.
\section{線型写像に関する用語など}
本稿では,
特に断らない限り,
$V$は$n$次元ユークリッド空間を表すとし,
内積は $\Braket{\bullet,\bullet}$で表し,
ノルムは$\|\bullet \|$で表すとする.
つまり,
\begin{align*}
  V&=\RR^n\\
  &=\Set{\begin{pmatrix}\alpha_1\\\vdots\\\alpha_n\end{pmatrix} | \alpha_i \in \RR}.
\end{align*}
とする, ただし, $\RR$は実数全体のなす集合とする.
また, 
\begin{align*}
  \alpha=\begin{pmatrix}\alpha_1\\\vdots\\\alpha_n\end{pmatrix},\quad
  \beta=\begin{pmatrix}\beta_1\\\vdots\\\beta_n\end{pmatrix}\in V
\end{align*}
に対し,
\begin{align*}
\Braket{\alpha,\beta}=\sum_{i=1}^n \alpha_i \beta_i
\end{align*}
とし,
\begin{align*}
  \|\alpha \|=\sqrt{\Braket{\alpha,\alpha}}
\end{align*}
とする.

$\zzero$は$V$の零ベクトルを表し,
$\Set{\ee_1,\ldots,\ee_n}$は$V$の標準基底であるとする.
つまり,
\begin{align*}
 \zzero&=\begin{pmatrix}0\\\vdots\\0\end{pmatrix},\\
 \ee_1&=\begin{pmatrix}1\\0\\\vdots\\0\end{pmatrix},
 \ee_2=\begin{pmatrix}0\\1\\\vdots\\0\end{pmatrix},
 \ldots,
 \ee_n=\begin{pmatrix}0\\\vdots\\0\\1\end{pmatrix}
\end{align*}
とする.

$E_n$で単位行列.
$E_{k,l}$で行列単位.
$\diag$で対角行列.
特性多項式と固有値, 対角化

$\RR_{>0}$

$\Braket{\Phi}_{\RR}$

直和分解, 写像の直和

$\sum{x\in X}$

$f\circ g$を$fg$とかく.

$f\colon V\to V$を$V$上の変換とよぶ.

直交行列.

固有値固有ベクトル.
直交行列の固有値は1,-1
固有空間は直交する.

単位行列
対角行列
行列単位

\section{群について}
対称群, 互換, 隣接互換
群の定義
同型
$\ZZ^{\times}$ $(\ZZ^{\times})^n$ 生成系
生成系
位数.

\chapter{鏡映}

\section{鏡映の定義と例}


$\alpha \in V\setminus\Set{\zzero}$に対し,
\begin{align*}
  H_\alpha = \Set{\beta \in V | \Braket{\alpha,\beta}=0}
\end{align*}
とおき, $\alpha$を法ベクトルとする(中心的な)超平面と呼ぶ.
また,
\begin{align*}
  \RR\alpha = \Set{c \alpha | c\in \RR}
\end{align*}
とおく. $\RR\alpha$は原点を通り$\alpha$を方向ベクトルとする直線である.
このとき, $V$は,
\begin{align*}
  V =   H_\alpha \oplus   \RR\alpha
\end{align*}
と(内部)直和に分解される.
つまり, 次の2つを満たす:
\begin{align*}
  &V = \Set{ \beta + \gamma | \beta \in H_\alpha, \gamma \in \RR\alpha},\\
  &H_\alpha \cap   \RR\alpha =\Set{\zzero}.
\end{align*}

\begin{definition}
  $\alpha \in V\setminus\Set{\zzero}$とし,
  $f\colon V\to V$は線型写像であるとする.
  次の2つの条件を満たすとき,
  $f$が$\alpha$に関する鏡映であるという:
  \begin{enumerate}
  \item $f(\alpha)=-\alpha$.
  \item $\beta \in H_\alpha \implies f(\alpha)=\alpha$.    
  \end{enumerate}
  $f$が$\alpha$に関する鏡映であるような$\alpha\in V\setminus\Set{\zzero}$が存在するとき,
  $f$は鏡映であるという.
\end{definition}
$n$次正方行列は,
$\alpha\in V$に対し,
$A\alpha\in V$を対応させる$V$から$V$への線型写像であると思うことができる.
対応する線型写像が鏡映であるとき, その行列も鏡映と呼ぶことにする.
行列の言葉に定義を書き直すと以下のようになる.
\begin{definition}
  $\alpha \in V\setminus\Set{\zzero}$とし,
  $A$は$n$次正方行列であるとする.
  次の2つの条件を満たすとき,
  $A$が$\alpha$に関する鏡映であるという:
  \begin{enumerate}
  \item $A\alpha=-\alpha$.
  \item $\beta \in H_\alpha \implies A\alpha=\alpha$.    
  \end{enumerate}
\end{definition}

\begin{example}
  \begin{align*}
    P_0=
    \begin{pmatrix}
      1 & 0 \\
      0 & -1 
    \end{pmatrix}.
  \end{align*}
  とし,
  $\alpha=\ee_2$とおくと,
  $P_0$は$\alpha$に関する鏡映である.
実際, 
\begin{align*}
  P_0\alpha = 
      \begin{pmatrix}
      1 & 0 \\
      0 & -1 
      \end{pmatrix}
      \alpha
    =
      \begin{pmatrix}
      1 & 0 \\
      0 & -1 
    \end{pmatrix}
    \begin{pmatrix}
      0  \\
      1  
    \end{pmatrix}
    =
    \begin{pmatrix}
      0  \\
      -1  
    \end{pmatrix}
    =
    -
    \begin{pmatrix}
      0  \\
      1  
    \end{pmatrix}
    =
    -\alpha
\end{align*}
である.  また,
\begin{align*}
  H_\alpha = \Set{c \ee_1 | c\in \RR}
\end{align*}
であるが,
\begin{align*}
    \begin{pmatrix}
      1 & 0 \\
      0 & -1 
    \end{pmatrix}
    \begin{pmatrix}
      c  \\
      0  
    \end{pmatrix}
    =
    \begin{pmatrix}
      c  \\
      0  
    \end{pmatrix}
\end{align*}
である.
\end{example}

\begin{example}
  \label{ex:i2m:ref}
  $P_0$は鏡映であった.
  もっと一般に,
  実数$\theta$に対し,
\begin{align*}
  P_{2\theta}&=
  \begin{pmatrix}
    \cos(2\theta) & \sin(2\theta) \\
    \sin(2\theta) & -\cos(2\theta) 
  \end{pmatrix},\\
  \alpha(\theta)
  &=
  \begin{pmatrix}
    \sin(\theta) \\
    \cos(\theta) 
  \end{pmatrix}
\end{align*}
とおけば, $P_{2\theta}$は$\alpha(\theta)$に関する鏡映である.
実際,
\begin{align*}
  H_{\alpha(\theta)} = \Set{c \alpha(\theta+\frac{\pi}{2})|c\in \RR} 
\end{align*}
であるので,
\begin{align*}
  P_{2\theta}\alpha(\theta) &= - \alpha(\theta),\\
  P_{2\theta}(c\alpha(\theta+\frac{\pi}{2})) &= c\alpha_(\theta+\frac{\pi}{2})
\end{align*}
を示せばよいが, これらは直接, 計算することで確かめることができる.
\end{example}


\begin{example}
  \label{ex:a1n:refl}
  $P_0$は鏡映であった.
  もっと一般に,
  $F_k$を$(k,k)$成分は$-1$, 他の対角成分は$1$であるような$n$次対角行列とする.
 $E_{k,l}$で$(k,l)$行列単位, つまり, $(k,l)$成分のみ1で他は0であるような行列とすると,
  \begin{align*}
    F_k = \diag(1,\ldots,1,-1,1,\ldots,1)=E_n-2E_{k,k}
  \end{align*}
  である.
  $\alpha=\ee_k$とすると, $F_k$は$\alpha$ に関する鏡映である.
  $F_k \alpha = -\alpha$となることは, 直接計算すればわかる.
  また, $\beta\in V$に対し,
  \begin{align*}
    \Braket{\alpha,\beta}= \beta_k 
  \end{align*}
  であるので,
  \begin{align*}
    H_\alpha = \Set{
      \beta=
      \begin{pmatrix}
        \beta_1\\
        \vdots\\
        \beta_n
      \end{pmatrix}
      | \beta_k=0}
  \end{align*}
  である.  $\beta\in H_\alpha$に対し, 
  $F_k \beta = -\beta$となることは, 直接計算すればわかる.
\end{example}

\begin{example}
  $T_{k,l}$を$(k,k)$成分と$(l,l)$成分は$0$, 他の対角成分は$1$,
$(k,l)$成分と$(l,k)$成分は$1$, 他の成分は$0$
  であるような$n$次正方行列とする.
  つまり,
  \begin{align*}
    T_{k,l} =E_n-E_{k,k}-E_{l,l}+E_{l,k}+E_{k,l}
  \end{align*}
  である.
  $\alpha=\ee_k-\ee_l$とすると, $T_{k,l}$は$\alpha$ に関する鏡映である.
  実際,
  \begin{align*}
    T_{k,l} \alpha = T_{k,l}(e_k-e_l) = T_{k,l}e_k-T_{k,l}e_l = e_l - e_k = -(e_k - e_l) = -\alpha 
  \end{align*}
  である.  
  また, $\beta\in V$に対し,
  \begin{align*}
    \Braket{\alpha,\beta}= \beta_k - \beta_l
  \end{align*}
  であるので,
  \begin{align*}
    H_\alpha = \Set{
      \beta=
      \begin{pmatrix}
        \beta_1\\
        \vdots\\
        \beta_n
      \end{pmatrix}
      | \beta_k=\beta_l}
  \end{align*}
  である.
  $\beta\in H_\alpha$に対し, 
  $F_k \beta = -\beta$となることは, 直接計算すればわかる.
\end{example}



\begin{example}
  $k\neq l$に対し,
  $F_{k,l}=F_kF_lT_{k,l}$とおく.
  つまり$F_{k,l}$は$(k,k)$成分と$(l,l)$成分は$0$, 他の対角成分は$1$,
  $(k,l)$成分と$(l,k)$成分は$-1$, 他の成分は$0$であるような$n$次正方行列であり,
  \begin{align*}
    F_{k,l} = E_n-E_{k,k}-E_{l,l}-E_{k,l}-E_{l,k}
  \end{align*}
  である.
  $\alpha=\ee_k+\ee_l$とすると, $F_{k,l}$は$\alpha$ に関する鏡映である.
  実際,
  \begin{align*}
    F_{k,l} \alpha &= F_kF_lT_{k,l}(\ee_k+\ee_l)\\
    &= F_kF_l(\ee_k+\ee_l)\\
    &= F_kF_l\ee_k+F_kF_l\ee_l\\
    &= F_k\ee_k-F_k\ee_l\\
    &= -\ee_k-\ee_l\\
    &= -(\ee_k+\ee_l)\\
    &= -\alpha
  \end{align*}
  となる.
  また, $\beta\in V$に対し,
  \begin{align*}
    \Braket{\alpha,\beta}= -\beta_k-\beta_l 
  \end{align*}
  であるので,
  \begin{align*}
    H_\alpha = \Set{
      \beta=
      \begin{pmatrix}
        \beta_1\\
        \vdots\\
        \beta_n
      \end{pmatrix}
      | \beta_k=-\beta_l}
  \end{align*}
  である.  $\beta\in H_\alpha$に対し, 
  $F_k \beta = -\beta$となることは, 直接計算すればわかる.
\end{example}

\begin{example}
  $\alpha\in V\setminus\Set{\zzero}$とする.
  $\beta\in V$に対して,
  \begin{align*}
    s_\alpha (\beta) = \beta - 2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}\alpha
  \end{align*}
  と定義する. $s_\alpha$は$V$から$V$への線型写像である.
  また, $s_\alpha$は$\alpha$に関する鏡映である.
  実際
  \begin{align*}
    s_\alpha (\alpha) = \alpha - 2\frac{\Braket{\alpha,\alpha}}{\Braket{\alpha,\alpha}}\alpha
      = \alpha - 2\alpha=-\alpha
  \end{align*}
であり, $\beta\in H_\alpha$に対しては,  
  \begin{align*}
    s_\alpha (\beta) = \beta - 2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}\alpha
    = \beta - 0\alpha =\beta
  \end{align*}
  となる,
\end{example}

\section{鏡映の性質}
ここでは, $V$から$V$への線型写像で鏡映であるものの性質について考える.
\begin{lemma}
  \label{lemma:reflisunique}
  $s$も$s'$も$\alpha$に関する鏡映であるとする.
  このとき, $s=s'$.
\end{lemma}
\begin{proof}
  $V =   H_\alpha +  \RR\alpha$
  であるので,
  $s(\alpha)=s'(\alpha)$と,
  $\beta\in H_\alpha$に対して
  $s(\beta)=s'(\beta)$を示せば十分である.
  これらは,
  $\alpha$に関する鏡映の定義から直接わかる.
\end{proof}
\Cref{lemma:reflisunique}を使うと次がすぐわかる.
\begin{prop}
  $s$を$V$上の線形変換であるとする.
  $s$が$\alpha$に関する鏡映であるとき, $s=s_\alpha$.
\end{prop}

\begin{prop}
  $\alpha, \alpha' \in V\setminus\Set{\zzero}$とする.
  このとき, 次は同値:
  \begin{enumerate}
  \item $s_\alpha=s_{\alpha'}$.
  \item $\alpha=c\alpha'$となる$c\in \RR$が存在する.
  \end{enumerate}
\end{prop}
\begin{proof}
  $s_\alpha=s_{\alpha'}$とする.
  このとき,
  \begin{align*}
    s_\alpha(\alpha) &=-\alpha,\\
    s_{\alpha'} (\alpha) &= \alpha - 2\frac{\Braket{\alpha',\alpha}}{\Braket{\alpha',\alpha'}}\alpha'
  \end{align*}
  であるので,
  \begin{align*}
    -\alpha &= \alpha - 2\frac{\Braket{\alpha',\alpha}}{\Braket{\alpha',\alpha'}}\alpha'\\
    \alpha &= \frac{\Braket{\alpha',\alpha}}{\Braket{\alpha',\alpha'}}\alpha'
  \end{align*}
  となる.

  $\alpha=c\alpha'$とする.
  このとき,
  \begin{align*}
    s_{\alpha}(\alpha')=s_{\alpha}(c\alpha)=cs_{\alpha}(\alpha)=-c\alpha=-\alpha'
  \end{align*}
  である.
  また,
  $\alpha\neq \zzero$
  であるので, $c\neq 0$である.
  $\beta \in H_{\alpha'}$とすると,
  \begin{align*}
    \Braket{\alpha,\beta}=\Braket{\frac{1}{c}\alpha',\beta}=\frac{1}{c}\Braket{\alpha',\beta}=0
  \end{align*}
  であるので, $\beta \in H_\alpha$である.
  したがって,
  $s_\alpha(\beta)=\beta$である.
  よって, $s_\alpha$は$\alpha'$に関する鏡映である.
  \Cref{lemma:reflisunique}
  より, $s_\alpha=s_{\alpha'}$である.
\end{proof}


\begin{prop}
  $s$を鏡映とする.
  このとき, $s^2=\id_V$.
\end{prop}
\begin{proof}
  $s$を$\alpha$に関する鏡映とする.
  $s^2(\alpha)=s(-\alpha)=-s(\alpha)=-(-\alpha)=\alpha$
  である.
  また, $\beta\in V$に対して,
  $s^2(\beta)=s(\beta)=\beta$である.
  よって,
  $s$は$V$上の恒等写像である.
\end{proof}

\begin{cor}
  $s$を鏡映とする.
  このとき, $s=s^{-1}$.
\end{cor}


\begin{prop}
  \label{prop:reflisortho}
  $s$を鏡映とする.
  このとき, $s$は内積を保存する.
  つまり, $\lambda,\mu\in V$に対して, $\Braket{s(\lambda),s(\mu)}=\Braket{\lambda,\mu}$である.
\end{prop}
\begin{proof}
  $s$を$\alpha$に関する鏡映とする.
  $\lambda,\mu\in V$とすると,
  $V=H_\alpha+\RR\alpha$であるので,
  \begin{align*}
    \lambda &= \beta_\lambda + a_\lambda \alpha, 
    &\mu &= \beta_\mu + a_\mu \alpha 
  \end{align*}
  をみたす$\beta_\lambda, \beta_\mu \in H_\alpha$と$a_\lambda,a_\mu \in \RR$が存在する.
  \begin{align*}
    \Braket{s(\lambda),s(\mu)}&=
    \Braket{s(\beta_\lambda + a_\lambda \alpha), s(\beta_\mu + a_\mu \alpha) }\\
    &=
    \Braket{\beta_\lambda - a_\lambda \alpha, \beta_\mu - a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{\beta_\lambda ,  - a_\mu \alpha }
    +\Braket{ - a_\lambda \alpha, \beta_\mu }
    +\Braket{ - a_\lambda \alpha, - a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +0
    +0
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }\\
    \Braket{\lambda,\mu}&=
    \Braket{\beta_\lambda + a_\lambda \alpha, \beta_\mu + a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{\beta_\lambda ,  a_\mu \alpha }
    +\Braket{a_\lambda \alpha, \beta_\mu }
    +\Braket{a_\lambda \alpha, a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +0
    +0
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }
  \end{align*}
  がなりたつ. 
\end{proof}

\begin{prop}
  \label{prop:conjbyortho}
  $t$は内積を保つ線型写像であるとする.
  $\alpha\in V\setminus\Set{\zzero}$に対し,
  $ts_\alpha t^{-1}=s_{t(\alpha)}$.
\end{prop}
\begin{proof}
\Cref{lemma:reflisunique}より,
  $ts_\alpha t^{-1}$が$t(\alpha)$に関する鏡映であることを示せば十分である.
\begin{align*}
  ts_\alpha t^{-1}(t(\alpha))=ts_\alpha(\alpha)=t(-\alpha)=-t(\alpha)
\end{align*}
である. また$\beta\in H_{t(\alpha)}$に対して,
\begin{align*}
\Braket{\alpha,t^{-1}(\beta)}
=\Braket{t(\alpha),\beta}
=0
\end{align*}
であるので, $t^{-1}(\beta)\in H_\alpha$である.
したがって,
\begin{align*}
  ts_\alpha t^{-1}(\beta)=ts_\alpha(t^{-1}(\beta))=t(t^{-1}(\beta))=\beta.
\end{align*}
\end{proof}

\begin{prop}
  直交変換$s$に対し以下は同値:
  \begin{enumerate}
  \item $s$は鏡映である.
  \item 固有値$-1$に属する固有空間の次元は$1$次元である.
  \end{enumerate}
\end{prop}
\begin{proof}
  $s$が$\alpha$に関する鏡映であるとする.
  このとき, 定義から,
  固有値$-1$に属する固有空間は$\RR\alpha$であり,
  固有値$1$に属する固有空間は$H_\alpha$である.
  よって固有値$-1$に属する固有空間の次元は$1$次元である.

  固有値$-1$に属する固有空間の次元は$1$次元であるとする.
  このとき, 固有値$-1$に属する固有空間は$\RR\alpha$とかける.
  直交変換の固有値は, $1$か$-1$であり, 固有空間は互いに直交するので,
  固有値$1$に属する固有空間は$H_\alpha$である.
  固有値の定義から,
  $s(\alpha)=\alpha$と
  $\beta\in H_\alpha$に対して$s(\beta)=\beta$である.
  したがって,
  $s$は$\alpha$に関する鏡映である.
\end{proof}

鏡映変換に関する性質を, 行列の言葉に書き直しておく.
\begin{cor}
  $A$は$n$次正方行列とし, 鏡映であるとする.
  このとき,
  \begin{align*}
    A^2&=E_n,\\
    \transposed{A}A&=E_n,\\
    A&=A^{-1}=\transposed{A},\\
    \exists P &\text{ such that } PAP^{-1}=\diag(1,\ldots,1,-1),\\
    \det(tE_n-A)=(t+1)(t-1)^{n-1},\\
    \det(A)&=-1.
  \end{align*}
\end{cor}



\begin{example}
  $E_n$は鏡映ではない.
  $\alpha\in V$に対し,
  \begin{align*}
    E_n\alpha=-\alpha
  \end{align*}
  とすると,
  \begin{align*}
    \alpha=\zzero
  \end{align*}
  となり, $V\setminus\Set{\zzero}$の元では,
  $E_n\alpha=-\alpha$を満たすことがないので,
  $E_n$は鏡映ではない.
\end{example}

\begin{example}
 \label{ex:i2m:rot}
 実数$\theta$に対し,
  \begin{align*}
    R_\theta=
    \begin{pmatrix}
      \cos(\theta) & -\sin(\theta) \\
      \sin(\theta) & \cos(\theta)
    \end{pmatrix}.
  \end{align*}
 とおくと, これは鏡映ではない.
 \begin{align*}
    R_\theta \alpha = -\alpha
 \end{align*}
 とする. このとき,
 \begin{align*}
    (R_\theta + E_2)\alpha = \zzero
 \end{align*}
 である.
 \begin{align*}
   \det(R_\theta + E_2) &= 
    \det \begin{pmatrix}
      \cos(\theta) +1 & -\sin(\theta) \\
      \sin(\theta) & \cos(\theta) +1 
    \end{pmatrix}\\
    &=(\cos(\theta) +1)^2 + (\sin(\theta))^2\\
    &=2(1+\cos(\theta))
 \end{align*}
 である.
 したがって, $\cos(\theta)\neq 0$のときには,
 $R_\theta + E_2$は正則であるから, $\alpha=\zzero$のみが解となり,
 この場合は鏡映ではないことがわかる.
 また,  $\cos(\theta)= 0$のときには, $R_\theta=E_2$であり,
 この場合も鏡映ではない.
\end{example}

\begin{example}
  $\sigma \in S_n$に対し,
  $(\sigma(1),1)$成分,\ldots
  $(\sigma(n),n)$成分
  は$1$で. 他の成分は$0$であるような$n$次正方行列を$A_\sigma$とおく.
  つまり,
  \begin{align*}
    A_\sigma = \sum_{j=1}^{n} E_{\sigma(j),j} = \sum_{i=1}^{n} E_{i,\sigma^{-1}(i)}
  \end{align*}
  である.
  $\sigma,\tau\in S_n$に対し, $A_\sigma=A_\tau$であることと,
  $\sigma=\tau$であることは同値である.
  直接計算することで,
  $A_\sigma \ee_k=\ee_{\sigma(k)}$であることがわかる.
  $\sigma\in S_n$に対し次は同値である:
  \begin{enumerate}
  \item $\sigma$が互換である.
  \item $A_\sigma$が鏡映である.
  \end{enumerate}
  $T_{i,j}$が互換であることは示した.
  逆を示す.
  $\sigma$が互換ではないとする.
  $\sigma=\varepsilon$のとき, $A_\sigma=E_n$であるので, これは鏡映ではない.
  $\sigma\neq\varepsilon$とする.
  このとき$\sigma(i_1)\neq i_1$を満たす$i_1$が存在する.
  $\sigma(i_1)=i_2$とおき,
  $\alpha=\ee_{i_1}-\ee_{i_2}$とする.
  このとき,
  \begin{align*}
    A_\sigma A_\sigma\alpha
    &= A_\sigma A_\sigma (\ee_{i_1}-\ee_{i_2})\\
    &= A_\sigma(\ee{\sigma(i_1)}-\ee{\sigma(i_2)})\\
    &= \ee{\sigma\sigma(i_1)}-\ee{\sigma\sigma(i_2)}
  \end{align*}
  である. 鏡映は二乗すると単位行列となるので,
  $\ee{\sigma\sigma(i_1)}-\ee{\sigma\sigma(i_1)}\neq \alpha$ならば,
  $A_\sigma$は鏡映ではない.
  $\ee{\sigma\sigma(i_1)}-\ee{\sigma\sigma(i_2)}=\ee{i_1}-\ee{i_2}$と仮定する.
  このとき, $i_2=i_1$である.
  したがって,  $A_\sigma \alpha = -\alpha$である.
  ここで,
  $i\in \Set{i_1, i_2}$の他に$\sigma(i)=i$となる$i$がなければ, $\sigma$は互換である.
  $j_1\not\in \Set{i_1,i_2}$が
  $\sigma(j_1)\neq j_1$を満たすとする.
  $\sigma(j_1)=j_2$とし, $\beta=\ee_{j_1}-\ee_{j_2}$とおく.
  $\alpha$のときと同じ議論で,
  $\sigma(j_2)\neq j_1$であるときには, $A_\sigma$は鏡映ではないことがわかる.
  $\sigma(j_2)= j_1$を仮定すると, $A_\sigma \beta=-\beta$がなりたつ.
  $\Set{i_1,i_2}\neq \Set{j_1,j_2}$であるので,
  $\alpha$と$\beta$は一次独立である.
  したがって, $A_\sigma$の固有値$1$に属する固有空間の次元は$1$ではないので,
  鏡映ではない.
\end{example}


\chapter{有限鏡映群}

\section{有限鏡映の定義}
\begin{definition}
  次の条件をみたすとき, 
  $W$を鏡映群と呼ぶ:
  \begin{enumerate}
  \item
    $W=\Braket{s_1,\ldots,s_t}$をみたす
    鏡映変換
    $s_1,\ldots,s_t$が存在する.
  \end{enumerate}
\end{definition}

また行列に対しても同様に定義をする.
\begin{definition}
  次の条件をみたすとき, 
  $W$を有限鏡映群と呼ぶ:
  \begin{enumerate}
  \item
    $W=\Braket{A_1,\ldots,A_t}$をみたす
    鏡映
    $A_1,\ldots,A_t$が存在する.
  \end{enumerate}
\end{definition}
鏡映群$W$が有限集合であるとき,
$W$を有限鏡映群と呼ぶ.

\begin{definition}
  $W$を$V$上の鏡映群とする.
  次の条件をみたすとき, 
  $W$は本質的であるという:
  \begin{align*}
    \forall \alpha\in V\setminus\Set{\zzero},\ 
    \exists w\in W
    \text{ s.t. }
    w(\alpha)\neq \alpha.
  \end{align*}
\end{definition}

\Cref{prop:reflisortho}から次がすぐわかる.
\begin{prop}
\label{prop:reflgrpisortho}
  $W$を$V$上の鏡映群であるとする.
  このとき, $w\in W$は内積を保つ.
\end{prop}

行列のときには次の様に言い換えられる.
\begin{prop}
  $W$を$V$上の鏡映群であるとする.
  このとき, $A \in W$は直交行列である.
\end{prop}

\section{有限鏡映群の例}
\subsection{$I_2(m)$}
\label{ex:i2m:grp}
$m$を正の整数とする.
\Cref{ex:i2m:ref,ex:i2m:rot}で見た行列について考えるが,
ここでは, 記号の簡略化のために
\begin{align*}
  P_i&=P_{\frac{2i\pi}{m}}\\
  R_i&=R_{\frac{2i\pi}{m}}
\end{align*}
とおく.
まず, $P_i$, $R_i$の計算規則について調べておく.
\begin{lemma}
  \begin{align*}
    P_i &= P_{i+m},\\
    R_i &= R_{i+m}.
  \end{align*}
\end{lemma}
\begin{lemma}
  \begin{align*}
    R_i R_j&= R_{i+j},\\
    R_i&=(R_1)^i.
  \end{align*}
\end{lemma}
\begin{lemma}
  \begin{align*}
    (R_i)^m&=E_2,\\
    (P_i)^2&=E_2.
  \end{align*}
\end{lemma}

\begin{lemma}
  \label{lem:i2m:rp=p:pr=p:}
  \begin{align*}
    R_iP_0&=P_i,\\
    P_0R_i &= P_{-i}.
  \end{align*}
\end{lemma}
\begin{proof}
  \begin{align*}
  R_iP_0&=R_{\frac{2i\pi}{m}}P_0\\
  &=
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & -\sin(\frac{2i\pi}{m})\\
    \sin(\frac{2i\pi}{m}) & \cos(\frac{2i\pi}{m})\\
  \end{pmatrix}
  \begin{pmatrix}
    1 & 0\\
    0 & -1\\
  \end{pmatrix}\\
  &=
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & \sin(\frac{2i\pi}{m})\\
    \sin(\frac{2i\pi}{m}) & -\cos(\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=R_{\frac{2i\pi}{m}}=R_{i}.
  \end{align*}
  \begin{align*}
  P_0R_i &=P_0R_{\frac{2i\pi}{m}}\\
  &=
  \begin{pmatrix}
    1 & 0\\
    0 & -1\\
  \end{pmatrix}
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & -\sin(\frac{2i\pi}{m})\\
    \sin(\frac{2i\pi}{m}) & \cos(\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & -\sin(\frac{2i\pi}{m})\\
    -\sin(\frac{2i\pi}{m}) & -\cos(\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=
  \begin{pmatrix}
    \cos(-\frac{2i\pi}{m}) & \sin(-\frac{2i\pi}{m})\\
    \sin(-\frac{2i\pi}{m}) & \cos(-\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=
  P_{-\frac{2i\pi}{m}}=P_{-i}
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lem:i2m:rel:pp=r:pr=p:rp=p}
  \begin{align*}
    P_i P_j&= R_{i-j},\\
    R_i P_j&= P_{i+j},\\
    P_i R_j&= P_{i-j}.
  \end{align*}
\end{lemma}
\begin{proof}
  \begin{align*}
    R_iP_0&=P_i,\\
    P_0R_{-j} &= P_{j},\\
    P_iP_j&=R_i P_0P_0R_{-j}=R_{i}R_{-j}=R_{i-j}.
  \end{align*}
  \begin{align*}
    P_0R_{-i} &= P_{i},\\
    R_jP_0&=P_j,\\
    R_iP_j&=R_iR_jP_0=R_{i+j}P_0=P_{i+j},\\
    P_iR_j&=P_0R_{-i}R_j=P_0R_{-i+j}=P_{i-j}.
  \end{align*}
\end{proof}


\begin{lemma}
  \label{lem:i2m:rel:ppp=p:rpr=p:}
  \begin{align*}
    P_i P_j (P_i)^{-1}&= P_{2i-j},\\
    R_i P_j (R_i)^{-1}&= P_{2i+j}.
  \end{align*}
\end{lemma}
\begin{proof}
  \begin{align*}
    P_i P_j (P_i)^{-1}
    &=R_{i-j}P_i
    =P_{2i-j},\\
    R_i P_j (R_i)^{-1}&= P_{i+j}R_{-i}=P_{2i+j}.
  \end{align*}
\end{proof}


$D_{2\cdot m}$を次で定義する:
\begin{align*}
  D_{2\cdot m} = \Set{P_i,R_i|i\in \ZZ} = \Set{P_i,R_i|i=0,\ldots,m-1}.
\end{align*}
$R_0=E_2$であるので,
\Cref{lem:i2m:rel:pp=r:pr=p:rp=p}から,
$D_{2\cdot m}$が群であることがわかる.
\Cref{lem:i2m:rp=p:pr=p:}から,
$R_iP_0=P_i$であるので,
$R_i=P_iP_0$である.
したがって,
\begin{align*}
   D_{2\cdot m} = \Braket{P_0,\ldots,P_{m-1}}_{\ZZ}
\end{align*}
であることがわかる.
$P_i$は鏡映であったので,
$D_{2\cdot m}$は有限鏡映群である.
$D_{2\cdot m}$は位数$2m$の二面体群とよばれる.

\begin{prop}
$m>1$のとき, $D_{2\cdot m}$は本質的である.
\end{prop}
\begin{proof}
  \begin{align*}
    \alpha=\begin{pmatrix}
      \alpha_1 \\
      \alpha_2
    \end{pmatrix}\in V\setminus\Set{\zzero}
  \end{align*}
  とする.
  $\alpha_2\neq 0$のとき,
  \begin{align*}
    P_0 \alpha =
    \begin{pmatrix}
      1&0\\
      0&-1
    \end{pmatrix}  
    \begin{pmatrix}
      \alpha_1\\
      \alpha_2
    \end{pmatrix}
    =
    \begin{pmatrix}
      \alpha_1\\
      -\alpha_2
    \end{pmatrix}
    \neq \alpha.
  \end{align*}
  また$\alpha_2-0$のとき,
  $\alpha\neq \zzero$であることから,
  $\alpha_1\neq 0$ となる.
  このとき,
  \begin{align*}
    P_1 \alpha =
    \begin{pmatrix}
      \cos(\frac{2\pi}{m})&\sin(\frac{2\pi}{m})\\
      \sin(\frac{2\pi}{m})&-\cos(\frac{2\pi}{m})
    \end{pmatrix}  
    \begin{pmatrix}
      \alpha_1\\
      0
    \end{pmatrix}
    =
    \begin{pmatrix}
      \alpha_1\cos(\frac{2\pi}{m})\\
      \alpha_1\sin(\frac{2\pi}{m})
    \end{pmatrix}  
    \neq
    \begin{pmatrix}
      \alpha_1\\
      0
    \end{pmatrix}
    .
  \end{align*}
\end{proof}
\begin{prop}
  $m=1$のとき, つまり $D_{2\cdot 1}$は本質的ではない.
\end{prop}

\begin{proof}
  $D_{2\cdot 1}=\Set{P_0,R_0}$である.
  \begin{align*}
    \alpha=
    \begin{pmatrix}
      1\\0
      \end{pmatrix}
  \end{align*}
  とすると,
  $P_0\alpha = R_0\alpha= \alpha $である.
\end{proof}

\begin{lemma}
  \label{lem:i2m:conjclass:}
  \begin{align*}
    \Set{P_{k+2i},P_{-k+2i} | i \in \ZZ} = \Set{AP_kA^{-1} | A\in D_{2\cdot m}}.
  \end{align*}
\end{lemma}
\begin{proof}
  $P_{k+2i}\in \Set{AP_kA^{-1} | A\in D_{2\cdot m}}$
  を示す.
  $A=R_{i}$とすれば,
  \Cref{lem:i2m:rel:ppp=p:rpr=p:}から,
  $AP_{k}A^{-1}=P_{2i+k}$となる.
  $P_{-k+2i}\in \Set{AP_kA^{-1} | A\in D_{2\cdot m}}$
  を示す.
  $A=P_{i}$とすれば,
  \Cref{lem:i2m:rel:ppp=p:rpr=p:}から,
  $AP_{k}A^{-1}=P_{2i-i}$となる.

 $A\in D_{2\cdot m}$に対し,
 $AP_0A^{-1}\in \Set{P_{k+2i} | i \in \ZZ}$を示す.
 $A=R_i$のとき,
 \Cref{lem:i2m:rel:ppp=p:rpr=p:}から,
 $AP_kA^{-1}=P_{2i+k}$である.
 一方,
 $A=P_j$のとき,
 $AP_kA^{-1}=P_{2j-k}$である.
 \end{proof}

\begin{prop}
  \label{lem:i2m:conjclass:odd}
  $m$が奇数であるとする.
  このとき,
  \begin{align*}
    \Set{P_i | i \in \ZZ}
    &= \Set{AP_0A^{-1} | A\in D_{2\cdot m}}\\
    &= \Set{AP_1A^{-1} | A\in D_{2\cdot m}}\\
    &\vdots
  \end{align*}
  つまり, $\Set{P_i | i \in \ZZ}$は$P_0$を含む共軛類である.
\end{prop}
\begin{proof}
  $C=\Set{AP_0A^{-1} | A\in D_{2\cdot m}}$とおく.
  このとき, \Cref{lem:i2m:conjclass:}より,
  $C=\Set{P_{2l}| l \in \ZZ}$である.

  $C=\Set{AP_0A^{-1} | A\in D_{2\cdot m}}$であるので,
  $AP_0A^{-1}\in \Set{AP_0A^{-1} | A\in D_{2\cdot m}} \subset \Set{P_i | i \in \ZZ}$である.

  $P_{i}\in C$
  を示す.
  $i$が偶数のとき,
  であることから, $P_{i}\in C$である.
  $i$が奇数のときについて考える.
  $P_{i}=P_{i+m}$であるが,
  $m$が奇数なので, $i+m$は偶数である.
  したがって$P_{i}=P_{i+m}\in C$である.

  
  $C_k=\Set{AP_kA^{-1} | A\in D_{2\cdot m}}$とおく.
  $C=C_k$を示す.
  $P_k\in C$である.
  したがって, $AP_0A^{-1}=P_k$となる$A\in D_{2\cdot m}$が存在する.

  
  $B\in D_{2\cdot m}$とする.
  $AP_0A^{-1}=P_k$であるので,
  $P_0=A^{-1}P_k A$である.
  $BP_0B^{-1}=BA^{-1}P_k AB^{-1}=(BA^{-1})P_k(BA^{-1})^{-1}$
  であるので, $BP_0B^{-1}\in C_k$である.
  
  $B\in D_{2\cdot m}$とする.
  $BP_k B^{-1}=BAP_0A^{-1}B^{-1}=(BA)P_0(BA)^{-1}$であるので,
  $BP_k B^{-1}\in C$である.
  
\end{proof}

\begin{prop}
  \label{lem:i2m:conjclass:even}
  $m$を偶数とする.
  このとき,
  \begin{align*}
    \Set{P_{2i}|i\in\ZZ}&=\Set{AP_0A^{-1} | A \in D_{2\cdot m}}=\Set{AP_2A^{-1} | A \in D_{2\cdot m}}=\cdots,\\
    \Set{P_{2i+1}|i\in\ZZ}&=\Set{AP_1A^{-1} | A \in D_{2\cdot m}}=\Set{AP_3A^{-1} | A \in D_{2\cdot m}}=\cdots,\\
    \Set{P_{2i}|i\in\ZZ}&\cap \Set{P_{2i+1}|i\in\ZZ} =\emptyset.
  \end{align*}
つまり, 
$\Set{P_{2i}|i\in\ZZ}$ は $P_0$を含む共軛類,
$\Set{P_{2i+1}|i\in\ZZ}$は$P_1$を含む共軛類であり,
この2つの共軛類は異なる.
\end{prop}
\begin{proof}
  \Cref{lem:i2m:conjclass:}
  から,
  \begin{align*}
    \Set{P_{2i}|i\in\ZZ}&=\Set{AP_0A^{-1} | A \in D_{2\cdot m}}=\Set{AP_2A^{-1} | A \in D_{2\cdot m}}=\cdots,\\
    \Set{P_{2i+1}|i\in\ZZ}&=\Set{AP_1A^{-1} | A \in D_{2\cdot m}}=\Set{AP_3A^{-1} | A \in D_{2\cdot m}}=\cdots.
  \end{align*}
  はすぐわかる.

  $P_{k}=P_{l}$とする.
  このとき, $E_{2}=(P_{k})^{-1}(P_{l})=P_{k}P_{l}=R_{k-l}$である.
  $R_{j}=E_2$となるのは$j$が$m$の倍数であるときのみである.
  したがって, $k-l$が$m$の倍数である.
  今, $m$は偶数であるので, $k-l$も偶数でなければいけない.
  よって, $k$と$l$の偶奇は一致する.
  したがって, $P_{2i}\not\in\Set{P_{2i+1}|i\in\ZZ}$かつ,
  $P_{2i+1}\not\in\Set{P_{2i}|i\in\ZZ}$であるので,
\begin{align*}
    \Set{P_{2i}|i\in\ZZ}&\cap \Set{P_{2i+1}|i\in\ZZ} =\emptyset
  \end{align*}
  である.
\end{proof}

\subsection{$A_{n-1}$}
\label{ex:an:grp}
$W=\Set{A_\sigma|\sigma\in S_n}$とおく.
$\sigma,\tau \in S_n$に対し,
$A_\sigma A_\tau=A_{\sigma\tau}$
が成り立つことは直接計算することで確かめられる.
また,
$A_{\varepsilon}=E_n$であり,
$A_\sigma^{-1}=A_{\sigma^{-1}}$である.
したがって, $W$は群である.
さらに,
$f(\sigma)=A_\sigma$とおくと,
$f$は$S_n$から$W$への全単射である.
さらに, これは群準同型写像であるので,
$S_n$と$W$は同型である.


$\tau_{i,j}\in S_n$を$i$と$j$を入れ替える互換とする.
つまり,
\begin{align*}
  \tau_{i,j}(k)=
  \begin{cases}
    j&(k=i)\\
    i&(k=j)\\
    k&(k\not\in\Set{i,j})
  \end{cases}
\end{align*}
とする.
このとき, $A_{\tau_{i,j}}=T_{k,l}$であり, 鏡映である.
$S_n$は互換で生成されていたので, $W$は$T_{k,l}$で生成される.
したがって, $W$は有限鏡映群である.


$S_n$は隣接互換$\tau_{1,2},\tau_{2,3},\ldots,\tau_{n-1,n},$
で生成されていたので,
$W$は$T_{1,2},T_{2,3},\ldots,T_{n-1,n}$という$n-1$個の行列で生成できることがわかる.


\begin{prop}
$\alpha=\ee_1+\cdots+\ee_n$とおく.
このとき, 任意の$A\in W$に対し,
$A\alpha=\alpha$となる.
したがって, $W$は本質的ではない.
\end{prop}
\begin{proof}
  $\sigma\in S_n$とする.
  このとき,
  \begin{align*}
    A_\sigma \alpha=\sum_{i=1}^{n}A_\sigma \ee_i=\sum_{i=1}^{n} \ee_{\sigma(i)}
  \end{align*}
  となるが, $\sigma$は$\Set{1,\ldots,n}$上の全単射であるので,
  \begin{align*}
    \sum_{i=1}^{n} \ee_{\sigma(i)}=\sum_{i=1}^{n} \ee_i=\alpha
  \end{align*}
  となる.
\end{proof}


\subsection{$A_1\times \cdots \times A_1$}
\label{ex:a1n:grp}
$W$を
\begin{align*}
 W= \Set{\diag(a_1,\ldots,a_n)|a_i\in \ZZ^\times}
\end{align*}
で定義する.
このとき, $W$は群である.
また,
$(a_1,\ldots,a_n)\in (\ZZ^\times)^n$に対し,
$f((a_1,\ldots,a_n))=\diag(a_1,\ldots,a_n)$
とすると,
$f$は$(\ZZ^\times)^n$から$W$への全単射である.
また, 準同型写像でもあるので,
$(\ZZ^\times)^n$と$W$は同型である.

また, $(-1,1,\ldots,1)$,\ldots,$(1,\ldots,1,-1)$で$ (\ZZ^\times)^n$は生成されていたので,
$F_1$,\ldots,$F_n$で$W$は生成される.
$F_k$は鏡映であったので,
$W$は有限鏡映群である.

\begin{prop}
  $W$は本質的である.
\end{prop}
\begin{proof}
  $\alpha\in V$とする.
  $A=\diag(-1,\ldots,-1)\in W$とすると,
  $A\alpha=-\alpha$である.
  $\alpha\neq \zzero$とすると,
  $0$ではない第$i$成分$\alpha_i$が存在する.
  このとき, $-\alpha_i\neq \alpha$であるので,
  $A\alpha\neq \alpha$である.
\end{proof}


\subsection{$B_n$}
\label{ex:bn:grp}
$W$を
\begin{align*}
  W=\Set{\diag(\aaa)A_\sigma|\aaa
    \in (\ZZ^\times)^n, \sigma\in S_n}
\end{align*}
で定義する.
\begin{align*}
  A_\sigma \diag(a_1,\ldots,a_n)A_{\sigma}^{-1}\ee_{k}
&=  A_\sigma \diag(a_1,\ldots,a_n)A_{\sigma^{-1}}\ee_{k}\\
&=  A_\sigma \diag(a_1,\ldots,a_n)\ee_{\sigma^{-1}(k)}\\
&=  A_\sigma (a_{\sigma^{-1}(k)}\ee_{\sigma^{-1}(k)})\\  
&=  a_{\sigma^{-1}(k)}A_\sigma \ee_{\sigma^{-1}(k)}\\  
&=  a_{\sigma^{-1}(k)} \ee_{\sigma\sigma^{-1}(k)}\\  
&=  a_{\sigma^{-1}(k)} \ee_{k}\\  
\end{align*}
であるので,
\begin{align*}
  A_\sigma \diag(a_1,\ldots,a_n)A_{\sigma}^{-1}
  =\diag(a_{\sigma^{-1}(1)},\ldots,a_{\sigma^{-1}(n)})
\end{align*}
である.  つまり,
\begin{align*}
  A_\sigma \diag(a_1,\ldots,a_n)
  =\diag(a_{\sigma^{-1}(1)},\ldots,a_{\sigma^{-1}(n)})A_{\sigma}
\end{align*}
であることから,
\begin{align*}
  (\diag(b_1,\ldots,b_n)A_\tau)( \diag(a_1,\ldots,a_n)A_{\sigma})
  =\diag(b_1a_{\tau^{-1}(1)},\ldots,b_na_{\tau^{-1}(n)})A_{\tau\sigma} \in W
\end{align*}
となる.
よって, $W$は群である.
$\diag(\aaa)$も$A_\sigma$も鏡映の積としてかけるので,
$\diag(\aaa)A_\sigma$も鏡映の積としてかける.
つまり, $W$は有限鏡映群である.

\begin{prop}
  $W$は本質的である.
\end{prop}
\begin{proof}
$\diag(-1,\ldots,-1)\in W$であることからすぐわかる.
\end{proof}


\subsection{$D_n$}
\label{ex:dn:grp}
$W$を
\begin{align*}
  W=\Set{ \diag(a_1,\ldots,a_n) A_{\sigma} | \sigma\in S_n , (a_1,\ldots,a_n)\in (\ZZ^{\times})^n, a_1\cdots a_n =1}
\end{align*}
とおく,
\begin{align*}
  (\diag(b_1,\ldots,b_n)A_\tau)( \diag(a_1,\ldots,a_n)A_{\sigma})
  =\diag(b_1a_{\tau^{-1}(1)},\ldots,b_na_{\tau^{-1}(n)})A_{\tau\sigma} \in W
\end{align*}
であるが, $b_1\cdots b_n=a_1\cdots a_n=1$ならば$b_1a_{\tau^{-1}(1)}\cdots b_na_{\tau^{-1}(n)}=1$
である. したがって,
$W$は群である.

$a_1\cdots a_n = 1$とすると,
$a_i=-1$となる$i$は偶数個である.
$2k$個の$i$で$a_i=-1$であるとし,
$\Set{i|a_i=-1}=\Set{i_1,\ldots,i_{2k}}$とする.
このとき, $\nu=\tau_{i_1i_2}\cdots \tau_{i_{2k-1}i_{2k}}$
とおくと,
\begin{align*}
F_{i_1,i_2}\cdots F_{i_{2k-1},i_{2k}}=\diag(a_1,\ldots,a_n)A_{\tau}
\end{align*}
である.  したがって$\sigma\in S_n$に対し,
\begin{align*}
  \diag(a_1,\ldots,a_n)A_{\sigma}
  &=\diag(a_1,\ldots,a_n)A_{\tau}A_{\tau}^{-1} A_{\sigma}\\
  &=F_{i_1,i_2}\cdots F_{i_{2k-1},i_{2k}}A_{\tau^{-1}} A_{\sigma}\\
  &=F_{i_1,i_2}\cdots F_{i_{2k-1},i_{2k}}A_{\tau^{-1}\sigma}
\end{align*}
とかける.
したがって, $W$は$\Set{F_{k,l}, T_{k,l}|k\neq l}$
で生成される.
$F_{k,l}$も$T_{k,l}$も鏡映であったから
$W$は有限鏡映群である.


\begin{prop}
$W$は本質的である.
\end{prop}
\begin{proof}
  $\alpha\in V\setminus\Set{\zzero}$とする.
  $\alpha\neq \zzero$なので,
  $0$ではない第$k$成分$\alpha_k$が存在する.
  \begin{align*}
    F_{k,l}T_{k,l}=F_kF_lT_{k,l}T_{k,l}=F_{k}F_{l}
  \end{align*}
  となるので,
  $F_{k}F_{l}\in W$である.
  $-\alpha_k\neq \alpha$であるので
  $F_{k}F_{l}\alpha \neq \alpha$である.
\end{proof}


\chapter{ルート系}
\section{ルート系の定義と例}
\begin{definition}
  $\Phi \subset V \setminus \Set{\zzero}$とする.
  以下の条件を満たすとき, $\Phi$が$V$上の(広義)ルート系であると呼ぶ:
  \begin{enumerate}
  \item $\numof{\Phi}<\infty$
  \item 任意の$\alpha \in \Phi$に対し次が成り立つ:
    \begin{enumerate}
    \item $\RR\alpha \cap \Phi = \Set{\alpha,-\alpha}$.
    \item $s_\alpha (\Phi) = \set{s_\alpha(\beta)|\beta\in \Phi}=\Phi$.
    \end{enumerate}
  \end{enumerate}
\end{definition}

$\Phi\subset V\setminus \Set{\zzero}$に対し,
$R(\Phi)=\Set{s_\alpha | \alpha \in \Phi}$
とし,
$W(\Phi)=\Braket{R(\Phi)}_{\ZZ}$とおく.
定義から$W(\Phi)$は鏡映群であるが, 有限群とは限らない.

\begin{lemma}
  \label{lem:nonesspart}
  $f\in W(\Phi)$に対し,
  $f_{(\RR\Phi)^{\perp}}=\id_{(\RR\Phi)^{\perp}}$.
\end{lemma}
\begin{proof}
  $\beta\in (\RR\Phi)^{\perp}$とする.
  $\alpha\in \Phi$に対し,
  $\Braket{\alpha,\beta}=0$であるので,
  $s_{\alpha}(\beta)=\beta$である.
  $f\in W(\Phi)$とすると,
  $f=s_{\alpha_1}\cdots s_{\alpha_l}$とかけるので,  
  $f(\beta)=\beta$である.
\end{proof}

\begin{prop}
ルート系$\Phi$に対し,
$W(\Phi)$は有限鏡映群である.
\end{prop}
\begin{proof}
  $W(\Phi)$が有限集合であることを示す.
  $S_\Phi$を$\Phi$上の全単射を集めた集合とする.
  このとき, $\numof{S}=\numof{\Phi}!$であり,
  有限集合である.
  $W'=\Set{f\restrictedto{\Phi}|f \in W}$
  とおく.
  $\alpha\in\Phi$に対し, $s\restrictedto{\Phi}=\Phi$であるので,
  \begin{align*}
    s_\alpha\restrictedto{\Phi}\colon
    \Phi &\to \Phi \\
    \beta&\mapsto s_\alpha(\beta)
  \end{align*}
  は全単射である
  $f\in W(\Phi)$とすると,
  $f=s_{\alpha_1}\cdots s_{\alpha_l}$とかけるので,
  $f|_\Phi$も
  $\Phi$上の全単射である.
  つまり, $W'\subset S_\Phi$であり, $W'$は有限集合である.
  ここで
  \begin{align*}
     \varphi\colon
     W(\Phi) &\to W' \\
     f&\mapsto f|_{\Phi}
  \end{align*}
  とおく.
  $\varphi$は単射であることを示す.
  $f,f'\in W$が$f\restrictedto{\Phi}=f'\restrictedto{\Phi}$を満たすとする.
  $V=\RR\Phi \oplus (\RR\Phi)^\perp$と(内部)直和分解できるが,
  \cref{lem:nonesspart}より,
  $\beta\in (\RR\Phi)^\perp$に対し,
  $f(\beta)=f'(\beta)=\beta$である.
  また仮定より, $\beta\in \RR(\Phi)$に対しても,
  $f(\beta)=f'(\beta)$が成り立つので,
  $f=f'$である.
\end{proof}

\begin{prop}
  \label{thm:finitereflgrphasrootsystem}
  $W$がを有限鏡映群とする.
  このとき, $W=W(\Phi)$となる
  ルート系$\Phi$が存在する.
\end{prop}
\begin{proof}
  \begin{align*}
    R&=\Set{ s\in W| \text{$s$は鏡映}}\\
    \Phi&=\Set{\alpha \in V | s_\alpha \in R, \|\alpha \|=1}
  \end{align*}
  とすればよい.
  $W$は鏡映群であるので,
  $W=\Braket{R}_{\ZZ}=W(\Phi)$である.
  $\numof{\Phi}< |W| <\infty$である.
  また, 定義から, $\alpha\in \Phi$に対し,
  $\RR\alpha \cap \Phi = \Set{\alpha,-\alpha}$が成り立つ.
  $\alpha\in \Phi$,
  $f\in W$とすると,
  $fs_\alpha f^{-1}=s_{f(\alpha)}$である.
  $fs_\alpha f^{-1}$は$W$の元であり, $s_{f(\alpha)}$は鏡映であるので,
  $s_{f(\alpha)}\in R$がわかる.
  したがって
  $f(\alpha)\in \Phi$である.
\end{proof}


\section{ルート系の例}
\subsection{$I_2(m)$}
\label{ex:i2m:root}
$m$を正の整数とし,
$D_{2\cdot m}$について考える.
\Cref{ex:i2m:grp}で用いた記号をここでは用いる.
\Cref{ex:i2m:ref,ex:i2m:rot}の記号を用いると,
\begin{align*}
  P_i&=P_{\frac{2i\pi}{m}}\\
  R_i&=R_{\frac{2i\pi}{m}}
\end{align*}
である. さらに,
\begin{align*}
  \alpha_i&=\alpha(\frac{i\pi}{m})\\
  &=
  \begin{pmatrix}
    \sin(\frac{i\pi}{m})\\
    \cos(\frac{i\pi}{m})
  \end{pmatrix}
  =
  \begin{pmatrix}
    \cos(\frac{i\pi}{m}+\frac{\pi}{2})\\
    \sin(\frac{i\pi}{m}+\frac{\pi}{2})
  \end{pmatrix} 
\end{align*}
おく. 
このとき,
\Cref{ex:i2m:ref}より, $P_i$は$\alpha_i$に関する鏡映である.
$\alpha_{i+m}=-\alpha_i$であるから,  $P_i$は$\alpha_{i+m}$に関する鏡映でもある.
一方, \Cref{ex:i2m:rot}より, $R_i$は鏡映ではない.
$D_{2\cdot m}=\Set{P_i,R_i|i \in \Set{0,1,\ldots,m-1}}$であったので,
$\Phi=\Set{\alpha_i | i \in \Set{0,1,\ldots,2m-1} }$とおけば,
$W(\Phi)=D_{2\cdot m}$である.
この$\Phi$がルート系であることは,
\Cref{thm:finitereflgrphasrootsystem}の証明で構成したルート系
そのものであることからわかるが,
ここでは, 確認のため定義に従い調べる.
\begin{align*}
  R_i\alpha_k&=R_{\frac{2i\pi}{m}}\alpha(\frac{k\pi}{m})
  =\alpha(\frac{k\pi}{m}+\frac{2i\pi}{m})
  =\alpha(\frac{2i+k\pi}{m})
  =\alpha_{2i+k}\\
  P_0\alpha_k&=P_0\alpha(\frac{k\pi}{m})\\
  &=
  \begin{pmatrix}
    1 & 0 \\
    0 & -1
  \end{pmatrix}
  \begin{pmatrix}
    \sin(\frac{k\pi}{m}) \\
    \cos(\frac{k\pi}{m}) 
  \end{pmatrix}
=  \begin{pmatrix}
    \sin(\pi-\frac{k\pi}{m}) \\
    -\cos(\pi-\frac{k\pi}{m}) 
  \end{pmatrix}
=  \begin{pmatrix}
    \sin(\frac{(m-k)\pi}{m}) \\
    \cos(\frac{(m-k)\pi}{m}) 
\end{pmatrix}\\
&=\alpha(\frac{(m-k)\pi}{m})=\alpha_{m-k},
\\
P_i\alpha_k&=P_0R_{-i}\alpha_k
=P_0\alpha_{-2i+k}
=\alpha_{m+2i-k} \in \Phi
\end{align*}
である.
また,
$\RR\alpha_i \cap \Phi=\Set{\alpha_i,\alpha_{i+m}}$である.
さらに$\numof{\Phi}=2m$
であるので, 有限集合であるから,
$\Phi$はルート系である.
このルート系を$\Phi(I_2(m))$とおく.

\Cref{ex:i2m:root}での計算から
\begin{align*}
  R_i\alpha_k& =\alpha_{2i+k}\\
  P_i\alpha_k&=\alpha_{m+2i-k}
\end{align*}
であるので,
\begin{align*}
\Set{w\alpha_0 | w\in W} = \Set{\alpha_{2i}, \alpha_{2i+m}| i \in \ZZ}
\end{align*}
である.

$m$が奇数のときには,
\begin{align*}
\Set{w\alpha_0 | w\in W} = \Set{\alpha_{i}| i \in \ZZ}=\Phi
\end{align*}
となる.
\Cref{prop:reflgrpisortho}より, $w\in W$は内積を保つ.
したがって, \cref{prop:conjbyortho}より,
  $\alpha\in V\setminus\Set{\zzero}$に対し,
$ws_\alpha w^{-1}=s_{w(\alpha)}$となる.
よって
\begin{align*}
\Set{s_{w(\alpha_0)}|w\in W}=\Set{ws_{\alpha_0} w^{-1}|w\in W}
\end{align*}
である.
$m$が奇数のときには,
$\Set{w\alpha_0 | w\in W}=\Phi$
であるので,
\begin{align*}
  R(\Phi)=\Set{ws_{\alpha_0} w^{-1}|w\in W}
\end{align*}
であることがわかる, $R(\Phi)=\Set{P_i|i\in \ZZ}$であり,
$P_0=s_{\alpha_0}$である.
これは, \cref{lem:i2m:conjclass:odd}の別証になっている.

つぎに$m$が偶数のときについて考える.
\begin{align*}
\Phi_0&=\Set{\alpha_{2i}| i \in \Set{1,\ldots,m}}\\
\Phi_1&=\Set{\alpha_{2i-1}| i \in \Set{1,\ldots,m}}\\
\end{align*}
とおく.
\begin{align*}
 \Set{w\alpha_0 | w\in W}
  = \Set{\alpha_{2i}| i \in \ZZ}=\Phi_0
\end{align*}
である.
同様に,
\begin{align*}
\Set{w\alpha_1 | w\in W}
  = \Set{\alpha_{2i-1}| i \in \ZZ}=\Phi_1
\end{align*}
である. $\Phi_0\cap \Phi_1=\emptyset$, $\Phi=\Phi_0\cup \Phi_1$であるので,
$m$が奇数のときと同様に,
\cref{lem:i2m:conjclass:even}の別証を与えることができる.

\subsection{$A_{1}\times\cdots\times A_{1}$}
\label{ex:a1n:root}
$\varepsilon_i=\ee_i$とおく.
\begin{align*}
\Phi=\Set{\varepsilon_1,\ldots,\varepsilon_n,-\varepsilon_1,\ldots,-\varepsilon_n,}
\end{align*}
とおく.  このとき,
$\Phi$はルート系である.
$F_i$を$\varepsilon_i$に関する鏡映とする.
このとき$F_i$は$-\varepsilon_i$に関する鏡映でもある.
$F_i(\pm\varepsilon_i)=\mp\varepsilon_i$である. 
$k\neq i$に対して, $\Braket{\varepsilon_i,\varepsilon_k}=0$であるから,
$F_i(\pm\varepsilon_k)=\pm\varepsilon_k$である.
したがって, $F_i(\Phi)=\Phi$である.
また, $\RR(\pm\varepsilon_i)\cap \Phi=\Set{\varepsilon_i,-\varepsilon_i}$
である.
$\numof{\Phi}=2^n$であるので, ルート系である.

\Cref{ex:a1n:grp}であつかった鏡映群を$W$とすると,
\begin{align*}
  W(\Phi)=\Braket{F_1,\ldots,F_n}_{\ZZ}=W
\end{align*}
である.

\subsection{$A_{n-1}$}
\label{ex:an:root}
$\alpha_{i,j}=\ee_i-\ee_j$とし,
\begin{align*}
  \Phi=\Set{\alpha_{i,j}|i\neq j \in \Set{1,\ldots,n}}
\end{align*}
とする.
$T_{i,j}$は$\alpha_{i,j}$に関する鏡映である.
$\alpha_{i,j}=-\alpha_{j,i}$であるので,
$T_{i,j}$は$-\alpha_{i,j}$に関する鏡映でもある.
$\tau\in S_n$を$i$と$j$を入れ替える互換とすると,
\begin{align*}
  T_{i,j}\alpha_{k,l}&=\alpha_{\tau(k),\tau(l)}
\end{align*}
であるから, $T_{i,j}(\Phi)=\Phi$である.
$\RR\alpha_{i,j}\cap \Phi=\Set{\alpha_{i,j},\alpha_{j,i}}$
であり,
$\numof{\Phi}=\binom{n}{2}$であるので,
$\Phi$はルート系である.
このルート系を$\Phi(A_{n-1})$とおく.
\Cref{ex:an:grp}で考えた鏡映群を$W$とすると,
\begin{align*}
  W(\Phi)=\Braket{R(\Phi)}=W
\end{align*}
である.

\subsection{$B_{n}$}
\label{ex:bn:root}
$1\leq i<j\leq n$
$\alpha_{i,j}=\ee_i-\ee_j$,
$\beta_{i,j}=\ee_i+\ee_j$,
$\varepsilon_{k}=\ee_k$.
とする.
\begin{align*}
  \Phi_1&=\Set{\alpha_{i,j},-\alpha_{i,j}|1\leq i<j\leq n}\\
  \Phi_2&=\Set{\beta_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\\
  \hat\Phi&=\Phi_1\cup \Phi_2\\
  \check\Phi&=\Set{\varepsilon_k,-\varepsilon_k|1\leq k\leq n}
\end{align*}
とする.
\begin{align*}
  \Phi&=\hat\Phi\cup \check\Phi
\end{align*}
とおく.
$T_{i,j}$は
$\alpha_{i,j}$に関する鏡映である.
$\tau\in S_n$を$i$と$j$を入れ替える互換とすると,
\begin{align*}
  T_{i,j}\alpha_{i,j}=\alpha_{\tau(i),\tau(j)}\\
  T_{i,j}\beta_{i,j}=\beta_{\tau(i),\tau(j)}\\
  T_{i,j}\varepsilon_{i}=\varepsilon_{\tau(i)}
\end{align*}
であるので,
$T_{i,j}(\hat\Phi)=\hat\Phi$
かつ$T_{i,j}(\check\Phi)=\check\Phi$である.

$F_{k}$は
$\varepsilon_{k}$に関する鏡映である.
\begin{align*}
  F_{k}\alpha_{i,j}=
  \begin{cases}
    \alpha_{i,j} & (k\not\in \Set{i,j})\\
    \beta_{i,k} & (k=j)\\
    -\beta_{j,k} & (i=k)\\
  \end{cases}
  \\
  F_k \beta_{i,j}=
  \begin{cases}
    \beta_{i,j} & (k\not\in \Set{i,j})\\
    \alpha_{i,k} & (k=j)\\
    \alpha_{j,k} & (i=k)
  \end{cases}
  \\
  F_{k}\varepsilon_{i}=
  \begin{cases}
    -\varepsilon_{k}&(i=k)\\
    \varepsilon_{i} &(i\neq k)
  \end{cases}
\end{align*}
であるので, 
$F_{k}(\hat\Phi)=\hat\Phi$
かつ$F_{k}(\check\Phi)=\check\Phi$である.

$F_{k,l}=F_kF_lT_{k,l}$は, $\beta_{k,l}$に関する鏡映である.
$T_{i,j}(\hat\Phi)=\hat\Phi$,
$T_{i,j}(\check\Phi)=\check\Phi$,
$F_{k}(\hat\Phi)=\hat\Phi$,
$F_{k}(\check\Phi)=\check\Phi$であるので,
$F_{k,l}(\hat\Phi)=\hat\Phi$,
$F_{k,l}(\check\Phi)=\check\Phi$である.

したがって, $\alpha\in \Phi$に対し,
$s_{\alpha}(\Phi)=\Phi$である.
また,
$\RR\alpha\cap\Phi=\Set{\alpha,-\alpha}$である.
$\numof{\Phi}=\binom{n}{2}+\binom{n}{2}+n=n^2$であるので,
$\Phi$はルート系である.
このルート系を$\Phi(B_{n})$とおく.

$F_{k,l}=F_kF_lT_{k,l}$であるので,
$\Braket{R(\Phi)}_\ZZ=\Braket{R(\Phi_1\cup \check{\Phi})}_\ZZ$
である.
したがって,
\cref{ex:bn:grp}の鏡映群を$W$とすると,
$W(\Phi)=W$である.

\subsection{$C_{n}$}
\label{ex:cn:root}
$\Phi=\Phi(B_n)$は,
ルート系であった.
$\alpha\in \Phi$に対し,
$s_{\alpha}(\check\Phi)=\check\Phi$,
$s_{\alpha}(\hat\Phi)=\hat\Phi$であり,
$s_{\alpha}(\check\Phi)\cap\hat\Phi=\emptyset$,
$s_{\alpha}(\hat\Phi)\cap\check\Phi=\emptyset$である.
したがって, $\check\Phi$のみを定数倍しても,
再びルート系になる.
例えば, $\varepsilon'_k=2\varepsilon_k$とし
\begin{align*}
  \Phi'&=\Set{\varepsilon'_k,-\varepsilon'_k|1\leq k\leq n}
  \Phi_1&=\Set{\alpha_{i,j},-\alpha_{i,j}|1\leq i<j\leq n}\\
  \Phi_2&=\Set{\beta_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\\
  \Phi''&=\Phi_1\cup \Phi_2\\
\end{align*}
とし,
\begin{align*}
  \Phi(C_n)&=\Phi'\cup\Phi''
\end{align*}
とおいても, $\Phi(C_n)$はルート系である.
また,
$R(\Phi(C_n))=R(\Phi(B_n))$であるので,
$W(\Phi(C_n))=W(\Phi(B_n))$でる.


\subsection{$D_{n}$}
\label{ex:dn:root}
$1\leq i<j\leq n$に対し,
$\alpha_{i,j}=\ee_i-\ee_j$,
$\beta_{i,j}=\ee_i+\ee_j$,
\begin{align*}
  \Phi_1&=\Set{\alpha_{i,j},-\alpha_{i,j}|1\leq i<j\leq n}\\
  \Phi_2&=\Set{\beta_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\\
  \Phi&=\Phi_1\cup \Phi_2
\end{align*}
とする.
このとき,
$\alpha\in \Phi$に対して,
$s_\alpha(\Phi)=\Phi$となっていた.
また,
$\RR\alpha\cap\Phi=\Set{\alpha,-\alpha}$である.
$\numof{\Phi}=n(n-1)$であるので,
$\Phi$はルート系である.
このルート系を$\Phi(D_{n})$とおく.

$R(\Phi)=\Set{T_{i,j},F_{i,j}|1\leq i< j\leq n}$
であるので,
\cref{ex:dn:grp}の鏡映群を$W$とすると,
$W(\Phi)=W$である.

\subsection{$G_2$}
\label{ex:g2:root}
$n=3$とする.
\begin{align*}
  \alpha_{i,j}&=\ee_i-\ee_j,\\
  \gamma_{i}&=-(\alpha_{i,1}+\alpha_{i,2}+\alpha_{i,3})
\end{align*}
とおき,
\begin{align*}
  \check\Phi&=\Set{\alpha_{i,j},-\alpha_{i.j}|1\leq i<j\leq 3},\\
  \hat\Phi&=\Set{\gamma_{i},-\gamma_{i}|1\leq i\leq 3},\\
  \Phi&=\check\Phi\cup\hat\Phi
\end{align*}
とする.

$\tau\in S_3$を$i$と$j$を入れ替える互換とすると,
\begin{align*}
  T_{i,j}\gamma_k=\gamma_{\tau(k)}
\end{align*}
である. したがって,
$T_{i,j}(\check\Phi)=\check\Phi$,
$T_{i,j}(\hat\Phi)=\hat\Phi$である.

$\Set{1,2,3}=\Set{i,j,k}$とする.
このとき,
\begin{align*}
  \gamma_{i}&=-(\alpha_{i,j}+\alpha_{i,k})=-2\ee_i+\ee_j+\ee_k\\
  \Braket{\gamma_{i},\alpha_{j,k}}
  &=\Braket{-2\ee_i+\ee_j+\ee_k,\ee_j-\ee_k}=0\\
  \Braket{\gamma_{i},\alpha_{i,j}}
  &=\Braket{-2\ee_i+\ee_j+\ee_k,\ee_i-\ee_j}=-3\\
  \Braket{\gamma_{i},\gamma_{j}}
  &=\Braket{\gamma_i,-\alpha_{j,i}-\alpha_{j,k}}=-3+0=-3\\
  \Braket{\gamma_{i},\gamma_{i}}
  &=\Braket{\gamma_i,-\alpha_{i,j}-\alpha_{i,k}}=3+3=6
\end{align*}
である. したがって,
\begin{align*}
  s_{\gamma_{i}}(\alpha_{j,k})&=\alpha_{j,k}-2\frac{0}{6}\gamma_i
  =\alpha_{j,k}\\
  s_{\gamma_{i}}(\alpha_{i,j})&=\alpha_{i,j}-2\frac{-3}{6}\gamma_i
  =\alpha_{i,j}-\alpha_{i,j}-\alpha_{i,k}=-\alpha_{i,k}\\
  s_{\gamma_{i}}(\gamma_{j})&=\gamma_{j}-2\frac{-3}{6}\gamma_i
  =\gamma_j+\gamma_i\\
  &=-2\ee_j+\ee_i+\ee_k-2\ee_i+\ee_j+\ee_k
  =2\ee_k-\ee_j-\ee_i=-\gamma_k
\end{align*}
である.
したがって,
$s_{\gamma_i}(\check\Phi)=\check\Phi$,
$s_{\gamma_i}(\hat\Phi)=\hat\Phi$である.
$\alpha\in\Phi$に対し, $\RR\alpha\cap\Phi=\Set{\alpha,-\alpha}$であり,
$\numof{\Phi}=12$であるので, $\Phi$はルート系である.
このルート系を$\Phi(G_2)$と書く.


\chapter{Simple system}
\section{simple system}
\begin{definition}
  $\Phi$をルート系とし, $\Delta\subset\Phi$とする.
  このとき,
  \begin{align*}
    \Phi_{\Delta}^{+}&=\Phi\cap \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta \geq 0}\\
    \Phi_{\Delta}^{-}&=\Phi\cap \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta \leq 0}
  \end{align*}
  とする.
  以下の条件を満たすとき$\Delta$を$\Phi$の単純系と呼ぶ:
  \begin{enumerate}
%  \item $\Delta\subset\Phi$
  \item $\Delta$は一次独立. %$\Braket{\Phi}_{\RR}$の基底.
  \item $\Phi = \Phi_\Delta^{+}\cup \Phi_\Delta^{-}$.
  \end{enumerate}
  また, $\Delta$が単純系であるとき,
  $\Phi_{\Delta}^+$を$\Delta$に関するポジティブシステム,
  $\Phi_{\Delta}^-$を$\Delta$に関するネガティブシステムと呼ぶ.
  また,
  $\Phi_{\Delta}^+$の元を$\Delta$に関する正ルート,
  $\Phi_{\Delta}^-$の元を$\Delta$に関する負ルートと呼ぶ.
\end{definition}
\begin{remark}
  $\Phi = \Phi_\Delta^{+}\cup \Phi_\Delta^{-}$がなりたつなら, $\Phi$の元は$\Delta$の元の一次結合としてかけることがわかる.
  また, $\Delta\subset\Phi$であるから,
  $\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$である.
  $\Delta$は一次独立なので, $\Delta$は$\Braket{\Phi}_{\RR}$の基底である.
\end{remark}
\begin{prop}
  \label{lemma:cone:sparable}
  $\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
  このとき,
  \begin{align*}
    \Phi_{\Delta}^+&=\Set{\alpha\in\Phi | \Braket{\alpha,\varpi} > 0}\\
    \Phi_{\Delta}^-&=\Set{\alpha\in\Phi | \Braket{\alpha,\varpi} < 0}
  \end{align*}
  をみたす$\varpi\in V$が存在する.
  とくに, 
  $\Phi_{\Delta}^+\cap\Phi_{\Delta}^-=\emptyset$である.
\end{prop}
\begin{proof}
  $\delta\in\Delta$とする.
  $F_\delta=\Braket{\Delta\setminus\Set{\delta}}_\RR$とする.
  $\Delta$は基底であり一次独立であるので,
  $\delta\not\in F_\delta$である.
  $V=F_\delta\oplus (F_\delta)^\perp$であるので,
  $\delta=\hat\delta+\check\delta$をみたす$\hat\delta\in F_\delta$と$\check\delta\in (F_\delta)^\perp$
  が存在する.
  $\delta\not\in F_\delta$であることから,
  $\check\delta \neq\zzero$である.
  このとき,
  \begin{align*}
    \Braket{\alpha,\check\delta}
    =
    \begin{cases}
      0 & (\alpha\in \Delta\setminus\Set{\delta})\\
      \Braket{\check\delta,\check\delta}>0 & (\alpha=\delta)
    \end{cases}
  \end{align*}
  である.
  \begin{align*}
    \varpi=\sum_{\delta\in\Delta}\check\delta
  \end{align*}
  とおくと, $\alpha\in\Delta$に対し,
  \begin{align*}
    \Braket{\alpha,\varpi}
    =\Braket{\alpha,\sum_{\delta\in\Delta}\check\delta}
    =\Braket{\check\alpha,\check\alpha}>0
  \end{align*}
  したがって, $\alpha=\sum_{\delta\in \Delta}c_\delta \delta$
  に対し,
  \begin{align*}
    \Braket{\alpha,\varpi}=\sum_{\delta\in\Delta} c_\delta\Braket{\check\delta,\check\delta}
  \end{align*}
  であるから,
  $\alpha\in \Phi_\Delta^+$なら$\Braket{\alpha,\varpi}>0$であり,
  $\alpha\in \Phi_\Delta^-$なら$\Braket{\alpha,\varpi}<0$である.
\end{proof}
\begin{remark}
  ルート系$\Phi$の単純系$\Delta$に対し,
  \cref{lemma:cone:sparable}の証明中で構成した$\check\delta$を使うと,
  \begin{align*}
    \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta\geq 0}
    &= \bigcup_{\delta\in\Delta} \Set{\lambda\in \Braket{\Phi}_\RR |\Braket{\lambda,\check\delta} }\\
    \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta\geq 0}
    &\subset\bigcup_{\delta\in\Delta} \Set{\lambda\in V |\Braket{\lambda,\check\delta} }
  \end{align*}
  である.
\end{remark}
\begin{lemma}
  \label{lem:simplesumissimplesystem:}
  $\Phi$をルート系とする.
  $\Pi\subset \Phi$に対し,
  \begin{align*}
    X(\Pi)&= \Set{\sum_{\gamma\in\Pi}a_\gamma\gamma| a_\gamma\geq 0, \numof{\Set{\gamma|a_\gamma>0}}>1}\\
    \Delta(\Pi)&= \Phi_{\Delta}^+ \setminus X(\Pi)
  \end{align*}
  とおく.
  $\Delta\subset \Phi$を単純系ならば,
  \begin{align*}
    \Delta=\Delta(\Phi_\Delta^+).
  \end{align*}
\end{lemma}
\begin{proof}
  $\alpha \in \Phi_\Delta^+\setminus\Delta$とする.
  $\alpha\in \Phi_\Delta^+$
  であるので,
  $a_\delta > 0$をつかって,
  $\alpha=\sum{\delta\in\Delta}a_\delta \delta$と表せる.
  もし, すべての$\delta\neq\delta_0$で$a_\delta=0$なら,
  $\alpha=a_{\delta_0} \delta_0$とかけるが,
  $\Phi$がルート系であるので, $a_{\delta_0}=1$であり,
  $\alpha=\delta_0\in\Delta$である.
  よって, $\numof{\Set{\delta|a_\delta>0}}>1$である.
  したがって, $\alpha\not\in \Delta(\Phi_\Delta^+)$
  である.


  $\alpha\in\Delta$とする.
  $\alpha\in\Delta \subset \Phi_\Delta^+$であるので,
  $\alpha\not\in X(\Phi_\Delta^+)$を示す.
  $\gamma\in\Phi_\Delta^+$は,
  $c_{\gamma,\delta}\geq 0$をつかって,
  $\gamma=\sum_{\delta}c_{\gamma,\delta}\delta$とかけるとする.
  この記号の下,
  $a_\gamma\geq 0$をつかって,
  $\alpha=\sum_{\gamma\in\Phi_\Delta^+}a_\gamma\gamma$とかけているとすると,
  $\gamma\in \Phi_\Delta^+$であるので,
  \begin{align*}
    \alpha
    &=\sum_{\gamma\in\Phi_\Delta^+}\sum_{\delta\in\Delta}a_\gamma c_{\gamma,\delta}\delta\\
    &=\sum_{\delta\in\Delta}(\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\delta})\delta
  \end{align*}
  である. $\alpha\in\Delta$であったので,
  \begin{align*}
    \alpha
    &=
    (\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\alpha})\alpha
    +\sum_{\delta\in\Delta\setminus\Set{\alpha}}(\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\delta})\delta\\
    \zzero
    &=
    (-1+\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\alpha})\alpha
    +\sum_{\delta\in\Delta\setminus\Set{\alpha}}(\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\delta})\delta
  \end{align*}
  である. 
  $\Delta$は$\Braket{\Phi}_\RR$の基底であるから,　
  \begin{align*}
    \sum_{i=1}^la_i c_{i,\delta}=
    \begin{cases}
      1 &  (\alpha\neq\delta)\\
      0 & (\alpha\neq\delta)
    \end{cases}
  \end{align*}
  である.
  $a_\gamma>0$とすると,
  $\alpha\neq\delta$に対して, $c_{\gamma,\delta}=0$.
  $\gamma=\sum_{\delta\in\Delta}c_{\gamma,\delta}\delta$とがけていたので,
  \begin{align*}
    \gamma=\sum_{\delta\in\Delta}c_{\gamma,\delta}\delta=c_{\gamma,\alpha}\alpha
  \end{align*}
  である.
  $\gamma\in\Phi_\Delta^+$であるので, ルート系の定義から,
  $c_{\gamma,\alpha}=1$, つまり, $\alpha=\gamma$がわかる.
  よって, $\Set{\gamma|a_\gamma>0}=\Set{\alpha}$であり,
  $\numof{\Set{\gamma|a_\gamma>0}}=1$である.

\end{proof}

\begin{theorem}
  $\Phi$をルート系とし,
  $\Delta,\Delta'\subset \Phi$を単純系とする.
  このとき, 次は同値:
  \begin{enumerate}
  \item $\Delta=\Delta'$.
  \item $\Phi_\Delta^+=\Phi_{\Delta'}^+$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  $\Delta=\Delta'$に対し
  $\Phi_\Delta^+=\Phi_{\Delta'}^+$となることは定義から明白である.

  $\Phi_\Delta^+=\Phi_{\Delta'}^+$とする.
  このとき,
  \cref{lem:simplesumissimplesystem:}から,
  $\Delta=\Delta(\Phi_\Delta^+)=\Delta(\Phi_{\Delta'}^+)=\Delta'$である.

\end{proof}

\section{例}

\subsection{$I_2(m)$}
$\Phi=\Phi(I_2(m))$とし,
\Cref{ex:i2m:root}と同じ記号を用いる.
$\Phi=\Set{\alpha_i|i\in\Set{0,\ldots,2m-1}}$であり, $\alpha_{i+m}=-\alpha_i$であった.
$\Delta=\Set{\alpha_0,\alpha_{m-1}}$とする.
このとき,
$\alpha_{0}=\alpha(0)$, $\alpha_{m-1}=\alpha(\frac{(m-1)\pi}{m})$であったので,
$\Delta$は一次独立であり, $V=\Braket{\Phi}_\RR$の基底である.

\begin{align*}
  \eta_1&=\alpha(\frac{\pi}{2}),\\
  \eta_2&=\alpha(\frac{(m-1)\pi}{m}-\frac{\pi}{2})=\alpha(\frac{-\pi}{m}+\frac{\pi}{2}),
\end{align*}
とおくことにする.
$\Braket{\alpha_0, \eta_1} = 0$であるので, $\RR\alpha_0=H_{\eta_1}$である.
また, 
$\Braket{\alpha_{m-1}, \eta_2} = 0$であるので, $\RR\alpha_0=H_{\eta_2}$である.
さらに,
\begin{align*}
 \Lambda_1&= \Set{\lambda\in V|\Braket{\lambda,\eta_1}\geq 0}\\
 \Lambda_2&= \Set{\lambda\in V|\Braket{\lambda,\eta_2}\geq 0}\\
 \Lambda&=\Lambda_1\cap \Lambda_2
\end{align*}
とおくと,
\begin{align*}
  \Set{a\alpha_0+b\alpha_{m-1}|a\geq 0,b\geq 0}=\Lambda
\end{align*}
である. また, $-\Lambda=\Set{-\lambda|\lambda\in\Lambda}$とすると
\begin{align*}
  \Set{a\alpha_0+b\alpha_{m-1}|a\leq 0,b\leq 0}=-\Lambda
\end{align*}
である.
\begin{align*}
  \Braket{\alpha_i,\eta_1}&=\Braket{\alpha(\frac{i\pi}{m}),\alpha(\frac{\pi}{2})}\\
  &=\cos(\frac{i\pi}{m}-\frac{\pi}{2})=\sin(\frac{i\pi}{m})\\
\Braket{\alpha_i,\eta_2}&=\Braket{\alpha(\frac{i\pi}{m}),\alpha(\frac{-\pi}{m}+\frac{\pi}{2})}\\
&=\cos(\frac{i\pi}{m}-(\frac{-\pi}{m}+\frac{\pi}{2}))
=\cos(\frac{(1+i)\pi}{m}-\frac{\pi}{2})
=\sin(\frac{(1+i)\pi}{m})
\end{align*}
であるので,
\begin{align*}
\Set{\alpha_{i}|i\in\Set{0,1,\ldots,m-1}}\subset\Lambda\\
\Set{\alpha_{m+i}|i\in\Set{0,1,\ldots,m-1}}\subset\Lambda
\end{align*}
である.  したがって,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha_{i}|i\in\Set{0,1,\ldots,m-1}}\\
\Phi_\Delta^-&=\Set{\alpha_{m+i}|i\in\Set{0,1,\ldots,m-1}}
\end{align*}
であるので, $\Phi=\Phi_\Delta^+\cup\Phi_\Delta^-$である.
よって$\Delta$は$\Phi$の単純系である.
また,
$\varpi=\eta_1+\eta_2$とおけば,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.
\subsection{$A_{1}\times\cdots\times A_{1}$}
\cref{ex:a1n:root}で考えたルート系について考える.
つまり, $\varepsilon_i=\ee_i$とし,
$\Phi=\Set{\varepsilon_k,-\varepsilon_k|k\in\Set{1,\ldots,n}}$
とおく.
\begin{align*}
  \Delta=\Set{\varepsilon_1,\ldots,\varepsilon_n}
\end{align*}
とおくと, $\Delta$は$V$の標準基底である.
したがって, $\Braket{\Phi}_\RR$でもある.
あきらかに, $\Phi_\Delta^+=\Delta$であり,
$\Phi_\Delta^+=\Set{-\varepsilon_k|k\in\Set{1,\ldots,n}}$
である.  
$\Phi=\Phi_\Delta^+\cup\Phi_\Delta^-$であるので,
$\Delta$は$\Phi$の単純系である.
また, $\varpi=\ee_1+\cdots+\ee_n$とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.

\subsection{$A_{n-1}$}
\label{ex:an:simple}
$\Phi=\Phi(A_{n-1})$とし,
\cref{ex:an:root}の記号を用いる.
$\alpha_{i,j}=\ee_i-\ee_j$であり, $\Phi=\Set{\alpha_{i,j}, -\alpha_{i,j}|1\leq i<j\leq n}$である.
\begin{align*}
  \Delta=\Set{\alpha_{1,2},\alpha_{2,3},\ldots,\alpha_{n-1,n}}=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}
\end{align*}
とおく.
$k>0$に対し,
\begin{align*}
\alpha_{i,i+k}&=\alpha_{i,i+1}+\alpha_{i+1,i+2}+\cdots+\alpha_{i+k-1,i+k}
\end{align*}
であるので,
\begin{align*}
  \Set{\alpha_{i,j}|1\leq i<j\leq n}\subset \Phi_\Delta^+
\end{align*}
である.  したがって
\begin{align*}
  \Set{-\alpha_{i,j}|1\leq i<j\leq n}\subset \Phi_\Delta^-
\end{align*}
である.
$\Phi=\Phi_\Delta^+\cup \Phi_\Delta^-$であるので,
$\Phi\subset \Braket{\Delta}_\RR$である.
また,
\begin{align*}
  c_1\alpha_{1,2}+c_2\alpha_{2,3}+\cdots+c_{n-1}\alpha_{n-1,n}=\zzero
\end{align*}
とすると,
\begin{align*}
  &c_1\alpha_{1,2}+c_2\alpha_{2,3}+\cdots+c_{n-1}\alpha_{n-1,n}\\
  &=c_1(\ee_1-\ee_2)+c_2(\ee_2-\ee_3)+\cdots+c_{n-1}(\ee_{n-1}-\ee_n)\\
  &=c_1\ee_1+(c_2-c_1)\ee_2+(c_3-c_2)\ee_3+\cdots+(c_{n-1}-c_{n-2})\ee_{n-1}-c_{n-1}\ee_n
\end{align*}
であるので,
\begin{align*}
  \begin{cases}
    c_1=0 &\\
    -c_{n-1}=0 &\\
    c_i-c_{i-1}=0 &(i=2,3,\ldots,n-1)\\
  \end{cases}
\end{align*}
となる.
したがって全ての$i$に対し$c_i=0$である.
よって, $\Delta$は一次独立である.
したがって, $\Delta$は$\Braket{\Phi}_\RR$の基底である.
$\Delta$は$\Phi$の単純系である.
\begin{align*}
  \eta_{1,k}=\ee_1+\cdots+\ee_k
\end{align*}
とおと,
\begin{align*}
  \Braket{\eta_{1,k},\alpha_{j,j+1}}=
  \begin{cases}
    1 &(k=j)\\
    0 &(k\neq j)
  \end{cases}
\end{align*}
である.
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n-1}\\
  &=(n-1)\ee_1+(n-2)\ee_1+\cdots+\ee_{n-1}
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$B_{n}$}
\label{ex:bn:simple}と同様に,
$\Phi=\Phi(B_n)$とし,
\cref{ex:bn:root}の記号を用いる.
$\alpha_{i,j}=\ee_i-\ee_j$,
$\beta_{i,j}=\ee_i+\ee_j$,
$\varepsilon_{k}=\ee_k$であった.
$\Set{\varepsilon_{1},\ldots,\varepsilon_n}$は$V$の標準基底であるので,
$V=\Braket{\Phi}_{\RR}$である.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}\cup \Set{\varepsilon_n}
\end{align*}
とおく.
このとき, $1\leq i<j\leq n$, $1\leq k<n$に対し,
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\varepsilon_{k}&=\alpha_{i,n}+\varepsilon_{n}\\
\beta_{i,j}&=\alpha_{i,j}+2\varepsilon_{j}
\end{align*}
とかけるので,
\begin{align*}
  \Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\cup \Set{\varepsilon_k | k\in\Set{1,\ldots,n}}\subset\Phi_\Delta^+
\end{align*}
である.
したがって,
\begin{align*}
  \Set{-\alpha_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\cup \Set{-\varepsilon_k | k\in\Set{1,\ldots,n}}\subset\Phi_\Delta^-
\end{align*}
であるので, $\Phi=\Phi_\Delta^+\cup \Phi_\Delta^-$である.  したがって$\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$である.
また, $\numof{\Delta}=n=\dim(V)$であるので, $\Delta$は$V=\Braket{\Phi}_\RR$の基底である.

\Cref{ex:an:simple}と同様に,
\begin{align*}
  \eta_{1,k}=\ee_1+\cdots+\ee_k
\end{align*}
とおと,
\begin{align*}
  \Braket{\eta_{1,k},\varepsilon_{n}}=
  \begin{cases}
    1 &(k=n)\\
    0 &(k\neq n)
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n}\\
  &=n\ee_1+(n-1)\ee_1+\cdots+2\ee_{n-1}+\ee_{n}
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$C_{n}$}
$\Phi=\Phi(C_n)$とし
\cref{ex:cn:root}の記号を用いる.
$\varepsilon'_k=2\varepsilon_k$である.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}\cup \Set{\varepsilon'_n}
\end{align*}
とおく.
このとき, $1\leq i<j\leq n$, $1\leq k <n$に対し,
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\beta_{k,n}&=\alpha_{k,n}+\varepsilon'_{n}\\
\beta_{i,j}&=\alpha_{i,n}+\beta{j,n}\\
\varepsilon'_{k}&=\alpha_{i,n}+\beta_{i,n}
\end{align*}
とかけるので,
\begin{align*}
  \Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\cup \Set{\varepsilon'_k | k\in\Set{1,\ldots,n}}\subset\Phi_\Delta^+
\end{align*}
である. よって, $\Phi=\Phi_\Delta^+\cup \Phi_\Delta^-$であり, $V=\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$かつ$\numof{\Delta}=n$であるので,
$\Delta$は$\Phi$の単純系である.


\Cref{ex:bn:simple}と同様に,
\begin{align*}
  \eta_{1,k}=\ee_1+\cdots+\ee_k
\end{align*}
とおと,
\begin{align*}
  \Braket{\eta_{1,k},\varepsilon'_{n}}=
  \begin{cases}
    2 &(k=n)\\
    0 &(k\neq n)
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n}\\
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$D_{n}$}
$\Phi=\Phi(D_n)$とし
\cref{ex:dn:root}の記号を用いる.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}\cup \Set{\beta_{n-1,n}}
\end{align*}
とする.
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\beta_{j,n}&=\alpha_{k,n-1}+\beta_{n-1,n}\\
\beta_{i,j}&=\alpha_{i,n}+\beta{j,n}\\
\end{align*}
であるので, 
\begin{align*}
  \Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\subset\Phi_\Delta^+
\end{align*}
である. したがって,
\begin{align*}
  \Set{-\alpha_{i,j},-\beta_{i,j}|1\leq i<j\leq n}&\subset\Phi_\Delta^-\\
  \Phi&=\Phi_\Delta^+\cup\Phi_\Delta^-
\end{align*}
であるので,
$\Braket{\Delta}_\RR=\Braket{\Phi}_\RR=V$
である.
$\numof{\Delta}=n=\dim(V)$であるので, $\Delta$は$V=\Braket{\Phi}_\RR$の基底であり,
$\Delta$は$\Phi$の単純系である.


\begin{align*}
  \eta_{1,k}&=\ee_1+\cdots+\ee_k\\
  \eta'&=\eta_{1,n}\\
  \eta''&=\eta_{1,n-1}-\ee_n=\ee_1+\cdots+\ee_{n-1}-\ee_n
\end{align*}
とおと, $k<n-1$に対し,
\begin{align*}
  \Braket{\eta_{1,k},\beta_{n-1,n}}&=0\\
  \Braket{\eta',\beta_{n-1,n}}&=2\\
  \Braket{\eta'',\beta_{n-1,n}}&=0\\
  \Braket{\eta'',\alpha_{i,i+1}}&=
  \begin{cases}
    2 &(i=n-1)\\
    0 &(i\neq n-1)
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n-2}+\eta'+\eta''\\
  &=\eta_{1,1}+\cdots+\eta_{n}-\ee_n\\
  &=n\ee_1+(n-1)\ee_1+\cdots+2\ee_{n-1}
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$G_2$}
$\Phi=\Phi(G_2)$とし,
\cref{ex:g2:root}の記号を用いる.
$n=3$であり,
\begin{align*}
  \alpha_{i,j}&=\ee_i-\ee_j,\\
  \gamma_{i}&=\alpha_{i,1}+\alpha_{i,2}+\alpha_{i,3}
\end{align*}
であった.
\begin{align*}
  \Delta=\Set{\alpha_{1,2},\gamma_{1}}
\end{align*}
とおく.
\begin{align*}
  \alpha_{1,2}&=\ee_1-\ee_2\\
  \gamma_{1}&=-2\ee_1+\ee_2+\ee_3\\
  \gamma_{1}+\alpha_{1,2}&=\alpha_{3,1}\\
  \gamma_{1}+2\alpha_{1,2}&=\alpha_{3,2}\\
  \gamma_{1}+3\alpha_{1,2}&=\alpha_{3,2}+\alpha_{1,2}=\gamma_{2}\\
  2\gamma_{1}+3\alpha_{1,2}&=\gamma_1+\gamma_{2}=-\gamma_3
\end{align*}
である.  したがって,
\begin{align*}
\Set{ \alpha_{1,2},\gamma_{1}, \alpha_{3,1},\alpha_{3,2},\gamma_{2},-\gamma_3}
&\subset
  \Phi_\Delta^+\\
\Set{ \alpha_{2,1},-\gamma_{1}, \alpha_{1,3},\alpha_{2,3},-\gamma_{2},\gamma_3}
&\subset
  \Phi_\Delta^-
\end{align*}
である.
したがって, $\Phi=\Phi_\Delta^+\cup\Phi_\Delta^-$
であり, $\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$である.
また, $\Delta$は一次独立であるから,
$\Delta$は$\Phi$の単純系である.
\begin{align*}
  \eta_1&=\ee_3\\
  \eta_2&=\ee_1+2\ee_3
\end{align*}
とおけば,
\begin{align*}
  \Braket{\eta_1,\alpha_{1,2}}&=0\\
  \Braket{\eta_2,\alpha_{1,2}}&=1\\
  \Braket{\eta_1,\gamma_{1}}&=1\\
  \Braket{\eta_2,\gamma_{1}}&=0\\
\end{align*}
であるので, $\varpi=\eta_1+\eta_2$
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\chapter{Simple systemの性質}
\section{Simple systemの存在}
$\Phi$をルート系とする.
$M(\Phi)=V \setminus (\bigcup_{\alpha\in\Phi}H_\alpha)$
とおくと,
$\Phi$は有限集合であるので$M(\Phi)\neq \emptyset$である.
$\varpi\in M(\Phi)$に対し,
\begin{align*}
  \Phi_{\varpi}^+&=\Set{\alpha\in\Phi|\Braket{\varpi,\alpha}>0}\\
  \Phi_{\varpi}^-&=\Set{\alpha\in\Phi|\Braket{\varpi,\alpha}<0}
\end{align*}
とおく.
$\varpi\in M(\Phi)$であるので$\Phi=\Phi_{\varpi}^+\cup \Phi_{\varpi}^-$
である.
$\Pi\subset \Phi_{\varpi}^+$に対し,
\begin{align*}
  \RR_{\geq 0}\Pi =
  \Set{\sum_{\delta\in\Pi}a_\delta \delta|a_\delta \geq 0}
\end{align*}
とおく.
\begin{align*}
  \SSS =
  \Set{\Pi\subset \Phi_{\varpi}^+|\Phi_{\varpi}^+\subset \RR_{\geq 0}\Pi}
\end{align*}
とおく.
$\Phi_{\varpi}^+\subset \RR_{\geq 0}\Phi_{\varpi}^+$であるで,
$\Phi_{\varpi}^+\in\SSS$
であり, $\SSS\neq\emptyset$である.
そこで, $r=\min\Set{\numof{\Pi}|\Pi\in\SSS}$
とし, $\Delta_{\varpi}\in\SSS$が$\numof{\Delta_{\varpi}}=r$をみたしているとする.
\begin{lemma}
  \label{lem:simple:posiindp}
  $\alpha\in \Delta_{\varpi}$とすると,
  $\alpha\not\in\RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\alpha})$.
\end{lemma}
\begin{proof}
  $\alpha\in \Delta_{\varpi}$かつ$\alpha\in\RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\alpha})$
  とすると, $\Delta_{\varpi}\setminus\Set{\alpha}\in\SSS$である.
\end{proof}

\begin{lemma}
  \label{lem:pidelta:innerprod}
  $\lambda,\mu\in\Delta_{\varpi}$かつ$\lambda\neq \mu$なら, $\Braket{\lambda,\mu}\leq 0$.
\end{lemma}
\begin{proof}
  $\lambda,\mu\in\Delta_{\varpi}$かつ
  $\Braket{\lambda,\mu}>0$とする.
  このとき,
  \begin{align*}
    c=2\frac{\Braket{\lambda,\mu}}{\Braket{\lambda,\lambda}}
  \end{align*}
  とすると,
  $c>0$である.
  また,
  $s_\lambda(\mu)=\mu-c\lambda$である.
  $s_\alpha(\Phi)=\Phi=\Phi_{\varpi}^+\cup\Phi_{\varpi}^-$である.

  まず, $s_\lambda(\mu)\in\Phi_{\varpi}^+$のときについて考える.
  $s_\lambda(\mu)=\sum_{\gamma\in\Delta_{\varpi}}c_\gamma\gamma$,
  $c_\gamma\geq 0$とする.
  \begin{align*}
    s_\lambda(\mu)=\mu-c\lambda
    =c_\mu\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align*}
  である.
  したがって,
  \begin{align}
    \label{lem:simple:innerprod:eq:1}
    \mu-c\lambda
    =c_\mu\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align}
  である.

  $c_\mu<1$のとき,
  \cref{lem:simple:innerprod:eq:1}を
  \begin{align*}
    \mu-c_\mu\mu
    &=c\lambda+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma\\
    (1-c_\mu)\mu
    &=c\lambda+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma\\
    \mu
    &=\frac{c}{(1-c_\mu)}\lambda+
    \sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}\frac{c_\gamma}{(1-c_\mu)}\gamma\\
  \end{align*}
  と変形する.
   $1-c_\mu>0$であるので, $\mu\in \RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\mu})$となる.
  これは\Cref{lem:simple:posiindp}に矛盾する.

  $c>1$のとき,
  \cref{lem:simple:innerprod:eq:1}を
  \begin{align*}
    \zzero
    &=c\lambda+(c_\mu -1)\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align*}
  と変形する.
  $\Delta_{\varpi}\subset\Phi_\varpi^+$であるので,
  \begin{align*}
    \Braket{c\lambda+(c_\mu -1)\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma,\varpi} \geq
    \Braket{c\lambda,\varpi}=c\Braket{\lambda,\varpi}>0=\Braket{\zzero,\varpi}
  \end{align*}
  となり矛盾する.
  

  次に, $s_\lambda(\mu)\in\Phi_{\varpi}^-$のときについて考える.
  $-s_\lambda(\mu)\in\Phi_{\varpi}^+$
  である.
  $-s_\lambda(\mu)=\sum_{\gamma\in\Delta_{\varpi}}c_\gamma\gamma$,
  $c_\gamma\geq 0$とする.
  $s_\lambda(\mu)\in\Phi_{\varpi}^+$のときと同様の計算で,
  \begin{align}
    \label{lem:simple:innerprod:eq:2}
    c\lambda-\mu
    =c_\lambda\lambda+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\lambda}}c_\gamma\gamma
  \end{align}
  がわかる.

  $c>c_\lambda$のとき,
  \cref{lem:simple:innerprod:eq:2}を
  \begin{align*}
    \lambda=
    &=\frac{1}{(c-c_\lambda)}\mu+
    \sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\lambda}}\frac{c_\gamma}{(c-c_\lambda)}\gamma\\
  \end{align*}
  と変形する.
  $\lambda\in \RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\lambda})$となり,
  \Cref{lem:simple:posiindp}に矛盾する.

  $c\leq c_\lambda$のとき,
  \cref{lem:simple:innerprod:eq:2}を
  \begin{align*}
    \zzero
    &=\mu+(c_\lambda-c)\lambda++\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align*}
  と変形する.
  \begin{align*}
    \Braket{\mu+(c_\lambda-c)\lambda++\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma,\varpi}
    \geq \Braket{\mu,\varpi}>0=
    \Braket{\zzero,\varpi}
  \end{align*}
  となり矛盾する.
\end{proof}


\begin{lemma}
  \label{lem:simple:linidep}
$\Delta_{\varpi}$は一次独立である.
\end{lemma}
\begin{proof}
  $\sum_{\lambda\in\Delta_{\varpi}}a_\lambda \lambda = \zzero$
  とする.
  \begin{align*}
    \Pi^+&=\Set{\lambda\in\Pi|a_\lambda >0}\\
    \Pi^-&=\Set{\lambda\in\Pi|a_\lambda <0}
  \end{align*}
  とし$b_\lambda=-a_\lambda$とする.
  \begin{align*}
    v_+&=
\begin{cases}
  \sum_{\lambda\in\Pi^+}a_\lambda\lambda&(\Pi^+\neq \emptyset)\\
  \zzero&(\Pi^+= \emptyset)
\end{cases}\\
v_-&=
\begin{cases}
\sum_{\lambda\in\Pi^-}a_\lambda\lambda&(\Pi^-\neq \emptyset)\\
  \zzero&(\Pi^-= \emptyset)
\end{cases}
  \end{align*}
  とする. $v_+-v_-=\zzero$である.
  したがって$v_+=v_-$である.
\Cref{lem:pidelta:innerprod}より,
  \begin{align*}
    \Braket{v_+,v_-}&
    =\sum_{\mu\in\Pi^+}\sum_{\lambda\in\Pi^-}a_\mu b_\lambda \Braket{\mu,\lambda}
    \leq 0 
  \end{align*}
  となるが, $0\leq \Braket{v_+,v_+}=\Braket{v_+,v_-}\leq 0$であるので,
  $\Braket{v_+,v_+}=0$となる.  したがって$v_+=\zzero$.
  $v_-=v+=\zzero$であるので,
  すべての$\lambda$に対し,
  $a_\lambda=0$である.
\end{proof}



\begin{prop}
  $\Delta_{\varpi}$は$\Phi$の単純系であり,
  $\Phi^+_{\Delta_{\varpi}}=\Phi_{\varpi}^+$である.
\end{prop}
\begin{proof}
  定義から
  $\Phi_{\varpi}^+\subset \RR_{\geq 0}\Delta_{\varpi}$であり,
  $\Delta_{\varpi}\subset\Phi$である.
  したがって, $\Braket{\Delta_{\varpi}}_\RR=\Braket{\Phi^+}_\RR=\Braket{\Phi}_\RR$.
  \Cref{lem:simple:linidep}から, $\Delta_{\varpi}$は一次独立であるので,
  $\Delta_{\varpi}$は$\Braket{\Phi}_\RR$の基底である.

  また, $\Delta_{\varpi}\subset \Phi_{\varpi}^+$であるので,
  $\RR_{\geq 0}\Delta_{\varpi}\cap \Phi_{\varpi}^-=\emptyset$である.
  $\Phi=\Phi_{\varpi}^+\cup \Phi_{\varpi}^-$であるので,
  \begin{align*}
    \Phi_{\Delta_{\varpi}}^+=\Phi_{\varpi}^+\\
    \Phi_{\Delta_{\varpi}}^-=\Phi_{\varpi}^-
  \end{align*}
  である.
\end{proof}


\begin{cor}
  ルート系$\Phi$に対し, 単純系$\Delta$は存在する.
\end{cor}
\begin{proof}
  $\varpi\in M(\Phi)$とし, $\Delta_\varpi$とすればよい.
\end{proof}
\begin{remark}
  $\varpi\in M(\Phi)$のとり方に, $\Delta_\varpi$は依存する.
\end{remark}

\begin{theorem}
  $\Phi$をルート系とし,
  $\Delta$を単純系とする.
  $\lambda,\mu\in\Delta$かつ$\lambda\neq \mu$なら, $\Braket{\lambda,\mu}\leq 0$.
  
\end{theorem}
\begin{proof}
  \Cref{lemma:cone:sparable}より,
  $\Phi_\Delta^+=\Delta_\varpi^+$となる, $\varpi$がとれる.
  このとき, $\Delta=\Delta_\varpi$であるので,
  \Cref{lem:pidelta:innerprod}よりわかる.
\end{proof}



\begin{definition}
  $\Phi$をルート系とする.
  $\rank(\Phi)=\dim(\Braket{\Phi}_\RR)$
  と定義し, $\Phi$の階数と呼ぶ.
\end{definition}

\begin{remark}
  $\Delta$は
  $\Braket{\Phi}_\RR$の基底であったので,
  $\Delta$のとり方によらず,
  $\numof{\Delta}=\rank(\Phi)$
\end{remark}


\chapter{Symple rootの性質}
\section{Symple rootの性質}
ここでは特に断らない限り,
$\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
また, $\Phi^+=\Phi_\Delta^+$とする.
\begin{prop}
  \label{prop:simple:reflect:positive2positive}
  $\alpha\in\Delta$に対し,
  $s_\alpha(\Phi^+\setminus\Set{\alpha})=\Phi^+\setminus\Set{\alpha}$.
\end{prop}
\begin{proof}
$\alpha\in\Delta$とする.

$s_\alpha(\Phi^+\setminus\Set{\alpha})\subset\Phi^+\setminus\Set{\alpha}$
を示す.

$\beta=\sum_{\delta\in\Delta}c_\delta\delta \in \Phi^+\setminus \Set{\alpha}$
とする. $c_\delta\geq 0$である.
$\beta=c_\alpha\alpha$とかけたとすると,
 $\Phi$はルート系であるので,
$\Phi\cap\RR\alpha=\Set{\alpha,-\alpha}$であるから,
$c_\alpha\in\Set{1,-1}$である.
$\beta$は仮定より$\alpha$ではなく,
また $-\alpha\in \Phi^-$でもない.
したがって,
$c_{\delta}> 0$をみたす
$\delta\in\Delta\setminus\Set{\alpha}$が存在する.
$\gamma\in\Delta\setminus\Set{\alpha}$が
$c_{\gamma}> 0$をみたすとする.

ルート系の定義より,
$s_\alpha(\Phi)=\Phi$であるので,
$s_\alpha(\beta)\in \Phi$.
$c=2\frac{\Braket{\beta,\alpha}}{\Braket{\alpha,\alpha}}$
とすると,
\begin{align*}
  s_\alpha(\beta)&=\beta-c\alpha\\
  &=c_{\gamma}\gamma +(c_\alpha-c)\alpha + \sum_{\delta\in\Delta\setminus\Set{\delta_0,\alpha}}c_\delta\delta.
\end{align*}
$c_\gamma>0$であることから$s_\alpha(\beta)\in\Phi^+$であることがわかる.
また, $\Delta$は一次独立であるので,
\begin{align*}
  s_\alpha(\beta)-\alpha\\
  &=c_{\gamma}\gamma +(c_\alpha-c-1)\alpha + \sum_{\delta\in\Delta\setminus\Set{\delta_0,\alpha}}c_\delta\delta\neq \zzero
\end{align*}
であるので, $s_\alpha(\beta)\neq\alpha$である.


$s_\alpha(\Phi^+\setminus\Set{\alpha})\supset\Phi^+\setminus\Set{\alpha}$
を示す.
$\beta\in\Phi^+\setminus\Set{\alpha}$
とする.
$\gamma=s_\alpha(\beta)$とおくと,
$\gamma\in \Phi^+\setminus\Set{\alpha}$であることはすでに示した.
$s_\alpha s_\alpha=\id_V$であるから,
$\beta=s_\alpha(s_\alpha(\beta))=s_\alpha(\gamma)$
と
かけるので, $\beta\in s_\alpha(\Phi^+\setminus\Set{\alpha})$.
\end{proof}
$\alpha\in\Delta$に対し,
$s_\alpha$で負ルートになる正ルートは$\alpha$のみである.
以下のように言い換えることもできる.
\begin{cor}
  $\alpha\in\Delta$とする.
  $s_\alpha(\beta)\in\Phi^+$かつ$\beta\in\Phi^+$ならば
  $\alpha=\beta$である.
\end{cor}
\begin{cor}
  $\alpha\in\Delta$に対し,
  $(s_\alpha)^{-1}(\Phi^-)\cap\Phi^+=\Set{\alpha}$
\end{cor}
$(s_\alpha)^{-1}=s_\alpha$であるので,
次のように言い換えることもできる.
\begin{cor}
  $\alpha\in\Delta$に対し,
  $s_\alpha(\Phi^-)\cap\Phi^+=\Set{\alpha}$
\end{cor}

\section{高さ関数}
ここでは特に断らない限り,
$\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
また, $\Phi^+=\Phi_\Delta^+$とする.
\begin{definition}
  $\alpha=\sum_{\delta\in\Delta}c_\delta \delta$に対し,
  $\height(\alpha)=\sum_{\delta\in\Delta}c_\delta$と定義し,
  $\alpha$の高さと呼ぶ.
\end{definition}

しばらくの間,
$R_0=\Set{s_\alpha|\alpha\in\Delta}$,
$W_0=\Braket{R_0}_\ZZ$
とおく.
\begin{lemma}
  \label{lem:minimumhtissimple}
  $\beta\in\Phi^+$,
  $h=\min\Set{\height(\gamma)|\gamma\in W_0(\beta)\cap \Phi^+}$とする.
  $\gamma\in W_0(\beta)\cap \Phi^+$が$\height(\gamma)=h$をみたすなら,
  $\gamma\in\Delta$.
\end{lemma}
\begin{proof}
  $\gamma=\sum_{\delta\in\Delta}c_\delta\delta$とする.
  $c_\gamma\geq 0$である.
  \begin{align*}
    \Braket{\gamma,\gamma}
    &=\Braket{\gamma,\sum_{\delta\in\Delta}c_\delta\delta}\\
    &=\sum_{\delta\in\Delta}c_\delta\Braket{\gamma,\delta}
  \end{align*}
  となるが, $\Braket{\gamma,\gamma}>0$であるから,
  $\Braket{\gamma,\delta}>0$となる$\delta$が存在する.
  $\alpha\in\Delta$が$\Braket{\gamma,\alpha}>0$をみたすとする.

  $\gamma=\alpha$のときは$\gamma=\alpha\in\Delta$である.
  $\gamma\neq\alpha$のときについて考える.
  $s_\alpha(\gamma)$を調べる.
  $\gamma\in\Phi^+$だから,
  \cref{prop:simple:reflect:positive2positive}から
  $s_\alpha(\gamma)\in\Phi^+$がわかる.
  $\gamma\in W_0(\beta)$であるので, $w\in W_0$をつかって,
  $\gamma=w(\beta)$とかける.
  したがって,
  $s_\alpha(\gamma)=s_\alpha w(\gamma)$とかけるが,
  $s_\alpha w\in W_0$であるから,
  $s_\alpha(\gamma)\in W_0(\beta)\cap \Phi^+$である.
  一方,  
  $c=2\frac{\Braket{\gamma,\alpha}}{\Braket{\alpha,\alpha}}$とすると,
  $c>0$であり,
  $s_\alpha(\gamma)=\gamma-c\alpha$
  とかけるので,
  \begin{align*}
    \height(s_\alpha(\gamma))
    =\height(\gamma)-c < \height(\gamma)=h
  \end{align*}
  となる.
  これは$h$の最小性に矛盾する.
\end{proof}


\begin{lemma}
  \label{lem:simpleactstrnsitive}
  $W_0(\Delta)=\Phi$
\end{lemma}
\begin{proof}
  $W_0(\Delta)\subset \Phi$は, $\Phi$がルート系であるので明白である.

  $W_0(\Delta)\supset \Phi$について考える.
  $\beta\in \Phi$とする.

  $\beta\in\Phi^+$のときについて考える.
  $h=\min\Set{\height(\alpha)|\alpha\in W_0(\beta)\cap\Phi^+}$とし,
  $\gamma\in W_0(\beta)\cap\Phi^+$が$\height(\gamma)=h$をみたすとする.
  $\gamma=w(\beta)$, $w\in W_0$とする
  このとき, \cref{lem:minimumhtissimple}より, $\gamma\in\Delta$である.
  よって, $\gamma=w(\beta)\in\Delta$となる.
  したがって, $\beta=w^{-1}(\gamma)\in W_0(\Delta)$.

  $\beta\in\Phi^-$のときは, $-\beta\in\Phi^+$であるので,
  $-\beta=w(\gamma)$をみたす$w\in W_0$と$\gamma\in\Delta$がとれる.
  $s_\gamma(\gamma)=-\gamma$であるから,
  $ws_\gamma(\gamma)=-w(\gamma)=\beta$
  となり$\beta\in W_0(\Delta)$がわかる.
\end{proof}


\begin{theorem}
  $W(\Phi)=W_0$
\end{theorem}
\begin{proof}
  $W(\Phi)\supset W_0=\Braket{R_0}_\ZZ$は,
  $R_0\subset W(\Phi)$であることから,
  明白である.

  $W(\Phi)\subset W_0$について考える.
  $\beta\in\Phi$とする.
  このとき$s_\beta\in W$, $\beta\in\Phi$だから,
  \cref{lem:simpleactstrnsitive}から,
  $\beta=w(\alpha)$をみたす
  $w\in W_0$と$\delta\in\Delta$がとれる.
  したがって,
  \begin{align*}
    s_\beta=s_{w\delta}=ws_\delta w^{-1}
  \end{align*}
  となるが, $w$も$s_\delta$も$W_0$の元だから,
  $s_\beta\in W_0$である.
  したがって, $R(\Phi)\subset W_0$であるので,
  $W(\Phi)=\Braket{R(\Phi)}_\ZZ\subset W_0$である.
\end{proof}
