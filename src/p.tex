% !TeX root =./x2.tex
% !TeX program = pdfpLaTeX
\chapter{準備}
ここでは, 線形代数の基本的な事項について復習する.
この原稿を通して使う基本的な用語や記号を定義することが主な目的であり,
必要最低限の準備をするため, 証明などは他の文献に任せる.
\section{線型写像に関する用語など}
本稿では,
特に断らない限り,
$V$は$n$次元ユークリッド空間を表すとし,
内積は $\Braket{\bullet,\bullet}$で表し,
ノルムは$\|\bullet \|$で表すとする.
つまり,
\begin{align*}
  V&=\RR^n\\
  &=\Set{\begin{pmatrix}\alpha_1\\\vdots\\\alpha_n\end{pmatrix} | \alpha_i \in \RR}.
\end{align*}
とする, ただし, $\RR$は実数全体のなす集合とする.
また, 
\begin{align*}
  \alpha=\begin{pmatrix}\alpha_1\\\vdots\\\alpha_n\end{pmatrix},\quad
  \beta=\begin{pmatrix}\beta_1\\\vdots\\\beta_n\end{pmatrix}\in V
\end{align*}
に対し,
\begin{align*}
\Braket{\alpha,\beta}=\sum_{i=1}^n \alpha_i \beta_i
\end{align*}
とし,
\begin{align*}
  \|\alpha \|=\sqrt{\Braket{\alpha,\alpha}}
\end{align*}
とする.

$\zzero$は$V$の零ベクトルを表し,
$\Set{\ee_1,\ldots,\ee_n}$は$V$の標準基底であるとする.
つまり,
\begin{align*}
 \zzero&=\begin{pmatrix}0\\\vdots\\0\end{pmatrix},\\
 \ee_1&=\begin{pmatrix}1\\0\\\vdots\\0\end{pmatrix},
 \ee_2=\begin{pmatrix}0\\1\\\vdots\\0\end{pmatrix},
 \ldots,
 \ee_n=\begin{pmatrix}0\\\vdots\\0\\1\end{pmatrix}
\end{align*}
とする.

$\Phi\subset V$に対し,
\begin{align*}
\Braket{\Phi}_{\RR}=\Set{\sum_{i=1}^{m}a_{i}\alpha_i|m\in\ZZ,a_i\in \RR,\alpha_i\in \Phi}
\end{align*}
とおく.
$\Braket{\Phi}_{\RR}$は$V$の部分空間になる.
これを, 生成系$\Phi$で生成される$V$の部分空間と呼ぶ.

$V',V''$を$V$の部分空間とする.
\begin{align*}
  V'+V''=\Set{\alpha+\beta|
    \alpha\in V', \beta\in V''}
\end{align*}
とする. これは$V$の部分空間となる.
$V'\cap V''=\Set{\zzero}$かつ$V=V'+V''$
となるとき,
$V$は$V'$と$V''$の(内部)直和に分解されるといい,
$V=V'\oplus V''$とかく.

$V'\subset V$に対し,
\begin{align*}
  {V'}^\perp=\Set{\alpha\in V| \forall \beta\in V',\Braket{\alpha,\beta}=0}
\end{align*}
とする. これは$V$の部分空間になる.
これを$V'$の直交補空間と呼ぶ.
$V$の部分空間$V'$に対し,
$V=V'\oplus {V'}^\perp$である.

$O$ですべての成分が$0$である行列を表す.
これは零行列と呼ばれる.
$E_{i,j}$で$(i,j)$成分のみ$1$で他は$0$である行列を表す.
これを行列単位と呼ぶ.
行列単位の積は,
\begin{align*}
  E_{i,j}E_{k,l}=
  \begin{cases}
    E_{i,l} & j=k\\
    O & j\neq k
  \end{cases}
\end{align*}
で計算できる.
$\diag(a_1,\ldots,a_n)$で対角成分が
$a_1,\ldots,a_n$である$n$次正方行列を表す.
つまり,
\begin{align*}
\diag(a_1,\ldots,a_n)=\sum_{i=1}^{n}a_iE_{i,i}
\end{align*}
である.
$E_n=\diag(1,\ldots,1)=\sum_{i=1}^{n}E_{i,i}$
とおき, これを単位行列と呼ぶ.
正方行列$A$に対し,
\begin{align*}
  \det(A-tE_n)
\end{align*}
は$t$の多項式であるが,
これを$A$の固有多項式と呼ぶ.
$A\alpha=c \alpha$をみたす$c\in \RR$, $\alpha\in V\setminus\Set{\zzero}$
があったとき,
$\alpha$のことを
固有値$c$に属する固有ベクトルと呼ぶ.
固有値$c$に属する固有ベクトルを集めた集合と$\Set{\zzero}$の和集合は,
ベクトル空間になる.
これを固有値$c$に属する固有空間と呼ぶ.
相異なる固有値に属する固有ベクトルは一次独立である.
$A$の固有値は$\det(A-tE_n)=0$の根である.
$n$次正方行列$A$に対し,
$n$個の一次独立な固有ベクトルが取れることと,
$P^{-1}AP=\diag(a_1,\ldots,a_n)$
をみたす$a_i$と
正則行列$P$が取れることは同値である.

$\transposed{A}$で$A$の転置を表す.
$\transposed{A}=A$を満たすとき$A$を対称行列と呼ぶ.
$\transposed{A}=A^{-1}$を満たすとき$A$を直交行列と呼ぶ.
$A$が直交行列であることと,
$A$の列ベクトルが$V$の正規直交基底であることが同値である.
直交行列の固有値は$1$か$-1$である.
また,
相異なる固有値に属する固有ベクトルは直交する.


$V$と$V'$をそれぞれベクトル空間とする.
写像$f\colon V\to V'$が次の条件を満たすとき,
$f$は線形写像であるという:
\begin{align*}
  \alpha,\beta\in V &\implies f(\alpha+\beta)=f(\alpha)+f(\beta)\\
  \alpha\in V,c\in \RR &\implies f(c\alpha)=cf(\alpha)  .
\end{align*}
線形写像$f$, $g$の合成$f\circ g$も線形写像である.
$f\circ g$を$fg$と書くことにする.
線形写像$f\colon V\to V$
を$V$上の線形変換と呼ぶこともある.
線形写像$f$が,
$\Braket{\alpha,\beta}=\Braket{f(\alpha),f(\beta)}$
を満たすとき,
$f$は内積を保つという.
内積を保つ線形変換$f$を直交変換と呼ぶこともある.


$V$を$n$次元ベクトル空間, $W$を$m$次元ベクトル空間とする.
$(m,n)$-行列$A$が与えられたとする.
このとき, $\alpha\in V$に対し, $f_A(\alpha)=A\alpha$と定義すると
$f_A(\alpha)\in W$である.
$f_A$は$V$から$W$への線形写像になる.
逆に,
$V$から$W$への線形写像$f$が与えられたとする,
このとき, $f(\ee_1),\ldots, f(\ee_n)$は$m$項数ベクトルである.
これらを並べることで, $(m,n)$行列が得られるのでこれを$A_f$とかく.
これは, $A$の(標準基底に関する)表現行列とよばれる.
先程と同様$f_{A_f}(\alpha)=A_f\alpha$と定義すると,
$f_{A_f}=f$となる.
この意味で, 行列を与えることと線形写像を与えることは同じである.
$E_n$は恒等写像, $O_{m,n}$はすべての元を$\zzero$に対応させる定値写像
に対応する.
$V$上の線形変換$f$に対し,
$\det(f)=\det(A_f)$とし, 線形写像$f$の行列式と呼ぶことにする.
線形変換でも, 行列と同様に, 
固有値, 固有ベクトル, 固有空間, 固有多項式といった概念が定義できる.

$\RR_{>0}=\Set{a\in\RR|a>0}$とおく.
また
$X$の元$x$に渡って$f(x)$の和をとるときには
$\sum_{x\in X}f(x)$という表記を用いる.
この記法は, $X$が有限集合であるか, $f(x)$が高々有限個の$x$を除き$0$であるときに意味を持つ.



\section{群について}
ここでは, $[n]=\Set{1,2,\ldots,n}$とする.
\begin{align*}
  S_n=\Set{\sigma\colon [n] \to [n] | \text{$\sigma$は全単射}}    
\end{align*}
とおき, $n$次対称群と呼ぶ.
$S_n$の元を$[n]$上の置換とか順列と呼ぶ.
$\sigma,\tau\in S_n$に対し,
合成写像$\sigma\circ \tau$を
$\sigma\tau$と書くことにする.
$\sigma\tau$も$S_n$の元である.
また,
$\sigma,\tau,\nu\in S_n$に対し,
$(\sigma\tau)\nu=\sigma(\tau\nu)$が成り立つ.
$[n]$上の恒等写像を$\varepsilon$とここでは書くことにする.
$\varepsilon \in S_n$である.
また, 任意の$\sigma\in S_n$に対し,
$\sigma\varepsilon=\varepsilon\sigma=\sigma$
が成り立つ.
$\sigma\in S_n$に対し, $\sigma$の逆写像$\sigma^{-1}$も$S_n$の元である.
$\sigma^{-1}\sigma=\sigma\sigma^{-1}=\varepsilon$
が成り立つ.
これらの構造を抽象化したものが群である.
\begin{definition}
  $G$を集合とする.
  $\bullet\cdot\bullet$を$G$上の二項演算とする.
  つまり, $g,h\in G$に対し, $g\cdot h \in G$が定まっているとする.
  $e\in G$とする.
  $\bullet^{-1}$を$G$上の単項演算とする.
  つまり, $g\in G$に対し, $g^{-1}\in G$が定まっているとする.
  次の条件を満たすとき,
  $(G,\bullet\cdot\bullet,e,\bullet^{-1})$を群と呼ぶ:
  \begin{enumerate}
    \item $g,h,k\in G\implies g\cdot(h\cdot k)=(g\cdot h)\cdot k$.
    \item $g \in G\implies g\cdot e=e\cdot g = g$.
    \item $g \in G\implies g^{-1}\cdot g=g\cdot g^{-1} = e$.
  \end{enumerate}
  $e$を$G$の単位元と呼ぶ. $g\in G$に対し, $g^{-1}$を$g$の逆元と呼ぶ.
  $(G,\bullet\cdot\bullet,e,\bullet^{-1})$が群であることを,
  単に$G$が群であるということもある.
\end{definition}
\begin{definition}
  群$(G,\bullet\cdot\bullet,e,\bullet^{-1})$が次の条件を満たすとき,
  $(G,\bullet\cdot\bullet,e,\bullet^{-1})$は可換群であるという:
  \begin{align*}
    g,h\in G\implies g\cdot h=h\cdot g. 
  \end{align*}
\end{definition}
\begin{definition}
  $G$が有限集合であるとき,
  群$(G,\bullet\cdot\bullet,e,\bullet^{-1})$は有限群であるという.
  $G$が有限群であるとき,
  $|G|$で$G$に含まれる元の総数を表す.
  $G$が有限群でないとき,
  $|G|=\infty$と書く.
  $|G|$のことを$G$の位数と呼ぶ.
\end{definition}
\begin{example}
  $S_n$は群である.
  位数$|S_n|$は$n!$であるから,
  有限群である.
\end{example}
\begin{example}
\begin{align*}
  \ZZ^{\times}=\Set{1,-1}
\end{align*}
とおく. このとき, $\ZZ^{\times}$は通常の掛け算で群となる.
$\ZZ^{\times}$の単位元は$1$である.
$a\in \ZZ^{\times}$の逆元は$\frac{1}{a}=a$である.
\end{example}
\begin{example}
\begin{align*}
  (\ZZ^{\times})^{n}=\Set{(a_1,\ldots, a_n)|a_n\in \ZZ^{\times}}
\end{align*}
とおく. $(a_1,\ldots, a_n)(b_1,\ldots, b_n)=(a_1b_1,\ldots, a_nb_n)$と定めると,
$(\ZZ^{\times})^{n}$は群である.
$(1,\ldots, 1)$が$(\ZZ^{\times})^{n}$の単位元.
$a\in \ZZ^{\times}$の逆元は$a$自身である.
\end{example}
\begin{example}
  $n$を正の整数とし,
  $G$を$n$次正則行列を集めた集合とする.
  このとき, $G$は行列の積で群となる.
  $E_n$が$G$の単位元.
  $A\in G$の逆元は逆行列$A^{-1}$である.
  $G$は無限群である.
\end{example}
\begin{example}
  $V$を$n$次元ベクトル空間とする.
  $G$を$V$から$V$への線形写像で全単射であるものを集めた集合とする.
  このとき, $G$は写像の合成で群となる.
  $\id_V$が$G$の単位元.
  $f\in G$の逆元は逆写像$f^{-1}$である.
  $G$は無限群である.
\end{example}

\begin{definition}
  $(G_1,\bullet\cdot\bullet,e_1,(\bullet)^{-1})$,
  $(G_2,\bullet\circ\bullet,e_2,[\bullet]^{-1})$
  が群であるとする.
  次の条件を満たすとき,
  $f$は
  $(G_1,\bullet\cdot\bullet,e_1,(\bullet)^{-1})$から
  $(G_2,\bullet\circ\bullet,e_2,[\bullet]^{-1})$
  への群準同型写像であるという:
  \begin{enumerate}
  \item $f$は$G_1$から$G_2$への写像.
  \item $g,h\in G_1\implies f(g\cdot h)=f(g)\circ f(h)$.
  \end{enumerate}
  $f$が全単射であるとき\footnote{}
  $f$を群同型写像と呼び,
  $(G_1,\bullet\cdot\bullet,e_1,(\bullet)^{-1})$と
  $(G_2,\bullet\circ\bullet,e_2,[\bullet]^{-1})$
  は群として同型であるという.
\end{definition}


\begin{definition}
  $(G,\bullet\cdot\bullet,e,\bullet^{-1})$を群とする.
  $\emptyset \neq S\subset G$に対し,
  \begin{align*}
    \Braket{S}_{\ZZ}=\Set{g_1^{i_1}\cdots g_n^{i_n}|n=1,\ldots;i_j\in \ZZ;g_i\in S}
  \end{align*}
  とする.
  ただし,
  $g\in G$と$k>0$に対し, $g^{k}=\underbrace{g\cdots g}_{k}$,
  $g^{-k}=(g^{-1})^{k}$, $g^0=e$とする.
  $\Braket{\emptyset}_{\ZZ}=\Set{e}$と約束する.
  $\Braket{S}_{\ZZ}$を$S$で生成される$G$の部分群と呼び,
  $S$を$\Braket{S}_{\ZZ}$の生成系であると呼ぶ.
\end{definition}
群$(G,\bullet\cdot\bullet,e,\bullet^{-1})$,
$S\subset G$に対し,
$(\Braket{S}_{\ZZ},\bullet\cdot\bullet,e,\bullet^{-1})$は群である.
$S\subset S' \subset G$なら,
$\Braket{S}_\ZZ\subset\Braket{S'}_\ZZ$
である.
さらに,
$S\subset S' \subset \Braket{S}_\ZZ$なら
$\Braket{S}_\ZZ=\Braket{S'}_\ZZ$
である.

\begin{example}
$(\ZZ^\times)^n$の部分集合$S$を
\begin{align*}
  S=\Set{(-1,1\ldots,1),(1,-1,\ldots,1),(1,1,\ldots,-1)}
\end{align*}
とおくと, $S$は
$(\ZZ^\times)^n$の生成系である.
\end{example}

\begin{example}
$\tau_{i,j}\in S_n$
を
\begin{align*}
  \tau_{i,j}(k)=
  \begin{cases}
    j&(i=k)\\
    i&(j=k)\\
    k&(k\in\Set{i,j})
  \end{cases}
\end{align*}
で定義する.
$\tau_{i,j}$は$i$と$j$を入れ替える互換と呼ばれる.
$T=\Set{\tau_{i,j}|1\leq i<j\leq n}$とすると,
$T$は$S_n$の生成系である.
$i$と$i+1$を入れ替える互換は隣接互換と呼ばれる.
\begin{align*}
  \tau_{i,i+2}
  &=\tau_{i+1,i+2}\tau_{i,i+1}(\tau_{i+1,i+2})^{-1}\\
  &=\tau_{i+1,i+2}\tau_{i,i+1}(\tau_{i+1,i+2})\\
  \tau_{i,i+3}
  &=\tau_{i+2,i+3}\tau_{i,i+2}(\tau_{i+2,i+3})^{-1}\\
  &=\tau_{i+2,i+3}\tau_{i,i+2}(\tau_{i+2,i+3})\\
  \tau_{i,i+4}
  &=\tau_{i+3,i+4}\tau_{i,i+3}(\tau_{i+3,i+4})^{-1}\\
  &=\tau_{i+3,i+4}\tau_{i,i+3}(\tau_{i+3,i+4})\\
  &\vdots\\
  \tau_{i,i+k}
  &=\tau_{i+k-1,i+k}\tau_{i,i+k-1}(\tau_{i+k-1,i+k})^{-1}\\
  &=\tau_{i+k-1,i+k}\tau_{i,i+k-1}(\tau_{i+k-1,i+k})
\end{align*}
となるので,
$\tau_{i,i+k}$は隣接互換の積でかける.
したがって,
隣接互換を集めた集合$S$も$S_n$の生成系である.
\end{example}



\sectionX{章末問題}
\begin{enumerate}
  \item
  $\theta$を実数とする.
  $P$, $\alpha$, $\beta$を次で定義する.
  \begin{align*}
    P&=
    \begin{pmatrix}
      \cos(2\theta) & \sin(2\theta) \\
      \sin(2\theta) & -\cos(2\theta) 
    \end{pmatrix},&
    \alpha
    &=
    \begin{pmatrix}
      \sin(\theta) \\
      \cos(\theta) 
    \end{pmatrix},&
    \beta
    &=
    \begin{pmatrix}
      \cos(\theta)\\
      -\sin(\theta) 
    \end{pmatrix}.
  \end{align*}
  \begin{enumerate}
  \item $P$が直交行列であることを示せ.
  \item $\alpha$は$P$の固有ベクトルであることを示せ.
  \item $\beta$は$P$の固有ベクトルであることを示せ.
  \end{enumerate}
\item
  $S_1$, $S_2$を次で定義する.
  \begin{align*}
    S_1&=
    \begin{pmatrix}
      0&1&0\\
      1&0&0\\
      0&0&1
    \end{pmatrix},&
    S_2&=
    \begin{pmatrix}
      1&0&0\\
      0&0&1\\
      0&1&0
    \end{pmatrix}.
  \end{align*}
  \begin{enumerate}
  \item $S_1$, $S_2$が直交行列であることを示せ.
  \item $\ee_1-\ee_2$は$S_1$の固有ベクトルであることを示せ.
  \item $S_1$, $S_2$の固有値および固有空間を求めよ.
  \end{enumerate}
\item
  $0<\theta<\pi$とする.
  $R$を次で定義する.
  \begin{align*}
    R&=
    \begin{pmatrix}
      \cos(2\theta) & -\sin(2\theta) \\
      \sin(2\theta) & \cos(2\theta) 
    \end{pmatrix}.
  \end{align*}
  \begin{enumerate}
  \item $R$が直交行列であることを示せ.
  \item $R$は実数の固有値を持たないことを示せ.
  \end{enumerate}
\end{enumerate}


\chapter{鏡映}

ここでは,
鏡映と呼ばれる線形変換の定義と例を与えることを目標とする.
また,
固有値などに関する基本的な性質についても紹介する.

\section{鏡映の定義と例}


$\alpha \in V\setminus\Set{\zzero}$に対し,
\begin{align*}
  H_\alpha = \Set{\beta \in V | \Braket{\alpha,\beta}=0}
\end{align*}
とおき, $\alpha$を法ベクトルとする(中心的な)超平面と呼ぶ.
また,
\begin{align*}
  \RR\alpha = \Set{c \alpha | c\in \RR}
\end{align*}
とおく. $\RR\alpha$は原点を通り$\alpha$を方向ベクトルとする直線である.
このとき, $V$は,
\begin{align*}
  V =   H_\alpha \oplus   \RR\alpha
\end{align*}
と(内部)直和に分解される.
つまり, 次の2つを満たす:
\begin{align*}
  &V = \Set{ \beta + \gamma | \beta \in H_\alpha, \gamma \in \RR\alpha},\\
  &H_\alpha \cap   \RR\alpha =\Set{\zzero}.
\end{align*}

\begin{definition}
  $\alpha \in V\setminus\Set{\zzero}$とし,
  $f\colon V\to V$は線型写像であるとする.
  次の2つの条件を満たすとき,
  $f$が$\alpha$に関する鏡映であるという:
  \begin{enumerate}
  \item $f(\alpha)=-\alpha$.
  \item $\beta \in H_\alpha \implies f(\beta)=\beta$.    
  \end{enumerate}
  $f$が$\alpha$に関する鏡映であるような$\alpha\in V\setminus\Set{\zzero}$が存在するとき,
  $f$は鏡映であるという.
\end{definition}
$n$次正方行列は,
$\alpha\in V$に対し,
$A\alpha\in V$を対応させる$V$から$V$への線型写像であると思うことができる.
対応する線型写像が鏡映であるとき, その行列も鏡映と呼ぶことにする.
行列の言葉に定義を書き直すと以下のようになる.
\begin{definition}
  $\alpha \in V\setminus\Set{\zzero}$とし,
  $A$は$n$次正方行列であるとする.
  次の2つの条件を満たすとき,
  $A$が$\alpha$に関する鏡映であるという:
  \begin{enumerate}
  \item $A\alpha=-\alpha$.
  \item $\beta \in H_\alpha \implies A\beta=\beta$.    
  \end{enumerate}
\end{definition}

\begin{example}
  \begin{align*}
    P=
    \begin{pmatrix}
      1 & 0 \\
      0 & -1 
    \end{pmatrix}.
  \end{align*}
  とし,
  $\alpha=\ee_2$とおくと,
  $P$は$\alpha$に関する鏡映である.
実際, 
\begin{align*}
  P\alpha = 
      \begin{pmatrix}
      1 & 0 \\
      0 & -1 
      \end{pmatrix}
      \alpha
    =
      \begin{pmatrix}
      1 & 0 \\
      0 & -1 
    \end{pmatrix}
    \begin{pmatrix}
      0  \\
      1  
    \end{pmatrix}
    =
    \begin{pmatrix}
      0  \\
      -1  
    \end{pmatrix}
    =
    -
    \begin{pmatrix}
      0  \\
      1  
    \end{pmatrix}
    =
    -\alpha
\end{align*}
である.  また,
\begin{align*}
  H_\alpha = \Set{c \ee_1 | c\in \RR}
\end{align*}
であるが,
\begin{align*}
    \begin{pmatrix}
      1 & 0 \\
      0 & -1 
    \end{pmatrix}
    \begin{pmatrix}
      c  \\
      0  
    \end{pmatrix}
    =
    \begin{pmatrix}
      c  \\
      0  
    \end{pmatrix}
\end{align*}
である.
\end{example}

\begin{example}
  \label{ex:i2m:ref}
  $P$は鏡映であった.
  もっと一般に,
  実数$\theta$に対し,
\begin{align*}
  P(2\theta)&=
  \begin{pmatrix}
    \cos(2\theta) & \sin(2\theta) \\
    \sin(2\theta) & -\cos(2\theta) 
  \end{pmatrix},\\
  \alpha(\theta)
  &=
  \begin{pmatrix}
    \sin(-\theta) \\
    \cos(-\theta) 
  \end{pmatrix}
\end{align*}
とおけば, $P(2\theta)$は$\alpha(\theta)$に関する鏡映である.
実際,
\begin{align*}
  H_{\alpha(\theta)} = \Set{c \alpha(\theta+\frac{\pi}{2})|c\in \RR} 
\end{align*}
であるので,
\begin{align*}
  P(2\theta)\alpha(\theta) &= - \alpha(\theta),\\
  P(2\theta)(c\alpha(\theta+\frac{\pi}{2})) &= c\alpha(\theta+\frac{\pi}{2})
\end{align*}
を示せばよいが, これらは直接, 計算することで確かめることができる.
\end{example}


\begin{example}
  \label{ex:a1n:refl}
  $P$は鏡映であった.
  もっと一般に,
  $F_k$を$(k,k)$成分は$-1$, 他の対角成分は$1$であるような$n$次対角行列とする.
 $E_{k,l}$で$(k,l)$行列単位, つまり, $(k,l)$成分のみ1で他は0であるような行列とすると,
  \begin{align*}
    F_k = \diag(1,\ldots,1,-1,1,\ldots,1)=E_n-2E_{k,k}
  \end{align*}
  である.
  $\alpha=\ee_k$とすると, $F_k$は$\alpha$ に関する鏡映である.
  $F_k \alpha = -\alpha$となることは, 直接計算すればわかる.
  また, $\beta\in V$に対し,
  \begin{align*}
    \Braket{\alpha,\beta}= \beta_k 
  \end{align*}
  であるので,
  \begin{align*}
    H_\alpha = \Set{
      \beta=
      \begin{pmatrix}
        \beta_1\\
        \vdots\\
        \beta_n
      \end{pmatrix}
      | \beta_k=0}
  \end{align*}
  である.  $\beta\in H_\alpha$に対し, 
  $F_k \beta = -\beta$となることは, 直接計算すればわかる.
\end{example}

\begin{example}
  $T_{k,l}$を$(k,k)$成分と$(l,l)$成分は$0$, 他の対角成分は$1$,
$(k,l)$成分と$(l,k)$成分は$1$, 他の成分は$0$
  であるような$n$次正方行列とする.
  つまり,
  \begin{align*}
    T_{k,l} =E_n-E_{k,k}-E_{l,l}+E_{l,k}+E_{k,l}
  \end{align*}
  である.
  $\alpha=\ee_k-\ee_l$とすると, $T_{k,l}$は$\alpha$ に関する鏡映である.
  実際,
  \begin{align*}
    T_{k,l} \alpha = T_{k,l}(e_k-e_l) = T_{k,l}e_k-T_{k,l}e_l = e_l - e_k = -(e_k - e_l) = -\alpha 
  \end{align*}
  である.  
  また, $\beta\in V$に対し,
  \begin{align*}
    \Braket{\alpha,\beta}= \beta_k - \beta_l
  \end{align*}
  であるので,
  \begin{align*}
    H_\alpha = \Set{
      \beta=
      \begin{pmatrix}
        \beta_1\\
        \vdots\\
        \beta_n
      \end{pmatrix}
      | \beta_k=\beta_l}
  \end{align*}
  である.
  $\beta\in H_\alpha$に対し, 
  $F_k \beta = -\beta$となることは, 直接計算すればわかる.
\end{example}



\begin{example}
  $k\neq l$に対し,
  $F_{k,l}=F_kF_lT_{k,l}$とおく.
  つまり$F_{k,l}$は$(k,k)$成分と$(l,l)$成分は$0$, 他の対角成分は$1$,
  $(k,l)$成分と$(l,k)$成分は$-1$, 他の成分は$0$であるような$n$次正方行列であり,
  \begin{align*}
    F_{k,l} = E_n-E_{k,k}-E_{l,l}-E_{k,l}-E_{l,k}
  \end{align*}
  である.
  $\alpha=\ee_k+\ee_l$とすると, $F_{k,l}$は$\alpha$ に関する鏡映である.
  実際,
  \begin{align*}
    F_{k,l} \alpha &= F_kF_lT_{k,l}(\ee_k+\ee_l)\\
    &= F_kF_l(\ee_k+\ee_l)\\
    &= F_kF_l\ee_k+F_kF_l\ee_l\\
    &= F_k\ee_k-F_k\ee_l\\
    &= -\ee_k-\ee_l\\
    &= -(\ee_k+\ee_l)\\
    &= -\alpha
  \end{align*}
  となる.
  また, $\beta\in V$に対し,
  \begin{align*}
    \Braket{\alpha,\beta}= -\beta_k-\beta_l 
  \end{align*}
  であるので,
  \begin{align*}
    H_\alpha = \Set{
      \beta=
      \begin{pmatrix}
        \beta_1\\
        \vdots\\
        \beta_n
      \end{pmatrix}
      | \beta_k=-\beta_l}
  \end{align*}
  である.  $\beta\in H_\alpha$に対し, 
  $F_k \beta = -\beta$となることは, 直接計算すればわかる.
\end{example}

\begin{example}
  $\alpha\in V\setminus\Set{\zzero}$とする.
  $\beta\in V$に対して,
  \begin{align*}
    s_\alpha (\beta) = \beta - 2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}\alpha
  \end{align*}
  と定義する. $s_\alpha$は$V$から$V$への線型写像である.
  また, $s_\alpha$は$\alpha$に関する鏡映である.
  実際
  \begin{align*}
    s_\alpha (\alpha) = \alpha - 2\frac{\Braket{\alpha,\alpha}}{\Braket{\alpha,\alpha}}\alpha
      = \alpha - 2\alpha=-\alpha
  \end{align*}
であり, $\beta\in H_\alpha$に対しては,  
  \begin{align*}
    s_\alpha (\beta) = \beta - 2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}\alpha
    = \beta - 0\alpha =\beta
  \end{align*}
  となる,
\end{example}

\section{鏡映の性質}
ここでは, $V$から$V$への線型写像で鏡映であるものの性質について考える.
\begin{lemma}
  \label{lemma:reflisunique}
  $s$も$s'$も$\alpha$に関する鏡映であるとする.
  このとき, $s=s'$.
\end{lemma}
\begin{proof}
  $V =   H_\alpha +  \RR\alpha$
  であるので,
  $s(\alpha)=s'(\alpha)$と,
  $\beta\in H_\alpha$に対して
  $s(\beta)=s'(\beta)$を示せば十分である.
  これらは,
  $\alpha$に関する鏡映の定義から直接わかる.
\end{proof}
\Cref{lemma:reflisunique}を使うと次がすぐわかる.
\begin{prop}
  $s$を$V$上の線形変換であるとする.
  $s$が$\alpha$に関する鏡映であるとき, $s=s_\alpha$.
\end{prop}

\begin{prop}
  $\alpha, \alpha' \in V\setminus\Set{\zzero}$とする.
  このとき, 次は同値:
  \begin{enumerate}
  \item
    \label{prop:222:item:1}
    $s_\alpha=s_{\alpha'}$.
  \item
    \label{prop:222:item:2}
    $\alpha=c\alpha'$となる$c\in \RR$が存在する.
  \end{enumerate}
\end{prop}
\begin{proof}
  \paragraph{ $\ref{prop:222:item:1}\implies\ref{prop:222:item:2}$:}
  $s_\alpha=s_{\alpha'}$とする.
  このとき,
  \begin{align*}
    s_\alpha(\alpha) &=-\alpha,\\
    s_{\alpha'} (\alpha) &= \alpha - 2\frac{\Braket{\alpha',\alpha}}{\Braket{\alpha',\alpha'}}\alpha'
  \end{align*}
  であるので,
  \begin{align*}
    -\alpha &= \alpha - 2\frac{\Braket{\alpha',\alpha}}{\Braket{\alpha',\alpha'}}\alpha'\\
    \alpha &= \frac{\Braket{\alpha',\alpha}}{\Braket{\alpha',\alpha'}}\alpha'
  \end{align*}
  となる.

  \paragraph{ $\ref{prop:222:item:2}\implies\ref{prop:222:item:1}$:}
  $\alpha=c\alpha'$とする.
  $\alpha\neq \zzero$
  であるので, $c\neq 0$である.
  したがって, $\alpha'=\frac{1}{c}\alpha$である.
  このとき,
  \begin{align*}
    s_{\alpha}(\alpha')=s_{\alpha}(\frac{1}{c}\alpha)=\frac{1}{c}s_{\alpha}(\alpha)=-\frac{1}{c}\alpha=-\alpha'
  \end{align*}
  である.
  $\beta \in H_{\alpha'}$とすると,
  \begin{align*}
    \Braket{\alpha,\beta}=\Braket{c\alpha',\beta}=c\Braket{\alpha',\beta}=0
  \end{align*}
  であるので, $\beta \in H_\alpha$である.
  したがって,
  $s_\alpha(\beta)=\beta$である.
  よって, $s_\alpha$は$\alpha'$に関する鏡映である.
  \Cref{lemma:reflisunique}
  より, $s_\alpha=s_{\alpha'}$である.
\end{proof}


\begin{prop}
  $s$を鏡映とする.
  このとき, $s^2=\id_V$.
\end{prop}
\begin{proof}
  $s$を$\alpha$に関する鏡映とする.
  $s^2(\alpha)=s(-\alpha)=-s(\alpha)=-(-\alpha)=\alpha$
  である.
  また, $\beta\in V$に対して,
  $s^2(\beta)=s(\beta)=\beta$である.
  よって,
  $s$は$V$上の恒等写像である.
\end{proof}

\begin{cor}
  $s$を鏡映とする.
  このとき, $s=s^{-1}$.
\end{cor}


\begin{prop}
  \label{prop:reflisortho}
  $s$を鏡映とする.
  このとき, $s$は内積を保存する.
  つまり, $\lambda,\mu\in V$に対して, $\Braket{s(\lambda),s(\mu)}=\Braket{\lambda,\mu}$である.
\end{prop}
\begin{proof}
  $s$を$\alpha$に関する鏡映とする.
  $\lambda,\mu\in V$とすると,
  $V=H_\alpha+\RR\alpha$であるので,
  \begin{align*}
    \lambda &= \beta_\lambda + a_\lambda \alpha, 
    &\mu &= \beta_\mu + a_\mu \alpha 
  \end{align*}
  をみたす$\beta_\lambda, \beta_\mu \in H_\alpha$と$a_\lambda,a_\mu \in \RR$が存在する.
  \begin{align*}
    \Braket{s(\lambda),s(\mu)}&=
    \Braket{s(\beta_\lambda + a_\lambda \alpha), s(\beta_\mu + a_\mu \alpha) }\\
    &=
    \Braket{\beta_\lambda - a_\lambda \alpha, \beta_\mu - a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{\beta_\lambda ,  - a_\mu \alpha }
    +\Braket{ - a_\lambda \alpha, \beta_\mu }
    +\Braket{ - a_\lambda \alpha, - a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +0
    +0
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }\\
    \Braket{\lambda,\mu}&=
    \Braket{\beta_\lambda + a_\lambda \alpha, \beta_\mu + a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{\beta_\lambda ,  a_\mu \alpha }
    +\Braket{a_\lambda \alpha, \beta_\mu }
    +\Braket{a_\lambda \alpha, a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +0
    +0
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }\\
    &=
    \Braket{\beta_\lambda , \beta_\mu  }
    +\Braket{ a_\lambda \alpha, a_\mu \alpha }
  \end{align*}
  がなりたつ. 
\end{proof}

\begin{prop}
  \label{prop:conjbyortho}
  $t$は内積を保つ線型写像であるとする.
  $\alpha\in V\setminus\Set{\zzero}$に対し,
  $ts_\alpha t^{-1}=s_{t(\alpha)}$.
\end{prop}
\begin{proof}
\Cref{lemma:reflisunique}より,
  $ts_\alpha t^{-1}$が$t(\alpha)$に関する鏡映であることを示せば十分である.
\begin{align*}
  ts_\alpha t^{-1}(t(\alpha))=ts_\alpha(\alpha)=t(-\alpha)=-t(\alpha)
\end{align*}
である. また$\beta\in H_{t(\alpha)}$に対して,
\begin{align*}
\Braket{\alpha,t^{-1}(\beta)}
=\Braket{t(\alpha),\beta}
=0
\end{align*}
であるので, $t^{-1}(\beta)\in H_\alpha$である.
したがって,
\begin{align*}
  ts_\alpha t^{-1}(\beta)=ts_\alpha(t^{-1}(\beta))=t(t^{-1}(\beta))=\beta.
\end{align*}
\end{proof}

\begin{prop}
  \label{lem:subsp:refl}
  $U\subset V$を部分空間とし,
  $\alpha \in U \setminus \Set{\zzero}$とする.
  このとき,
  $\beta\in U$に対し, $s_\alpha(\beta)\in U$であり,
  $\beta\in U^\perp$に対し, $s_\alpha(\beta)=\beta$である.
  特に,
  $s\colon U \to U$を$s(\beta)=s_\alpha(\beta)$で定めると,
  $s$は$\alpha$に関する$U$上の鏡映変換である.
\end{prop}
\begin{proof}
  $\alpha\in U$であるので,
  $\beta\in U^\perp$に対し,
  $\Braket{\alpha,\beta}=0$である.
  したがって, $s_\alpha(\beta)=\beta$である.

  $s_\alpha(\alpha)=-\alpha\in U$である.
  また
  $\beta \in H_\alpha\cap U$に対して,
  $s_{\alpha}(\beta')=\beta'\in U$
  である.
  $\beta\in U$に対し,
  $\beta=c\alpha + \beta'$をみたす,
  $c$と$\beta'\in H_\alpha$が存在するので,
  $s_{\alpha}(\beta)=s_{\alpha}(c\alpha+\beta')=cs_{\alpha}(\alpha)+s_{\alpha}(\beta')\in U$である.
\end{proof}


\begin{prop}
  直交変換$s$に対し以下は同値:
  \begin{enumerate}
  \item
    \label{prop:229:item:1}
    $s$は鏡映である.
  \item
    \label{prop:229:item:2}
    固有値$-1$に属する固有空間の次元は$1$次元である.
  \end{enumerate}
\end{prop}
\begin{proof}
  \paragraph{ $\ref{prop:229:item:1}\implies\ref{prop:229:item:2}$:}
  $s$が$\alpha$に関する鏡映であるとする.
  このとき, 定義から,
  固有値$-1$に属する固有空間は$\RR\alpha$であり,
  固有値$1$に属する固有空間は$H_\alpha$である.
  よって固有値$-1$に属する固有空間の次元は$1$次元である.

  \paragraph{ $\ref{prop:229:item:2}\implies\ref{prop:229:item:1}$:}
  固有値$-1$に属する固有空間の次元は$1$次元であるとする.
  このとき, 固有値$-1$に属する固有空間は$\RR\alpha$とかける.
  直交変換の固有値は, $1$か$-1$であり, 固有空間は互いに直交するので,
  固有値$1$に属する固有空間は$H_\alpha$である.
  固有値の定義から,
  $s(\alpha)=\alpha$と
  $\beta\in H_\alpha$に対して$s(\beta)=\beta$である.
  したがって,
  $s$は$\alpha$に関する鏡映である.
\end{proof}

鏡映変換に関する性質を, 行列の言葉に書き直しておく.
\begin{cor}
  $A$は$n$次正方行列とし, 鏡映であるとする.
  このとき,
  次が成り立つ:
  \begin{enumerate}
  \item $A^2=E_n$.
  \item $\transposed{A}A=E_n$.
  \item $A=A^{-1}=\transposed{A}$.
  \item $\det(tE_n-A)=(t+1)(t-1)^{n-1}$.
  \item $\det(A)=-1$.
  \item $\exists P \text{ such that } P^{-1}AP=\diag(1,\ldots,1,-1)$.
  \end{enumerate}
\end{cor}



\begin{example}
  $E_n$は鏡映ではない.
  $\alpha\in V$に対し,
  \begin{align*}
    E_n\alpha=-\alpha
  \end{align*}
  とすると,
  \begin{align*}
    \alpha=\zzero
  \end{align*}
  となり, $V\setminus\Set{\zzero}$の元では,
  $E_n\alpha=-\alpha$を満たすことがないので,
  $E_n$は鏡映ではない.
\end{example}

\begin{example}
 \label{ex:i2m:rot}
 実数$\theta$に対し,
  \begin{align*}
    R_\theta=
    \begin{pmatrix}
      \cos(\theta) & -\sin(\theta) \\
      \sin(\theta) & \cos(\theta)
    \end{pmatrix}.
  \end{align*}
 とおくと, これは鏡映ではない.
 \begin{align*}
    R_\theta \alpha = -\alpha
 \end{align*}
 とする. このとき,
 \begin{align*}
    (R_\theta + E_2)\alpha = \zzero
 \end{align*}
 である.
 \begin{align*}
   \det(R_\theta + E_2) &= 
    \det \begin{pmatrix}
      \cos(\theta) +1 & -\sin(\theta) \\
      \sin(\theta) & \cos(\theta) +1 
    \end{pmatrix}\\
    &=(\cos(\theta) +1)^2 + (\sin(\theta))^2\\
    &=2(1+\cos(\theta))
 \end{align*}
 である.
 したがって, $\cos(\theta)\neq 0$のときには,
 $R_\theta + E_2$は正則であるから, $\alpha=\zzero$のみが解となり,
 この場合は鏡映ではないことがわかる.
 また,  $\cos(\theta)= 0$のときには, $R_\theta=E_2$であり,
 この場合も鏡映ではない.
\end{example}

\begin{example}
  $\sigma \in S_n$に対し,
  $(\sigma(1),1)$成分,\ldots
  $(\sigma(n),n)$成分
  は$1$で. 他の成分は$0$であるような$n$次正方行列を$A_\sigma$とおく.
  つまり,
  \begin{align*}
    A_\sigma = \sum_{j=1}^{n} E_{\sigma(j),j} = \sum_{i=1}^{n} E_{i,\sigma^{-1}(i)}
  \end{align*}
  である.
  $\sigma,\sigma'\in S_n$に対し, $A_\sigma=A_{\sigma'}$であることと,
  $\sigma=\sigma'$であることは同値である.
  直接計算することで,
  $A_\sigma \ee_k=\ee_{\sigma(k)}$であることがわかる.
  また,
  $\sigma,\tau\in S_n$に対し,
  $A_\sigma A_\tau = A_{\sigma\tau}$.
  $\sigma\in S_n$に対し次は同値である:
  \begin{enumerate}
  \item $\sigma$が互換である.
  \item $A_\sigma$が鏡映である.
  \end{enumerate}
  $T_{i,j}$が互換であることは示した.
  逆を示す.
  $\sigma$が互換ではないとする.
  $\sigma=\varepsilon$のとき, $A_\sigma=E_n$であるので, これは鏡映ではない.
  $\sigma\neq\varepsilon$とする.
  このとき$\sigma(i_1)\neq i_1$を満たす$i_1$が存在する.
  $\sigma(i_1)=i_2$とおき,
  $\alpha=\ee_{i_1}-\ee_{i_2}$とする.
  このとき,
  \begin{align*}
    A_\sigma A_\sigma\alpha
    &= A_\sigma A_\sigma (\ee_{i_1}-\ee_{i_2})\\
    &= A_\sigma(\ee_{\sigma(i_1)}-\ee_{\sigma(i_2)})\\
    &= \ee_{\sigma\sigma(i_1)}-\ee_{\sigma\sigma(i_2)}
  \end{align*}
  である. 鏡映は二乗すると単位行列となるので,
  $\ee_{\sigma\sigma(i_1)}-\ee_{\sigma\sigma(i_1)}\neq \alpha$ならば,
  $A_\sigma$は鏡映ではない.
  $\ee_{\sigma\sigma(i_1)}-\ee_{\sigma\sigma(i_2)}=\ee_{i_1}-\ee_{i_2}$と仮定する.
  このとき, $i_2=i_1$である.
  したがって,  $A_\sigma \alpha = -\alpha$である.
  ここで,
  $i\in \Set{i_1, i_2}$の他に$\sigma(i)=i$となる$i$がなければ, $\sigma$は互換である.
  $j_1\not\in \Set{i_1,i_2}$が
  $\sigma(j_1)\neq j_1$を満たすとする.
  $\sigma(j_1)=j_2$とし, $\beta=\ee_{j_1}-\ee_{j_2}$とおく.
  $\alpha$のときと同じ議論で,
  $\sigma(j_2)\neq j_1$であるときには, $A_\sigma$は鏡映ではないことがわかる.
  $\sigma(j_2)= j_1$を仮定すると, $A_\sigma \beta=-\beta$がなりたつ.
  $\Set{i_1,i_2}\neq \Set{j_1,j_2}$であるので,
  $\alpha$と$\beta$は一次独立である.
  したがって, $A_\sigma$の固有値$1$に属する固有空間の次元は$1$ではないので,
  鏡映ではない.
\end{example}

\sectionX{章末問題}
\begin{enumerate}
\item
  実数$\theta, \tau$に対し, 次を示せ:
  \begin{enumerate}
  \item
    $R(\theta) R(\tau)=R(\theta+\tau)$.
  \item
    $P(\theta) P(\tau)=R(\theta-\tau)$.
  \item
    $P(\theta) R(\tau)=P(\theta-\tau)$.
  \item
    $R(\theta) P(\tau)=P(\theta-\tau)$.
  \end{enumerate}
\item
  $S$を次の$3$次正方行列からなる集合とする:
  \begin{align*}
    E_3&=\begin{pmatrix}1&0&0\\0&1&0\\0&0&1\end{pmatrix},\\
    T_{1,2}&=\begin{pmatrix}0&1&0\\1&0&0\\0&0&1\end{pmatrix},&
    T_{2,3}&=\begin{pmatrix}1&0&0\\0&0&1\\0&1&0\end{pmatrix},&
    T_{1,3}&=\begin{pmatrix}0&0&1\\0&1&0\\1&0&0\end{pmatrix},\\
    A&=\begin{pmatrix}0&1&0\\0&0&1\\1&0&0\end{pmatrix},&
    A'&=\begin{pmatrix}0&0&1\\1&0&0\\0&1&0\end{pmatrix}.
  \end{align*}
  各行各列にちょうど1つの1が現れそれ以外は0である$3$次正方行列を集めた集合である.
  このとき次を示せ:
  \begin{enumerate}
    \item $A=T_{1,2}T_{2,3}$.
    \item $A'=T_{2,3}T_{1,2}$.
    \item $T_{1,3}=T_{1,2}T_{2,3}T_{1,2}$.
    \item $X, Y\in S \implies XY\in S$.
    \item $X\in S \implies X^{-1}\in S$.
  \end{enumerate}
\end{enumerate}

\chapter{有限鏡映群}
ここでは,
有限鏡映群の定義と例を与えることを目標とする.
\section{有限鏡映群の定義}
まずは有限鏡映群の定義を与える.
\begin{definition}
  次の条件をみたすとき, 
  $W$を$V$上の鏡映群と呼ぶ:
  \begin{enumerate}
  \item
    $W=\Braket{s_1,\ldots,s_t}_{\ZZ}$をみたす
    $V$上の鏡映変換
    $s_1,\ldots,s_t$が存在する.
  \end{enumerate}
\end{definition}

また行列に対しても同様に定義をする.
\begin{definition}
  次の条件をみたすとき, 
  $W$を鏡映群と呼ぶ:
  \begin{enumerate}
  \item
    $W=\Braket{A_1,\ldots,A_t}_{\ZZ}$をみたす
    鏡映
    $A_1,\ldots,A_t$が存在する.
  \end{enumerate}
\end{definition}
鏡映群$W$が有限集合であるとき,
$W$を有限鏡映群と呼ぶ.

\begin{definition}
  $W$を$V$上の鏡映群とする.
  次の条件をみたすとき, 
  $W$は本質的であるという:
  \begin{align*}
    \forall \alpha\in V\setminus\Set{\zzero},\ 
    \exists w\in W
    \text{ s.t. }
    w(\alpha)\neq \alpha.
  \end{align*}
\end{definition}

\Cref{prop:reflisortho}から次がすぐわかる.
\begin{prop}
\label{prop:reflgrpisortho}
  $W$を$V$上の鏡映群であるとする.
  このとき, $w\in W$は内積を保つ.
\end{prop}

行列のときには次の様に言い換えられる.
\begin{prop}
  $W$を鏡映群であるとする.
  このとき, $A \in W$は直交行列である.
\end{prop}

\section{有限鏡映群の例}
有限鏡映群の例を見ていく.
\subsection{$I_2(m)$}
\label{ex:i2m:grp}
$m>1$とする.
\Cref{ex:i2m:ref,ex:i2m:rot}で見た行列について考えるが,
ここでは, 記号の簡略化のために
\begin{align*}
  P_i
  &=P\left(\frac{2i\pi}{m}\right),&
  R_i
  &=R\left(\frac{2i\pi}{m}\right)
\end{align*}
とおく.
まず, $P_i$, $R_i$の計算規則について調べておく.
\begin{lemma}
  \begin{align*}
    P_i &= P_{i+m},\\
    R_i &= R_{i+m}.
  \end{align*}
\end{lemma}
\begin{lemma}
  \begin{align*}
    R_i R_j&= R_{i+j},\\
    R_i&=(R_1)^i.
  \end{align*}
\end{lemma}
\begin{lemma}
  \begin{align*}
    (R_i)^m&=E_2,\\
    (P_i)^2&=E_2.
  \end{align*}
\end{lemma}

\begin{lemma}
  \label{lem:i2m:rp=p:pr=p:}
  \begin{align*}
    R_iP_0&=P_i,\\
    P_0R_i &= P_{-i}.
  \end{align*}
\end{lemma}
\begin{proof}
  \begin{align*}
    R_iP_0
    &=R\left(\frac{2i\pi}{m}\right)
    P_0\\
  &=
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & -\sin(\frac{2i\pi}{m})\\
    \sin(\frac{2i\pi}{m}) & \cos(\frac{2i\pi}{m})\\
  \end{pmatrix}
  \begin{pmatrix}
    1 & 0\\
    0 & -1\\
  \end{pmatrix}\\
  &=
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & \sin(\frac{2i\pi}{m})\\
    \sin(\frac{2i\pi}{m}) & -\cos(\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=R\left(\frac{2i\pi}{m}\right)=R_{i}.
  \end{align*}
  \begin{align*}
    P_0R_i
    &=P_0
    R\left(\frac{2i\pi}{m}\right)\\
  &=
  \begin{pmatrix}
    1 & 0\\
    0 & -1\\
  \end{pmatrix}
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & -\sin(\frac{2i\pi}{m})\\
    \sin(\frac{2i\pi}{m}) & \cos(\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=
  \begin{pmatrix}
    \cos(\frac{2i\pi}{m}) & -\sin(\frac{2i\pi}{m})\\
    -\sin(\frac{2i\pi}{m}) & -\cos(\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=
  \begin{pmatrix}
    \cos(-\frac{2i\pi}{m}) & \sin(-\frac{2i\pi}{m})\\
    \sin(-\frac{2i\pi}{m}) & \cos(-\frac{2i\pi}{m})\\
  \end{pmatrix}\\
  &=
  P\left(-\frac{2i\pi}{m}\right)
  =P_{-i}
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lem:i2m:rel:pp=r:pr=p:rp=p}
  \begin{align*}
    P_i P_j&= R_{i-j},\\
    R_i P_j&= P_{i+j},\\
    P_i R_j&= P_{i-j}.
  \end{align*}
\end{lemma}
\begin{proof}
  \begin{align*}
    R_iP_0&=P_i,\\
    P_0R_{-j} &= P_{j},\\
    P_iP_j&=R_i P_0P_0R_{-j}=R_{i}R_{-j}=R_{i-j}.
  \end{align*}
  \begin{align*}
    P_0R_{-i} &= P_{i},\\
    R_jP_0&=P_j,\\
    R_iP_j&=R_iR_jP_0=R_{i+j}P_0=P_{i+j},\\
    P_iR_j&=P_0R_{-i}R_j=P_0R_{-i+j}=P_{i-j}.
  \end{align*}
\end{proof}


\begin{lemma}
  \label{lem:i2m:rel:ppp=p:rpr=p:}
  \begin{align*}
    P_i P_j (P_i)^{-1}&= P_{2i-j},\\
    R_i P_j (R_i)^{-1}&= P_{2i+j}.
  \end{align*}
\end{lemma}
\begin{proof}
  \begin{align*}
    P_i P_j (P_i)^{-1}
    &=R_{i-j}P_i
    =P_{2i-j},\\
    R_i P_j (R_i)^{-1}&= P_{i+j}R_{-i}=P_{2i+j}.
  \end{align*}
\end{proof}


$D_{2\cdot m}$を次で定義する:
\begin{align*}
  D_{2\cdot m} = \Set{P_i,R_i|i\in \ZZ} = \Set{P_i,R_i|i=0,\ldots,m-1}.
\end{align*}
$R_0=E_2$であるので,
\Cref{lem:i2m:rel:pp=r:pr=p:rp=p}から,
$D_{2\cdot m}$が群であることがわかる.
\Cref{lem:i2m:rp=p:pr=p:}から,
$R_iP_0=P_i$であるので,
$R_i=P_iP_0$である.
したがって,
\begin{align*}
   D_{2\cdot m} = \Braket{P_0,\ldots,P_{m-1}}_{\ZZ}
\end{align*}
であることがわかる.
$P_i$は鏡映であったので,
$D_{2\cdot m}$は有限鏡映群である.
$D_{2\cdot m}$は位数$2m$の二面体群とよばれる.

\begin{prop}
$m>1$のとき, $D_{2\cdot m}$は本質的である.
\end{prop}
\begin{proof}
  \begin{align*}
    \alpha=\begin{pmatrix}
      \alpha_1 \\
      \alpha_2
    \end{pmatrix}\in V\setminus\Set{\zzero}
  \end{align*}
  とする.
  $\alpha_2\neq 0$のとき,
  \begin{align*}
    P_0 \alpha =
    \begin{pmatrix}
      1&0\\
      0&-1
    \end{pmatrix}  
    \begin{pmatrix}
      \alpha_1\\
      \alpha_2
    \end{pmatrix}
    =
    \begin{pmatrix}
      \alpha_1\\
      -\alpha_2
    \end{pmatrix}
    \neq \alpha.
  \end{align*}
  また$\alpha_2=0$のとき,
  $\alpha\neq \zzero$であることから,
  $\alpha_1\neq 0$ となる.
  このとき,
  \begin{align*}
    P_1 \alpha =
    \begin{pmatrix}
      \cos(\frac{2\pi}{m})&\sin(\frac{2\pi}{m})\\
      \sin(\frac{2\pi}{m})&-\cos(\frac{2\pi}{m})
    \end{pmatrix}  
    \begin{pmatrix}
      \alpha_1\\
      0
    \end{pmatrix}
    =
    \begin{pmatrix}
      \alpha_1\cos(\frac{2\pi}{m})\\
      \alpha_1\sin(\frac{2\pi}{m})
    \end{pmatrix}  
    \neq
    \begin{pmatrix}
      \alpha_1\\
      0
    \end{pmatrix}
    .
  \end{align*}
\end{proof}
\begin{prop}
  $m=1$のとき, つまり $D_{2\cdot 1}$は本質的ではない.
\end{prop}

\begin{proof}
  $D_{2\cdot 1}=\Set{P_0,R_0}$である.
  \begin{align*}
    \alpha=
    \begin{pmatrix}
      1\\0
      \end{pmatrix}
  \end{align*}
  とすると,
  $P_0\alpha = R_0\alpha= \alpha $である.
\end{proof}

\begin{lemma}
  \label{lem:i2m:conjclass:}
  \begin{align*}
    \Set{P_{k+2i},P_{-k+2i} | i \in \ZZ} = \Set{AP_kA^{-1} | A\in D_{2\cdot m}}.
  \end{align*}
\end{lemma}
\begin{proof}
  $P_{k+2i}\in \Set{AP_kA^{-1} | A\in D_{2\cdot m}}$
  を示す.
  $A=R_{i}$とすれば,
  \Cref{lem:i2m:rel:ppp=p:rpr=p:}から,
  $AP_{k}A^{-1}=P_{2i+k}$となる.
  $P_{-k+2i}\in \Set{AP_kA^{-1} | A\in D_{2\cdot m}}$
  を示す.
  $A=P_{i}$とすれば,
  \Cref{lem:i2m:rel:ppp=p:rpr=p:}から,
  $AP_{k}A^{-1}=P_{2i-i}$となる.

 $A\in D_{2\cdot m}$に対し,
 $AP_0A^{-1}\in \Set{P_{k+2i} | i \in \ZZ}$を示す.
 $A=R_i$のとき,
 \Cref{lem:i2m:rel:ppp=p:rpr=p:}から,
 $AP_kA^{-1}=P_{2i+k}$である.
 一方,
 $A=P_j$のとき,
 $AP_kA^{-1}=P_{2j-k}$である.
 \end{proof}

\begin{prop}
  \label{lem:i2m:conjclass:odd}
  $m$が奇数であるとする.
  このとき,
  \begin{align*}
    \Set{P_i | i \in \ZZ}
    &= \Set{AP_0A^{-1} | A\in D_{2\cdot m}}\\
    &= \Set{AP_1A^{-1} | A\in D_{2\cdot m}}\\
    &\vdots
  \end{align*}
  つまり, $\Set{P_i | i \in \ZZ}$は$P_0$を含む共軛類である.
\end{prop}
\begin{proof}
  $C=\Set{AP_0A^{-1} | A\in D_{2\cdot m}}$とおく.
  このとき, \Cref{lem:i2m:conjclass:}より,
  $C=\Set{P_{2l}| l \in \ZZ}$である.

  $C=\Set{AP_0A^{-1} | A\in D_{2\cdot m}}$であるので,
  $AP_0A^{-1}\in \Set{AP_0A^{-1} | A\in D_{2\cdot m}} \subset \Set{P_i | i \in \ZZ}$である.

  $P_{i}\in C$
  を示す.
  $i$が偶数のとき,
  であることから, $P_{i}\in C$である.
  $i$が奇数のときについて考える.
  $P_{i}=P_{i+m}$であるが,
  $m$が奇数なので, $i+m$は偶数である.
  したがって$P_{i}=P_{i+m}\in C$である.

  
  $C_k=\Set{AP_kA^{-1} | A\in D_{2\cdot m}}$とおく.
  $C=C_k$を示す.
  $P_k\in C$である.
  したがって, $AP_0A^{-1}=P_k$となる$A\in D_{2\cdot m}$が存在する.

  
  $B\in D_{2\cdot m}$とする.
  $AP_0A^{-1}=P_k$であるので,
  $P_0=A^{-1}P_k A$である.
  $BP_0B^{-1}=BA^{-1}P_k AB^{-1}=(BA^{-1})P_k(BA^{-1})^{-1}$
  であるので, $BP_0B^{-1}\in C_k$である.
  
  $B\in D_{2\cdot m}$とする.
  $BP_k B^{-1}=BAP_0A^{-1}B^{-1}=(BA)P_0(BA)^{-1}$であるので,
  $BP_k B^{-1}\in C$である.
  
\end{proof}

\begin{prop}
  \label{lem:i2m:conjclass:even}
  $m$を偶数とする.
  このとき,
  \begin{align*}
    \Set{P_{2i}|i\in\ZZ}&=\Set{AP_0A^{-1} | A \in D_{2\cdot m}}=\Set{AP_2A^{-1} | A \in D_{2\cdot m}}=\cdots,\\
    \Set{P_{2i+1}|i\in\ZZ}&=\Set{AP_1A^{-1} | A \in D_{2\cdot m}}=\Set{AP_3A^{-1} | A \in D_{2\cdot m}}=\cdots,\\
    \Set{P_{2i}|i\in\ZZ}&\cap \Set{P_{2i+1}|i\in\ZZ} =\emptyset.
  \end{align*}
つまり, 
$\Set{P_{2i}|i\in\ZZ}$ は $P_0$を含む共軛類,
$\Set{P_{2i+1}|i\in\ZZ}$は$P_1$を含む共軛類であり,
この2つの共軛類は異なる.
\end{prop}
\begin{proof}
  \Cref{lem:i2m:conjclass:}
  から,
  \begin{align*}
    \Set{P_{2i}|i\in\ZZ}&=\Set{AP_0A^{-1} | A \in D_{2\cdot m}}=\Set{AP_2A^{-1} | A \in D_{2\cdot m}}=\cdots,\\
    \Set{P_{2i+1}|i\in\ZZ}&=\Set{AP_1A^{-1} | A \in D_{2\cdot m}}=\Set{AP_3A^{-1} | A \in D_{2\cdot m}}=\cdots.
  \end{align*}
  はすぐわかる.

  $P_{k}=P_{l}$とする.
  このとき, $E_{2}=(P_{k})^{-1}(P_{l})=P_{k}P_{l}=R_{k-l}$である.
  $R_{j}=E_2$となるのは$j$が$m$の倍数であるときのみである.
  したがって, $k-l$が$m$の倍数である.
  今, $m$は偶数であるので, $k-l$も偶数でなければいけない.
  よって, $k$と$l$の偶奇は一致する.
  したがって, $P_{2i}\not\in\Set{P_{2i+1}|i\in\ZZ}$かつ,
  $P_{2i+1}\not\in\Set{P_{2i}|i\in\ZZ}$であるので,
\begin{align*}
    \Set{P_{2i}|i\in\ZZ}&\cap \Set{P_{2i+1}|i\in\ZZ} =\emptyset
  \end{align*}
  である.
\end{proof}

\subsection{$A_{n-1}$}
\label{ex:an:grp}
$W=\Set{A_\sigma|\sigma\in S_n}$とおく.
$\sigma,\sigma' \in S_n$に対し,
$A_\sigma A_\tau=A_{\sigma\sigma'}$
が成り立つことは直接計算することで確かめられる.
また,
$A_{\varepsilon}=E_n$であり,
$A_\sigma^{-1}=A_{\sigma^{-1}}$である.
したがって, $W$は群である.
さらに,
$f(\sigma)=A_\sigma$とおくと,
$f$は$S_n$から$W$への全単射である.
さらに, これは群準同型写像であるので,
$S_n$と$W$は同型である.


$\tau_{i,j}\in S_n$を$i$と$j$を入れ替える互換とする.
つまり,
\begin{align*}
  \tau(k)=
  \begin{cases}
    j&(k=i)\\
    i&(k=j)\\
    k&(k\not\in\Set{i,j})
  \end{cases}
\end{align*}
とする.
このとき, $A_{\tau_{i,j}}=T_{i,j}$であり, 鏡映である.
$S_n$は互換で生成されていたので, $W$は$\Set{T_{i,j}|i\neq j}$で生成される.
したがって, $W$は有限鏡映群である.


$S_n$は隣接互換$\tau_{1,2},\tau_{2,3},\ldots,\tau_{n-1,n}$
で生成されていたので,
$W$は$T_{1,2},T_{2,3},\ldots,T_{n-1,n}$という$n-1$個の行列で生成できることがわかる.


\begin{prop}
$\alpha=\ee_1+\cdots+\ee_n$とおく.
このとき, 任意の$A\in W$に対し,
$A\alpha=\alpha$となる.
したがって, $W$は本質的ではない.
\end{prop}
\begin{proof}
  $\sigma\in S_n$とする.
  このとき,
  \begin{align*}
    A_\sigma \alpha=\sum_{i=1}^{n}A_\sigma \ee_i=\sum_{i=1}^{n} \ee_{\sigma(i)}
  \end{align*}
  となるが, $\sigma$は$\Set{1,\ldots,n}$上の全単射であるので,
  \begin{align*}
    \sum_{i=1}^{n} \ee_{\sigma(i)}=\sum_{i=1}^{n} \ee_i=\alpha
  \end{align*}
  となる.
\end{proof}


\subsection{$A_1\times \cdots \times A_1$}
\label{ex:a1n:grp}
$W$を
\begin{align*}
 W= \Set{\diag(a_1,\ldots,a_n)|a_i\in \ZZ^\times}
\end{align*}
で定義する.
このとき, $W$は群である.
また,
$(a_1,\ldots,a_n)\in (\ZZ^\times)^n$に対し,
$f((a_1,\ldots,a_n))=\diag(a_1,\ldots,a_n)$
とすると,
$f$は$(\ZZ^\times)^n$から$W$への全単射である.
また, 準同型写像でもあるので,
$(\ZZ^\times)^n$と$W$は同型である.

また, $(-1,1,\ldots,1)$,\ldots,$(1,\ldots,1,-1)$で$ (\ZZ^\times)^n$は生成されていたので,
$F_1$,\ldots,$F_n$で$W$は生成される.
$F_k$は鏡映であったので,
$W$は有限鏡映群である.

\begin{prop}
  $W$は本質的である.
\end{prop}
\begin{proof}
  $\alpha\in V$とする.
  $A=\diag(-1,\ldots,-1)\in W$とすると,
  $A\alpha=-\alpha$である.
  $\alpha\neq \zzero$とすると,
  $0$ではない第$i$成分$\alpha_i$が存在する.
  このとき, $-\alpha_i\neq \alpha$であるので,
  $A\alpha\neq \alpha$である.
\end{proof}


\subsection{$B_n$}
\label{ex:bn:grp}
$W$を
\begin{align*}
  W=\Set{\diag(\aaa)A_\sigma|\aaa
    \in (\ZZ^\times)^n, \sigma\in S_n}
\end{align*}
で定義する.
\begin{align*}
  A_\sigma \diag(a_1,\ldots,a_n)A_{\sigma}^{-1}\ee_{k}
&=  A_\sigma \diag(a_1,\ldots,a_n)A_{\sigma^{-1}}\ee_{k}\\
&=  A_\sigma \diag(a_1,\ldots,a_n)\ee_{\sigma^{-1}(k)}\\
&=  A_\sigma (a_{\sigma^{-1}(k)}\ee_{\sigma^{-1}(k)})\\  
&=  a_{\sigma^{-1}(k)}A_\sigma \ee_{\sigma^{-1}(k)}\\  
&=  a_{\sigma^{-1}(k)} \ee_{\sigma\sigma^{-1}(k)}\\  
&=  a_{\sigma^{-1}(k)} \ee_{k}\\  
\end{align*}
であるので,
\begin{align*}
  A_\sigma \diag(a_1,\ldots,a_n)A_{\sigma}^{-1}
  =\diag(a_{\sigma^{-1}(1)},\ldots,a_{\sigma^{-1}(n)})
\end{align*}
である.  つまり,
\begin{align*}
  A_\sigma \diag(a_1,\ldots,a_n)
  =\diag(a_{\sigma^{-1}(1)},\ldots,a_{\sigma^{-1}(n)})A_{\sigma}
\end{align*}
であることから,
\begin{align*}
  (\diag(b_1,\ldots,b_n)A_\tau)( \diag(a_1,\ldots,a_n)A_{\sigma})
  =\diag(b_1a_{\tau^{-1}(1)},\ldots,b_na_{\tau^{-1}(n)})A_{\tau\sigma} \in W
\end{align*}
となる.
よって, $W$は群である.
$\diag(\aaa)$も$A_\sigma$も鏡映の積としてかけるので,
$\diag(\aaa)A_\sigma$も鏡映の積としてかける.
つまり, $W$は有限鏡映群である.

\begin{prop}
  $W$は本質的である.
\end{prop}
\begin{proof}
$\diag(-1,\ldots,-1)\in W$であることからすぐわかる.
\end{proof}


\subsection{$D_n$}
\label{ex:dn:grp}
$W$を
\begin{align*}
  W=\Set{ \diag(a_1,\ldots,a_n) A_{\sigma} | \sigma\in S_n , (a_1,\ldots,a_n)\in (\ZZ^{\times})^n, a_1\cdots a_n =1}
\end{align*}
とおく,
\begin{align*}
  (\diag(b_1,\ldots,b_n)A_\tau)( \diag(a_1,\ldots,a_n)A_{\sigma})
  =\diag(b_1a_{\tau^{-1}(1)},\ldots,b_na_{\tau^{-1}(n)})A_{\tau\sigma} \in W
\end{align*}
であるが, $b_1\cdots b_n=a_1\cdots a_n=1$ならば$b_1a_{\tau^{-1}(1)}\cdots b_na_{\tau^{-1}(n)}=1$
である. したがって,
$W$は群である.

$a_1\cdots a_n = 1$とすると,
$a_i=-1$となる$i$は偶数個である.
$2k$個の$i$で$a_i=-1$であるとし,
$\Set{i|a_i=-1}=\Set{i_1,\ldots,i_{2k}}$とする.
このとき, $\tau=\tau_{i_1i_2}\cdots \tau_{i_{2k-1}i_{2k}}$
とおくと,
\begin{align*}
F_{i_1,i_2}\cdots F_{i_{2k-1},i_{2k}}=\diag(a_1,\ldots,a_n)A_{\tau}
\end{align*}
である.  したがって$\sigma\in S_n$に対し,
\begin{align*}
  \diag(a_1,\ldots,a_n)A_{\sigma}
  &=\diag(a_1,\ldots,a_n)A_{\tau}A_{\tau}^{-1} A_{\sigma}\\
  &=F_{i_1,i_2}\cdots F_{i_{2k-1},i_{2k}}A_{\tau^{-1}} A_{\sigma}\\
  &=F_{i_1,i_2}\cdots F_{i_{2k-1},i_{2k}}A_{\tau^{-1}\sigma}
\end{align*}
とかける.
したがって, $W$は$\Set{F_{k,l}, T_{k,l}|k\neq l}$
で生成される.
$F_{k,l}$も$T_{k,l}$も鏡映であったから
$W$は有限鏡映群である.


\begin{prop}
$W$は本質的である.
\end{prop}
\begin{proof}
  $\alpha\in V\setminus\Set{\zzero}$とする.
  $\alpha\neq \zzero$なので,
  $0$ではない第$k$成分$\alpha_k$が存在する.
  \begin{align*}
    F_{k,l}T_{k,l}=F_kF_lT_{k,l}T_{k,l}=F_{k}F_{l}
  \end{align*}
  となるので,
  $F_{k}F_{l}\in W$である.
  $-\alpha_k\neq \alpha$であるので
  $F_{k}F_{l}\alpha \neq \alpha$である.
\end{proof}

\sectionX{章末問題}
\begin{enumerate}
\item 
  $m$を正の整数とし,
  \begin{align*}
    S=\Set{
      \alpha\left(\frac{i\pi}{m}\right)
      | i\in\ZZ
    }
  \end{align*}
  とする. $k\in\ZZ$に対し次を示せ:
  \begin{enumerate}
    \item $\alpha\in S\implies P\left(\frac{2k\pi}{m}\right) \alpha\in S$.
    \item $\alpha\in S\implies R\left(\frac{2k\pi}{m}\right) \alpha\in S$.
  \end{enumerate}
\item
  $S$を次の集合とする.
  \begin{align*}
    S=\Set{
      \ee_1-\ee_2,
      \ee_2-\ee_1,
      \ee_1-\ee_3,
      \ee_3-\ee_1,
      \ee_2-\ee_3,
      \ee_3-\ee_2
    }.
  \end{align*}
  次を示せ:
  \begin{enumerate}
    \item $\alpha\in S\implies T_{1,2}\alpha \in S$.
    \item $\alpha\in S\implies T_{2,3}\alpha \in S$.
  \end{enumerate}
\end{enumerate}


\chapter{ルート系}

ここでは,
有限鏡映群の重要な情報を持っている
ルート系と呼ばれるものを定義し例を与えることを目標とする.

\section{ルート系の定義}

集合$\Phi\subset V\setminus \Set{\zzero}$に対し,
$R(\Phi)=\Set{s_\alpha | \alpha \in \Phi}$
とし,
$W(\Phi)=\Braket{R(\Phi)}_{\ZZ}$とおく.
定義から$W(\Phi)$は鏡映群であるが,
$\Phi$が有限であっても$W(\Phi)$は有限群とは限らない.

\begin{lemma}
  \label{lem:nonesspart}
  $f\in W(\Phi)$に対し,
  $f\restrictedto{\Braket{\Phi}_{\RR}^{\perp}}=\id_{\Braket{\Phi}_{\RR}^{\perp}}$.
\end{lemma}
\begin{proof}
  $f\in W(\Phi)$とすると,
  $\alpha_i\in \Phi$を使って
  $f=s_{\alpha_1}\cdots s_{\alpha_l}$とかける.
  $\beta\in \Braket{\Phi}_\RR^{\perp}$とする.
  $\alpha_i\in \Phi$に対して,
  $\Braket{\alpha_i,\beta}=0$であるので,
  $s_{\alpha_i}(\beta)=\beta$である.
  したがって, 
  $f(\beta)=\beta$である.
\end{proof}

\Cref{lem:nonesspart}から次がすぐわかる.
\begin{lemma}
  \label{lem:esspart:eq}
  $f,f'\in W(\Phi)$とする.
  $f\restrictedto{\Braket{\Phi}_\RR}=f'\restrictedto{\Braket{\Phi}_\RR}$
  ならば,
  $f=f'$.
\end{lemma}
\begin{proof}
  $V=\Braket{\Phi}_\RR\oplus \Braket{\Phi}_\RR^\perp$
  と(内部)直和分解できる.
  \cref{lem:nonesspart}より,
  $\beta\in \Braket{\Phi}_\RR^\perp$に対し,
  $f(\beta)=f'(\beta)=\beta$である.
  また仮定より, $\beta\in \Braket{\Phi}_\RR$に対しても,
  $f(\beta)=f'(\beta)$が成り立つので,
  $f=f'$である.  
\end{proof}


\begin{definition}
  $\Phi \subset V \setminus \Set{\zzero}$とする.
  以下の条件を満たすとき, $\Phi$が$V$上の広義ルート系であると呼ぶ:
  \begin{enumerate}
  \item $\numof{\Phi}<\infty$
  \item 任意の$\alpha \in \Phi$に対し,
    $s_\alpha (\Phi) = \set{s_\alpha(\beta)|\beta\in \Phi}=\Phi$.
  \end{enumerate}
\end{definition}

\begin{definition}
  $\Phi \subset V \setminus \Set{\zzero}$を広義ルート系とする.
  以下の条件を満たすとき, $\Phi$が$V$上の (被約) ルート系であると呼ぶ:
  \begin{enumerate}
  \item 任意の$\alpha \in \Phi$に対し,
    $\RR\alpha \cap \Phi = \Set{\alpha,-\alpha}$.
  \end{enumerate}
\end{definition}

\begin{definition}
  $\Phi \subset V \setminus \Set{\zzero}$を被約ルート系とする.
  以下の条件を満たすとき, $\Phi$が$V$上の結晶的ルート系であると呼ぶ:
  \begin{enumerate}
    \item
    $\alpha,\beta\in\Phi$ならば,
      $2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}$は整数である.
  \end{enumerate}
\end{definition}

\begin{remark}
  本稿では,
  被約ルート系のことを単にルート系と呼ぶ.
  結晶的ルート系のことを単にルート系と呼ぶ流儀もある.
\end{remark}

\begin{prop}
広義ルート系$\Phi$に対し,
$W(\Phi)$は有限鏡映群である.
\end{prop}
\begin{proof}
  $W(\Phi)$が有限集合であることを示す.
  $S_\Phi$を$\Phi$上の全単射を集めた集合とする.
  このとき, $\numof{S_\Phi}=\numof{\Phi}!$であり,
  有限集合である.
  $W'=\Set{f\restrictedto{\Phi}|f \in W(\Phi)}$
  とおく.
  $\alpha\in\Phi$に対し, $s_\alpha(\Phi)=\Phi$であるので,
  \begin{align*}
    s_\alpha\restrictedto{\Phi}\colon
    \Shazo{\Phi}{\Phi}
          {\beta}{s_\alpha(\beta)}
  \end{align*}
  は全単射である.
  $f\in W(\Phi)$とすると,
  $f=s_{\alpha_1}\cdots s_{\alpha_l}$とかけるので,
  $f|_\Phi$も
  $\Phi$上の全単射である.
  つまり, $W'\subset S_\Phi$であり, $W'$は有限集合である.
  ここで
  \begin{align*}
    \varphi\colon
    \Shazo{W(\Phi)}{W'}
          {f}{f|_{\Phi}}
  \end{align*}
  とおく.
  このとき,
  \Cref{lem:esspart:eq}
  より,
  $\varphi$は単射である.
  したがって, $W(\Phi)$も有限集合である.
\end{proof}

\begin{prop}
  \label{thm:finitereflgrphasrootsystem}
  $W$を有限鏡映群とする.
  このとき, $W=W(\Phi)$となる
  ルート系$\Phi$が存在する.
\end{prop}
\begin{proof}
  \begin{align*}
    R&=\Set{ s\in W| \text{$s$は鏡映}}\\
    \Phi&=\Set{\alpha \in V | s_\alpha \in R, \|\alpha \|=1}
  \end{align*}
  とすればよい.
  $W$は鏡映群であるので,
  $W=\Braket{R}_{\ZZ}=\Braket{R(\Phi)}_{\ZZ}=W(\Phi)$である.
  $\numof{\Phi}=2\numof{R}\leq 2|W| <\infty$である.
  また, 定義から, $\alpha\in \Phi$に対し,
  $\RR\alpha \cap \Phi = \Set{\alpha,-\alpha}$が成り立つ.
  $\alpha\in \Phi$,
  $f\in W$とすると,
  $fs_\alpha f^{-1}=s_{f(\alpha)}$である.
  $fs_\alpha f^{-1}$は$W$の元であり, $s_{f(\alpha)}$は鏡映であるので,
  $s_{f(\alpha)}\in R$がわかる.
  \Cref{prop:reflgrpisortho}
  より, $\|f(\alpha)\|=\|\alpha\|=1$であるので,
  $f(\alpha)\in \Phi$である.
\end{proof}



\section{ルート系の例}
ここでは,
ルート系の例を与える.
\subsection{$I_2(m)$}
\label{ex:i2m:root}
$m$を正の整数とし,
$D_{2\cdot m}$について考える.
\Cref{ex:i2m:grp}で用いた記号をここでは用いる.
\Cref{ex:i2m:ref,ex:i2m:rot}の記号を用いると,
\begin{align*}
  P_i
  &=P\left(\frac{2i\pi}{m}\right),&
  R_i
  &=R\left(\frac{2i\pi}{m}\right)
\end{align*}
である. さらに,
\begin{align*}
  \alpha_i&=\alpha\left(\frac{i\pi}{m}\right)\\
  &=
  \begin{pmatrix}
    \sin(-\frac{i\pi}{m})\\
    \cos(-\frac{i\pi}{m})
  \end{pmatrix}
  =
  \begin{pmatrix}
    \cos(-\frac{i\pi}{m}+\frac{\pi}{2})\\
    \sin(-\frac{i\pi}{m}+\frac{\pi}{2})
  \end{pmatrix} 
\end{align*}
とおく. 
このとき,
\Cref{ex:i2m:ref}より, $P_i$は$\alpha_i$に関する鏡映である.
$\alpha_{i+m}=-\alpha_i$であるから,  $P_i$は$\alpha_{i+m}$に関する鏡映でもある.
一方, \Cref{ex:i2m:rot}より, $R_i$は鏡映ではない.
$D_{2\cdot m}=\Set{P_i,R_i|i \in \Set{0,1,\ldots,m-1}}$であったので,
$\Phi=\Set{\alpha_i | i \in \Set{0,1,\ldots,2m-1} }$とおけば,
$W(\Phi)=D_{2\cdot m}$である.
この$\Phi$がルート系であることは,
\Cref{thm:finitereflgrphasrootsystem}の証明で構成したルート系
そのものであることからわかるが,
ここでは, 確認のため定義に従い調べる.
\begin{align*}
  R_i\alpha_k
  &=R\left(\frac{2i\pi}{m}\right)\alpha(\frac{k\pi}{m})
  =\alpha(\frac{k\pi}{m}+\frac{2i\pi}{m})
  =\alpha(\frac{2i+k\pi}{m})
  =\alpha_{2i+k}\\
  P_0\alpha_k&=P_0\alpha(\frac{k\pi}{m})\\
  &=
  \begin{pmatrix}
    1 & 0 \\
    0 & -1
  \end{pmatrix}
  \begin{pmatrix}
    \sin(-\frac{k\pi}{m}) \\
    \cos(-\frac{k\pi}{m}) 
  \end{pmatrix}
=  \begin{pmatrix}
    \sin(-\frac{k\pi}{m}) \\
    -\cos(-\frac{k\pi}{m}) 
  \end{pmatrix}
=
 \begin{pmatrix}
    -\sin(\frac{k\pi}{m}) \\
    -\cos(\frac{k\pi}{m}) 
 \end{pmatrix}\\
&=
 \begin{pmatrix}
    \sin(-\pi+\frac{k\pi}{m}) \\
    \cos(-\pi+\frac{k\pi}{m}) 
 \end{pmatrix}
=
 \begin{pmatrix}
    \sin(\frac{-(m-k)\pi}{m}) \\
    \cos(\frac{-(m-k)\pi}{m}) 
 \end{pmatrix}
 =\alpha\left(\frac{(m-k)\pi}{m}\right)
 =\alpha_{m-k},
\\
P_i\alpha_k&=P_0R_{-i}\alpha_k
=P_0\alpha_{-2i+k}
=\alpha_{m+2i-k} \in \Phi
\end{align*}
である.
また,
$\RR\alpha_i \cap \Phi=\Set{\alpha_i,\alpha_{i+m}}$である.
さらに$\numof{\Phi}=2m$
であるので, 有限集合であるから,
$\Phi$はルート系である.
このルート系を$\Phi(I_2(m))$とおく.
$\alpha_i,\alpha_i\in\Phi$に対し,
\begin{align*}
  2\frac{\Braket{\alpha_i,\alpha_j}}{\Braket{\alpha_i,\alpha_i}}=2\Braket{\alpha_i,\alpha_j}
\end{align*}
は整数とは限らない.
したがって, $\Phi(I_2(m))$は一般には結晶的ではない.

\Cref{ex:i2m:root}での計算から
\begin{align*}
  R_i\alpha_k& =\alpha_{2i+k}\\
  P_i\alpha_k&=\alpha_{m+2i-k}
\end{align*}
であるので,
\begin{align*}
\Set{w\alpha_0 | w\in W} = \Set{\alpha_{2i}, \alpha_{2i+m}| i \in \ZZ}
\end{align*}
である.

$m$が奇数のときには,
\begin{align*}
\Set{w\alpha_0 | w\in W} = \Set{\alpha_{i}| i \in \ZZ}=\Phi
\end{align*}
となる.
\Cref{prop:reflgrpisortho}より, $w\in W$は内積を保つ.
したがって, \cref{prop:conjbyortho}より,
  $\alpha\in V\setminus\Set{\zzero}$に対し,
$ws_\alpha w^{-1}=s_{w(\alpha)}$となる.
よって
\begin{align*}
\Set{s_{w(\alpha_0)}|w\in W}=\Set{ws_{\alpha_0} w^{-1}|w\in W}
\end{align*}
である.
$m$が奇数のときには,
$\Set{w\alpha_0 | w\in W}=\Phi$
であるので,
\begin{align*}
  R(\Phi)=\Set{ws_{\alpha_0} w^{-1}|w\in W}
\end{align*}
であることがわかる, $R(\Phi)=\Set{P_i|i\in \ZZ}$であり,
$P_0=s_{\alpha_0}$である.
これは, \cref{lem:i2m:conjclass:odd}の別証になっている.

つぎに$m$が偶数のときについて考える.
\begin{align*}
\Phi_0&=\Set{\alpha_{2i}| i \in \Set{1,\ldots,m}}\\
\Phi_1&=\Set{\alpha_{2i-1}| i \in \Set{1,\ldots,m}}\\
\end{align*}
とおく.
\begin{align*}
 \Set{w\alpha_0 | w\in W}
  = \Set{\alpha_{2i}| i \in \ZZ}=\Phi_0
\end{align*}
である.
同様に,
\begin{align*}
\Set{w\alpha_1 | w\in W}
  = \Set{\alpha_{2i-1}| i \in \ZZ}=\Phi_1
\end{align*}
である. $\Phi_0\cap \Phi_1=\emptyset$, $\Phi=\Phi_0\cup \Phi_1$であるので,
$m$が奇数のときと同様に,
\cref{lem:i2m:conjclass:even}の別証を与えることができる.



\subsection{$A_{1}\times\cdots\times A_{1}$}
\label{ex:a1n:root}
$\varepsilon_i=\ee_i$とおく.
\begin{align*}
\Phi=\Set{\varepsilon_1,\ldots,\varepsilon_n,-\varepsilon_1,\ldots,-\varepsilon_n,}
\end{align*}
とおく.  このとき,
$\Phi$はルート系である.
$F_i$を$\varepsilon_i$に関する鏡映とする.
このとき$F_i$は$-\varepsilon_i$に関する鏡映でもある.
$F_i(\pm\varepsilon_i)=\mp\varepsilon_i$である. 
$k\neq i$に対して, $\Braket{\varepsilon_i,\varepsilon_k}=0$であるから,
$F_i(\pm\varepsilon_k)=\pm\varepsilon_k$である.
したがって, $F_i(\Phi)=\Phi$である.
また, $\RR(\pm\varepsilon_i)\cap \Phi=\Set{\varepsilon_i,-\varepsilon_i}$
である.
$\numof{\Phi}=2^n$であるので, ルート系である.
また, クロネッカーの$\delta$を使って,
\begin{align*}
  2\frac{\Braket{\varepsilon_i,\varepsilon_j}}{\Braket{\varepsilon_i,\varepsilon_i}}=2\Braket{\varepsilon_i,\varepsilon_j}=2\delta_{i,j}
\end{align*}
とかけるので, 結晶的である.

\Cref{ex:a1n:grp}であつかった鏡映群を$W$とすると,
\begin{align*}
  W(\Phi)=\Braket{F_1,\ldots,F_n}_{\ZZ}=W
\end{align*}
である.

\subsection{$A_{n-1}$}
\label{ex:an:root}
$\alpha_{i,j}=\ee_i-\ee_j$とし,
\begin{align*}
  \Phi=\Set{\alpha_{i,j}|i\neq j \in \Set{1,\ldots,n}}
\end{align*}
とする.
$T_{i,j}$は$\alpha_{i,j}$に関する鏡映である.
$\alpha_{i,j}=-\alpha_{j,i}$であるので,
$T_{i,j}$は$-\alpha_{i,j}$に関する鏡映でもある.
$\tau\in S_n$を$i$と$j$を入れ替える互換とすると,
\begin{align*}
  T_{i,j}\alpha_{k,l}&=\alpha_{\tau(k),\tau(l)}
\end{align*}
であるから, $T_{i,j}(\Phi)=\Phi$である.
$\RR\alpha_{i,j}\cap \Phi=\Set{\alpha_{i,j},\alpha_{j,i}}$
であり,
$\numof{\Phi}=2\binom{n}{2}$であるので,
$\Phi$はルート系である.
このルート系を$\Phi(A_{n-1})$とおく.
$\Braket{\alpha_{i,j},\alpha_{i,j}}=2$であるので,
\begin{align*}
  2\frac{\Braket{\alpha_{i,j},\alpha_{k,l}}}{\Braket{\alpha_{i,j},\alpha_{i,j}}}=\Braket{\alpha_{i,j},\alpha_{k,l}}
\end{align*}
と書け, 整数であることがわかる.
したがって
$\Phi(A_{n-1})$は結晶的である.
\Cref{ex:an:grp}で考えた鏡映群を$W$とすると,
\begin{align*}
  W(\Phi)=\Braket{R(\Phi)}=W
\end{align*}
である.

\subsection{$B_{n}$}
\label{ex:bn:root}
$1\leq i<j\leq n$,
$\alpha_{i,j}=\ee_i-\ee_j$,
$\beta_{i,j}=\ee_i+\ee_j$,
$\varepsilon_{k}=\ee_k$.
とする.
\begin{align*}
  \Phi_1&=\Set{\alpha_{i,j},-\alpha_{i,j}|1\leq i<j\leq n}\\
  \Phi_2&=\Set{\beta_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\\
  \hat\Phi&=\Phi_1\cup \Phi_2\\
  \check\Phi&=\Set{\varepsilon_k,-\varepsilon_k|1\leq k\leq n}
\end{align*}
とする.
\begin{align*}
  \Phi&=\hat\Phi\cup \check\Phi
\end{align*}
とおく.

$F_{k}$は
$\varepsilon_{k}$に関する鏡映である.
\begin{align*}
  F_{k}\alpha_{i,j}&=
  \begin{cases}
    \alpha_{i,j} & (k\not\in \Set{i,j})\\
    \beta_{i,k} & (k=j)\\
    -\beta_{j,k} & (i=k)\\
  \end{cases}
  \\
  F_k \beta_{i,j}&=
  \begin{cases}
    \beta_{i,j} & (k\not\in \Set{i,j})\\
    \alpha_{i,k} & (k=j)\\
    \alpha_{j,k} & (i=k)
  \end{cases}
  \\
  F_{k}\varepsilon_{i}&=
  \begin{cases}
    -\varepsilon_{k}&(i=k)\\
    \varepsilon_{i} &(i\neq k)
  \end{cases}
\end{align*}
であるので, 
$F_{k}(\hat\Phi)=\hat\Phi$
かつ$F_{k}(\check\Phi)=\check\Phi$である.

$T_{i,j}$は
$\alpha_{i,j}$に関する鏡映である.
$\tau\in S_n$を$i$と$j$を入れ替える互換とすると,
\begin{align*}
  T_{i,j}\alpha_{k,l}&=\alpha_{\tau(k),\tau(l)}\\
  T_{i,j}\beta_{k,l}&=\beta_{\tau(k),\tau(l)}\\
  T_{i,j}\varepsilon_{k}&=\varepsilon_{\tau(l)}
\end{align*}
であるので,
$T_{i,j}(\hat\Phi)=\hat\Phi$
かつ$T_{i,j}(\check\Phi)=\check\Phi$である.


$F_{k,l}=F_kF_lT_{k,l}$は, $\beta_{k,l}$に関する鏡映である.
$T_{i,j}(\hat\Phi)=\hat\Phi$,
$T_{i,j}(\check\Phi)=\check\Phi$,
$F_{k}(\hat\Phi)=\hat\Phi$,
$F_{k}(\check\Phi)=\check\Phi$であるので,
$F_{k,l}(\hat\Phi)=\hat\Phi$,
$F_{k,l}(\check\Phi)=\check\Phi$である.

したがって, $\alpha\in \Phi$に対し,
$s_{\alpha}(\Phi)=\Phi$である.
また,
$\RR\alpha\cap\Phi=\Set{\alpha,-\alpha}$である.
$\numof{\Phi}=2\binom{n}{2}+2\binom{n}{2}+2n=2n^2$であるので,
$\Phi$はルート系である.
このルート系を$\Phi(B_{n})$とおく.
\begin{align*}
  \Braket{\alpha_{i,j},\alpha_{i,j}}&=2\\
  \Braket{\beta_{i,j},\beta_{i,j}}&=2\\
  \Braket{\varepsilon_{i},\varepsilon_{i}}&=1
\end{align*}
である.
$\alpha,\beta\in\Phi$に対して,
$2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}$の分母は2または1であるので, 整数である.
したがって,
$\Phi(B_{n})$は結晶的である.

$F_{k,l}=F_kF_lT_{k,l}$であるので,
$\Braket{R(\Phi)}_\ZZ=\Braket{R(\Phi_1\cup \check{\Phi})}_\ZZ$
である.
したがって,
\cref{ex:bn:grp}の鏡映群を$W$とすると,
$W(\Phi)=W$である.

\subsection{$C_{n}$}
\label{ex:cn:root}
$\Phi=\Phi(B_n)$は,
ルート系であった.
$\alpha\in \Phi$に対し,
$s_{\alpha}(\check\Phi)=\check\Phi$,
$s_{\alpha}(\hat\Phi)=\hat\Phi$であり,
$s_{\alpha}(\check\Phi)\cap\hat\Phi=\emptyset$,
$s_{\alpha}(\hat\Phi)\cap\check\Phi=\emptyset$である.
したがって, $\check\Phi$のみを定数倍しても,
再びルート系になる.
例えば, $\varepsilon'_k=2\varepsilon_k$とし
\begin{align*}
  \Phi'&=\Set{\varepsilon'_k,-\varepsilon'_k|1\leq k\leq n}\\
  \Phi_1&=\Set{\alpha_{i,j},-\alpha_{i,j}|1\leq i<j\leq n}\\
  \Phi_2&=\Set{\beta_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\\
  \Phi''&=\Phi_1\cup \Phi_2
\end{align*}
とし,
\begin{align*}
  \Phi(C_n)&=\Phi'\cup\Phi''
\end{align*}
とおいても, $\Phi(C_n)$はルート系である.
\begin{align*}
  \Braket{\varepsilon'_{i},\varepsilon'_{i}}&=4
\end{align*}
であるが, $\alpha\in\Phi$に対し,
\begin{align*}
  2\frac{\Braket{\varepsilon'_{i},\alpha}}{\Braket{\varepsilon'_{i},\varepsilon'_{i}}}=2\frac{\Braket{2\varepsilon_{i},\alpha}}{\Braket{\varepsilon'_{i},\varepsilon'_{i}}}
  =4\frac{\Braket{\varepsilon_{i},\alpha}}{\Braket{\varepsilon'_{i},\varepsilon'_{i}}}=\Braket{\varepsilon_{i},\alpha}
\end{align*}
である.  したがって,
$\alpha,\beta\in\Phi$に対して,
$2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}$は整数である.
したがって,
$\Phi(C_{n})$は結晶的である.
また,
$R(\Phi(C_n))=R(\Phi(B_n))$であるので,
$W(\Phi(C_n))=W(\Phi(B_n))$でる.


\subsection{$D_{n}$}
\label{ex:dn:root}
$1\leq i<j\leq n$に対し,
$\alpha_{i,j}=\ee_i-\ee_j$,
$\beta_{i,j}=\ee_i+\ee_j$,
\begin{align*}
  \Phi_1&=\Set{\alpha_{i,j},-\alpha_{i,j}|1\leq i<j\leq n}\\
  \Phi_2&=\Set{\beta_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\\
  \Phi&=\Phi_1\cup \Phi_2
\end{align*}
とする.
このとき,
$\alpha\in \Phi$に対して,
$s_\alpha(\Phi)=\Phi$となっていた.
また,
$\RR\alpha\cap\Phi=\Set{\alpha,-\alpha}$である.
$\numof{\Phi}=2n(n-1)$であるので,
$\Phi$はルート系である.
このルート系を$\Phi(D_{n})$とおく.
$\Braket{\alpha_{i,j},\alpha_{i,j}}=2$であることから,
$\Phi(D_{n})$は結晶的であることがわかる.

$R(\Phi)=\Set{T_{i,j},F_{i,j}|1\leq i< j\leq n}$
であるので,
\cref{ex:dn:grp}の鏡映群を$W$とすると,
$W(\Phi)=W$である.

\subsection{$G_2$}
\label{ex:g2:root}
$n=3$とする.
\begin{align*}
  \alpha_{i,j}&=\ee_i-\ee_j,\\
  \gamma_{i}&=-(\alpha_{i,1}+\alpha_{i,2}+\alpha_{i,3})
\end{align*}
とおき,
\begin{align*}
  \check\Phi&=\Set{\alpha_{i,j},-\alpha_{i.j}|1\leq i<j\leq 3},\\
  \hat\Phi&=\Set{\gamma_{i},-\gamma_{i}|1\leq i\leq 3},\\
  \Phi&=\check\Phi\cup\hat\Phi
\end{align*}
とする.

$\tau\in S_3$を$i$と$j$を入れ替える互換とすると,
\begin{align*}
  T_{i,j}\gamma_k=\gamma_{\tau(k)}
\end{align*}
である. したがって,
$T_{i,j}(\check\Phi)=\check\Phi$,
$T_{i,j}(\hat\Phi)=\hat\Phi$である.

$\Set{1,2,3}=\Set{i,j,k}$とする.
このとき,
\begin{align*}
  \gamma_{i}&=-(\alpha_{i,j}+\alpha_{i,k})=-2\ee_i+\ee_j+\ee_k\\
  \Braket{\gamma_{i},\alpha_{j,k}}
  &=\Braket{-2\ee_i+\ee_j+\ee_k,\ee_j-\ee_k}=0\\
  \Braket{\gamma_{i},\alpha_{i,j}}
  &=\Braket{-2\ee_i+\ee_j+\ee_k,\ee_i-\ee_j}=-3\\
  \Braket{\gamma_{i},\gamma_{j}}
  &=\Braket{\gamma_i,-\alpha_{j,i}-\alpha_{j,k}}=-3+0=-3\\
  \Braket{\gamma_{i},\gamma_{i}}
  &=\Braket{\gamma_i,-\alpha_{i,j}-\alpha_{i,k}}=3+3=6
\end{align*}
である. したがって,
\begin{align*}
  s_{\gamma_{i}}(\alpha_{j,k})&=\alpha_{j,k}-2\frac{0}{6}\gamma_i
  =\alpha_{j,k}\\
  s_{\gamma_{i}}(\alpha_{i,j})&=\alpha_{i,j}-2\frac{-3}{6}\gamma_i
  =\alpha_{i,j}-\alpha_{i,j}-\alpha_{i,k}=-\alpha_{i,k}\\
  s_{\gamma_{i}}(\gamma_{j})&=\gamma_{j}-2\frac{-3}{6}\gamma_i
  =\gamma_j+\gamma_i\\
  &=-2\ee_j+\ee_i+\ee_k-2\ee_i+\ee_j+\ee_k
  =2\ee_k-\ee_j-\ee_i=-\gamma_k
\end{align*}
である.
したがって,
$s_{\gamma_i}(\check\Phi)=\check\Phi$,
$s_{\gamma_i}(\hat\Phi)=\hat\Phi$である.
$\alpha\in\Phi$に対し, $\RR\alpha\cap\Phi=\Set{\alpha,-\alpha}$であり,
$\numof{\Phi}=12$であるので, $\Phi$はルート系である.
このルート系を$\Phi(G_2)$と書く.
$\Set{1,2,3}=\Set{i,j,k}$とすると,
\begin{align*}
  \Braket{\gamma_{i},\gamma_{i}}=\Braket{-2\ee_i+\ee_j+\ee_k,-2\ee_i+\ee_j+\ee_k}=4+1+1=6
\end{align*}
である.
\begin{align*}
  \Braket{\gamma_{i},\alpha_{i,j}}&=\Braket{-2\ee_i+\ee_j+\ee_k,\ee_i-\ee_j}=-2-1=-3\\
  \Braket{\gamma_{i},\alpha_{j,k}}&=\Braket{-2\ee_i+\ee_j+\ee_k,\ee_j-\ee_k}=1-1=0
\end{align*}
となるので,
$\alpha,\beta\in\Phi$に対して,
$2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}$は整数である.
したがって,
$\Phi(G_{2})$は結晶的である.

\sectionX{章末問題}
\begin{enumerate}
\item
  \Cref{ex:i2m:root}と同じ記号を用い,
  $\Phi=\Phi(I_2(m))$について考える.
  \begin{enumerate}
  \item $\Set{\alpha_0,\alpha_{m-1}}$は, $\RR^2$の基底であることを示せ.
  \item $c\alpha_0+c'\alpha_{m-1}\in \Phi$ならば, 次のいずれかが成り立つことを示せ:
    \begin{enumerate}
      \item $c>0$かつ$c'>0$; または
      \item $c<0$かつ$c'<0$.
    \end{enumerate}
  \item $\Set{c\alpha_0+c'\alpha_{m-1}\in \Phi|c>0,c'>0}$を求めよ.
  \item $\Set{c\alpha_0+c'\alpha_{m-1}\in \Phi|c<0,c'<0}$を求めよ.
  \end{enumerate}
\item
  \Cref{ex:an:root}と同じ記号を用い,
  $\Phi=\Phi(A_2)$について考える.
  \begin{enumerate}
  \item
    $\Set{\alpha_{1,2},\alpha_{2,3}}$は,
    $\Braket{\ee_1+\ee_2+\ee_3}_{\RR}^{\perp}$
    の空間の基底であることを示せ.
  \item
    $\Braket{\ee_1+\ee_2+\ee_3}_{\RR}^{\perp}=\Braket{\Phi}_\RR$
    であることを示せ.
  \item
    $c\alpha_{1,2}+c'\alpha_{2,3}\in \Phi$ならば, 次のいずれかが成り立つことを示せ:
    \begin{enumerate}
      \item $c>0$かつ$c'>0$; または
      \item $c<0$かつ$c'<0$.
    \end{enumerate}
  \item $\Set{c\alpha_{1,2}+c'\alpha_{2,3}\in \Phi|c>0,c'>0}$を求めよ.
  \item $\Set{c\alpha_{1,2}+c'\alpha_{2,3}\in \Phi|c<0,c'<0}$を求めよ.
  \end{enumerate}
\end{enumerate}


\chapter{単純系}
ここでは単純系と呼ばれるルート系の良い部分集合を定義する.

\section{単純系の定義}
\begin{definition}
  $\Phi$をルート系とし, $\Delta\subset\Phi$とする.
  このとき,
  \begin{align*}
    \Phi_{\Delta}^{+}&=\Phi\cap \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta \geq 0}\\
    \Phi_{\Delta}^{-}&=\Phi\cap \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta \leq 0}
  \end{align*}
  とする.
  以下の条件を満たすとき$\Delta$を$\Phi$の単純系と呼ぶ:
  \begin{enumerate}
%  \item $\Delta\subset\Phi$
  \item $\Delta$は一次独立. %$\Braket{\Phi}_{\RR}$の基底.
  \item $\Phi = \Phi_\Delta^{+}\cup \Phi_\Delta^{-}$.
  \end{enumerate}
  また, $\Delta$が単純系であるとき,
  $\Phi_{\Delta}^+$を$\Delta$に関するポジティブシステム,
  $\Phi_{\Delta}^-$を$\Delta$に関するネガティブシステムと呼ぶ.
  また,
  $\Delta$の元を単純ルート,
  $\Phi_{\Delta}^+$の元を$\Delta$に関する正ルート,
  $\Phi_{\Delta}^-$の元を$\Delta$に関する負ルートと呼ぶ.
\end{definition}
\begin{remark}
  単純ルートは正ルートである.
\end{remark}
\begin{remark}
  $\Phi = \Phi_\Delta^{+}\cup \Phi_\Delta^{-}$がなりたつなら, $\Phi$の元は$\Delta$の元の一次結合としてかけることがわかる.
  また, $\Delta\subset\Phi$であるから,
  $\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$である.
  $\Delta$は一次独立なので, $\Delta$は$\Braket{\Phi}_{\RR}$の基底である.
  とくに,
  $\alpha\in\Phi\subset \Braket{\Phi}_{\RR}$に対し,
  $\sum_{\delta\in\Delta}a_\delta \delta$
  と線型結合で表す方法は一意的である.
  したがって,
  $\Phi_{\Delta}^+\cap\Phi_{\Delta}^-=\emptyset$である.
\end{remark}
\begin{prop}
  \label{prop:posinega}
  $\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
  $\alpha\in\Phi_\Delta^+$ならば, $-\alpha\in\Phi_\Delta^-$である.
  $\alpha\in\Phi_\Delta^-$ならば, $-\alpha\in\Phi_\Delta^+$である.
\end{prop}
\begin{proof}
  $\alpha\in\Phi$とすると,
  $-\alpha\in\Phi$である.
  $\alpha=\sum_{\delta}c_\delta\delta$とかけるとすると,
  $-\alpha=\sum_{\delta}(-c_\delta)\delta$である.
  $c_\delta\geq 0$なら$-c_\delta\leq 0$であり,
  $c_\delta\leq 0$なら$-c_\delta\geq 0$である.  
\end{proof}
\begin{prop}
  \label{lemma:cone:sparable}
  $\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
  このとき,
  \begin{align*}
    \Phi_{\Delta}^+&=\Set{\alpha\in\Phi | \Braket{\alpha,\varpi} > 0}\\
    \Phi_{\Delta}^-&=\Set{\alpha\in\Phi | \Braket{\alpha,\varpi} < 0}
  \end{align*}
  をみたす$\varpi\in V$が存在する.
\end{prop}
\begin{proof}
  $\delta\in\Delta$とする.
  $F_\delta=\Braket{\Delta\setminus\Set{\delta}}_\RR$とする.
  $\Delta$は基底であり一次独立であるので,
  $\delta\not\in F_\delta$である.
  $V=F_\delta\oplus (F_\delta)^\perp$であるので,
  $\delta=\hat\delta+\check\delta$をみたす$\hat\delta\in F_\delta$と$\check\delta\in (F_\delta)^\perp$
  が存在する.
  $\delta\not\in F_\delta$であることから,
  $\check\delta \neq\zzero$である.
  このとき,
  \begin{align*}
    \Braket{\alpha,\check\delta}
    =
    \begin{cases}
      0 & (\alpha\in \Delta\setminus\Set{\delta})\\
      \Braket{\check\delta,\check\delta}>0 & (\alpha=\delta)
    \end{cases}
  \end{align*}
  である.
  \begin{align*}
    \varpi=\sum_{\delta\in\Delta}\check\delta
  \end{align*}
  とおくと, $\alpha\in\Delta$に対し,
  \begin{align*}
    \Braket{\alpha,\varpi}
    =\Braket{\alpha,\sum_{\delta\in\Delta}\check\delta}
    =\Braket{\check\alpha,\check\alpha}>0.
  \end{align*}
  したがって, $\alpha=\sum_{\delta\in \Delta}c_\delta \delta$
  に対し,
  \begin{align*}
    \Braket{\alpha,\varpi}=\sum_{\delta\in\Delta} c_\delta\Braket{\check\delta,\check\delta}
  \end{align*}
  であるから,
  $\alpha\in \Phi_\Delta^+$なら$\Braket{\alpha,\varpi}>0$であり,
  $\alpha\in \Phi_\Delta^-$なら$\Braket{\alpha,\varpi}<0$である.
\end{proof}
\begin{remark}
  ルート系$\Phi$の単純系$\Delta$に対し,
  \cref{lemma:cone:sparable}の証明中で構成した$\check\delta$を使うと,
  \begin{align*}
    \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta\geq 0}
    &= \bigcup_{\delta\in\Delta} \Set{\lambda\in \Braket{\Phi}_\RR |\Braket{\lambda,\check\delta} }\\
    \Set{\sum_{\delta\in\Delta}a_\delta \delta|a_\delta\geq 0}
    &\subset\bigcup_{\delta\in\Delta} \Set{\lambda\in V |\Braket{\lambda,\check\delta} }
  \end{align*}
  である.
\end{remark}
\begin{lemma}
  \label{lem:simplesumissimplesystem:}
  $\Phi$をルート系とする.
  $\Pi\subset \Phi$に対し,
  \begin{align*}
    X(\Pi)&= \Set{\sum_{\gamma\in\Pi}a_\gamma\gamma| a_\gamma\geq 0, \numof{\Set{\gamma|a_\gamma>0}}>1}\\
    \Delta(\Pi)&= \Pi \setminus X(\Pi)
  \end{align*}
  とおく.
  $\Delta\subset \Phi$が単純系ならば,
  \begin{align*}
    \Delta=\Delta(\Phi_\Delta^+).
  \end{align*}
\end{lemma}
\begin{proof}
  まず$\Delta(\Phi_\Delta^{+})\subset \Delta$を示す.
  $\alpha\in \Delta(\Phi_\Delta^{+})=\Phi_\Delta^{+}\setminus X(\Phi_\Delta^{+})$とする.
  $\alpha\in \Phi_\Delta^{+}$であるので,
  $a_\delta \geq 0$を使って,
  $\alpha=\sum_{\delta\in\Delta}a_\delta \delta$と表せる.
  $\alpha\not\in X(\Phi_\Delta^{+})$であるので,
  $a_\delta\neq 0$となる$\delta$は唯一つに定まる.
  $\alpha = a_\delta \delta$である.
  $\Phi$はルート系であることから,
  $ a_\delta\delta \in \RR \delta = \Set{\delta,-\delta}$
  であり, $\alpha=\delta\in \Delta$.
%%   そのために,
%%   \begin{align*}
%%     \alpha\in\Delta(\Phi_\Delta^{+})=\Phi_\Delta^+\setminus X(\Phi_\Delta^+)\implies \alpha \in\Delta
%%   \end{align*}
%%   の
%%   対偶を示す.
%%   $\alpha \in \Phi_\Delta^+\setminus\Delta$とする.
%%   $\alpha\in \Phi_\Delta^+$
%%   であるので,
%%   $a_\delta \geq 0$を使って,
%%   $\alpha=\sum_{\delta\in\Delta}a_\delta \delta$と表せる.
%%   もし, すべての$\delta\neq\delta_0$で$a_\delta=0$なら,
%%   $\alpha=a_{\delta_0} \delta_0$とかけるが,
%%   $\Phi$がルート系であるので, $a_{\delta_0}=1$であり,
%%   $\alpha=\delta_0\in\Delta$である.
%%   よって, $\numof{\Set{\delta|a_\delta>0}}>1$である.
%%   したがって, $\alpha\not\in \Delta(\Phi_\Delta^+)$
%%   である.


  次に, $\Delta\subset \Delta(\Phi_\Delta^{+})=\Phi_\Delta^+\setminus X(\Phi_\Delta^+)$を示す.
  $\alpha\in\Delta$とする.
  $\alpha\in\Delta \subset \Phi_\Delta^+$であるので,
  $\alpha\not\in X(\Phi_\Delta^+)$を示す.
  $\gamma\in\Phi_\Delta^+$は,
  $c_{\gamma,\delta}\geq 0$を使って,
  $\gamma=\sum_{\delta}c_{\gamma,\delta}\delta$とかけるとする.
  この記号の下,
  $a_\gamma\geq 0$をつかって,
  $\alpha=\sum_{\gamma\in\Phi_\Delta^+}a_\gamma\gamma$とかけているとすると,
  $\gamma\in \Phi_\Delta^+$であるので,
  \begin{align*}
    \alpha
    &=\sum_{\gamma\in\Phi_\Delta^+}\sum_{\delta\in\Delta}a_\gamma c_{\gamma,\delta}\delta\\
    &=\sum_{\delta\in\Delta}(\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\delta})\delta
  \end{align*}
  である. $\alpha\in\Delta$であったので,
  \begin{align*}
    \alpha
    &=
    (\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\alpha})\alpha
    +\sum_{\delta\in\Delta\setminus\Set{\alpha}}(\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\delta})\delta\\
    \zzero
    &=
    (-1+\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\alpha})\alpha
    +\sum_{\delta\in\Delta\setminus\Set{\alpha}}(\sum_{\gamma\in\Phi_\Delta^+}a_\gamma c_{\gamma,\delta})\delta
  \end{align*}
  である. 
  $\Delta$は$\Braket{\Phi}_\RR$の基底であるから,　
  \begin{align*}
    \sum_{i=1}^la_i c_{i,\delta}=
    \begin{cases}
      1 &  (\alpha=\delta)\\
      0 & (\alpha\neq\delta)
    \end{cases}
  \end{align*}
  である.
  $a_\gamma>0$とすると,
  $\alpha\neq\delta$に対して, $c_{\gamma,\delta}=0$.
  $\gamma=\sum_{\delta\in\Delta}c_{\gamma,\delta}\delta$と書けていたので,
  \begin{align*}
    \gamma=\sum_{\delta\in\Delta}c_{\gamma,\delta}\delta=c_{\gamma,\alpha}\alpha
  \end{align*}
  である.
  $\gamma\in\Phi_\Delta^+$であるので, ルート系の定義から,
  $c_{\gamma,\alpha}=1$, つまり, $\alpha=\gamma$がわかる.
  よって, $\Set{\gamma|a_\gamma>0}=\Set{\alpha}$であり,
  $\numof{\Set{\gamma|a_\gamma>0}}=1$である.

\end{proof}

\begin{theorem}
  $\Phi$をルート系とし,
  $\Delta,\Delta'\subset \Phi$を単純系とする.
  このとき, 次は同値:
  \begin{enumerate}
  \item $\Delta=\Delta'$.
  \item $\Phi_\Delta^+=\Phi_{\Delta'}^+$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  $\Delta=\Delta'$に対し
  $\Phi_\Delta^+=\Phi_{\Delta'}^+$となることは定義から明白である.

  $\Phi_\Delta^+=\Phi_{\Delta'}^+$とする.
  このとき,
  \cref{lem:simplesumissimplesystem:}から,
  $\Delta=\Delta(\Phi_\Delta^+)=\Delta(\Phi_{\Delta'}^+)=\Delta'$である.

\end{proof}

\section{単純系の存在}
$\Phi$をルート系とする.
$M(\Phi)=V \setminus (\bigcup_{\alpha\in\Phi}H_\alpha)$
とおくと,
$\Phi$は有限集合であるので$M(\Phi)\neq \emptyset$である.
$\varpi\in M(\Phi)$に対し,
\begin{align*}
  \Phi_{\varpi}^+&=\Set{\alpha\in\Phi|\Braket{\varpi,\alpha}>0}\\
  \Phi_{\varpi}^-&=\Set{\alpha\in\Phi|\Braket{\varpi,\alpha}<0}
\end{align*}
とおく.
$\varpi\in M(\Phi)$であるので$\Phi=\Phi_{\varpi}^+\cup \Phi_{\varpi}^-$
である.
$\Pi\subset \Phi_{\varpi}^+$に対し,
\begin{align*}
  \RR_{\geq 0}\Pi =
  \Set{\sum_{\delta\in\Pi}a_\delta \delta|a_\delta \geq 0}
\end{align*}
とおく.
\begin{align*}
  \SSS =
  \Set{\Pi\subset \Phi_{\varpi}^+|\Phi_{\varpi}^+\subset \RR_{\geq 0}\Pi}
\end{align*}
とおく.
$\Phi_{\varpi}^+\subset \RR_{\geq 0}\Phi_{\varpi}^+$であるで,
$\Phi_{\varpi}^+\in\SSS$
であり, $\SSS\neq\emptyset$である.
そこで, $r=\min\Set{\numof{\Pi}|\Pi\in\SSS}$
とし, $\Delta_{\varpi}\in\SSS$が$\numof{\Delta_{\varpi}}=r$をみたしているとする.
\begin{lemma}
  \label{lem:simple:posiindp}
  $\alpha\in \Delta_{\varpi}$とすると,
  $\alpha\not\in\RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\alpha})$.
\end{lemma}
\begin{proof}
  $\alpha\in \Delta_{\varpi}$かつ$\alpha\in\RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\alpha})$
  とすると, $\Delta_{\varpi}\setminus\Set{\alpha}\in\SSS$である.
\end{proof}

\begin{lemma}
  \label{lem:pidelta:innerprod}
  $\lambda,\mu\in\Delta_{\varpi}$かつ$\lambda\neq \mu$なら, $\Braket{\lambda,\mu}\leq 0$.
\end{lemma}
\begin{proof}
  $\lambda,\mu\in\Delta_{\varpi}$かつ
  $\Braket{\lambda,\mu}>0$とする.
  このとき,
  \begin{align*}
    c=2\frac{\Braket{\lambda,\mu}}{\Braket{\lambda,\lambda}}
  \end{align*}
  とすると,
  $c>0$である.
  また,
  $s_\lambda(\mu)=\mu-c\lambda$である.
  $s_\alpha(\Phi)=\Phi=\Phi_{\varpi}^+\cup\Phi_{\varpi}^-$である.

  まず, $s_\lambda(\mu)\in\Phi_{\varpi}^+$のときについて考える.
  $s_\lambda(\mu)=\sum_{\gamma\in\Delta_{\varpi}}c_\gamma\gamma$,
  $c_\gamma\geq 0$とする.
  \begin{align*}
    s_\lambda(\mu)=\mu-c\lambda
    =c_\mu\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align*}
  である.
  したがって,
  \begin{align}
    \label{lem:simple:innerprod:eq:1}
    \mu-c\lambda
    =c_\mu\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align}
  である.

  $c_\mu<1$のとき,
  \cref{lem:simple:innerprod:eq:1}を
  \begin{align*}
    \mu-c_\mu\mu
    &=c\lambda+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma\\
    (1-c_\mu)\mu
    &=c\lambda+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma\\
    \mu
    &=\frac{c}{(1-c_\mu)}\lambda+
    \sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}\frac{c_\gamma}{(1-c_\mu)}\gamma\\
  \end{align*}
  と変形する.
   $1-c_\mu>0$であるので, $\mu\in \RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\mu})$となる.
  これは\Cref{lem:simple:posiindp}に矛盾する.

  $c>1$のとき,
  \cref{lem:simple:innerprod:eq:1}を
  \begin{align*}
    \zzero
    &=c\lambda+(c_\mu -1)\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align*}
  と変形する.
  $\Delta_{\varpi}\subset\Phi_\varpi^+$であるので,
  \begin{align*}
    \Braket{c\lambda+(c_\mu -1)\mu+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma,\varpi} \geq
    \Braket{c\lambda,\varpi}=c\Braket{\lambda,\varpi}>0=\Braket{\zzero,\varpi}
  \end{align*}
  となり矛盾する.
  

  次に, $s_\lambda(\mu)\in\Phi_{\varpi}^-$のときについて考える.
  $-s_\lambda(\mu)\in\Phi_{\varpi}^+$
  である.
  $-s_\lambda(\mu)=\sum_{\gamma\in\Delta_{\varpi}}c_\gamma\gamma$,
  $c_\gamma\geq 0$とする.
  $s_\lambda(\mu)\in\Phi_{\varpi}^+$のときと同様の計算で,
  \begin{align}
    \label{lem:simple:innerprod:eq:2}
    c\lambda-\mu
    =c_\lambda\lambda+\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\lambda}}c_\gamma\gamma
  \end{align}
  がわかる.

  $c>c_\lambda$のとき,
  \cref{lem:simple:innerprod:eq:2}を
  \begin{align*}
    \lambda=
    &=\frac{1}{(c-c_\lambda)}\mu+
    \sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\lambda}}\frac{c_\gamma}{(c-c_\lambda)}\gamma\\
  \end{align*}
  と変形する.
  $\lambda\in \RR_{\geq 0}(\Delta_{\varpi}\setminus\Set{\lambda})$となり,
  \Cref{lem:simple:posiindp}に矛盾する.

  $c\leq c_\lambda$のとき,
  \cref{lem:simple:innerprod:eq:2}を
  \begin{align*}
    \zzero
    &=\mu+(c_\lambda-c)\lambda++\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma
  \end{align*}
  と変形する.
  \begin{align*}
    \Braket{\mu+(c_\lambda-c)\lambda++\sum_{\gamma\in\Delta_{\varpi}\setminus\Set{\mu}}c_\gamma\gamma,\varpi}
    \geq \Braket{\mu,\varpi}>0=
    \Braket{\zzero,\varpi}
  \end{align*}
  となり矛盾する.
\end{proof}


\begin{lemma}
  \label{lem:simple:linidep}
$\Delta_{\varpi}$は一次独立である.
\end{lemma}
\begin{proof}
  $\sum_{\delta\in\Delta_{\varpi}}a_\delta \delta = \zzero$
  とする.
  \begin{align*}
    \Pi^+&=\Set{\delta\in\Delta_{\varpi}|a_\delta >0}\\
    \Pi^-&=\Set{\delta\in\Delta_{\varpi}|a_\delta <0}
  \end{align*}
  とし$b_\lambda=-a_\lambda$とする.
  \begin{align*}
    v_+&=
    \begin{cases}
      \sum_{\delta\in\Delta_{\varpi}}a_\delta\delta&(\Pi^+\neq \emptyset)\\
      \zzero&(\Pi^+= \emptyset)
    \end{cases}\\
    v_-&=
    \begin{cases}
      \sum_{\delta\in\Delta_{\varpi}}a_\delta\delta&(\Pi^-\neq \emptyset)\\
      \zzero&(\Pi^-= \emptyset)
    \end{cases}
  \end{align*}
  とする. $v_+-v_-=\zzero$である.
  したがって$v_+=v_-$である.
\Cref{lem:pidelta:innerprod}より,
  \begin{align*}
    \Braket{v_+,v_-}&
    =\sum_{\mu\in\Pi^+}\sum_{\lambda\in\Pi^-}a_\mu b_\lambda \Braket{\mu,\lambda}
    \leq 0 
  \end{align*}
  となるが, $0\leq \Braket{v_+,v_+}=\Braket{v_+,v_-}\leq 0$であるので,
  $\Braket{v_+,v_+}=0$となる.  したがって$v_+=\zzero$.
  $v_-=v+=\zzero$であるので,
  すべての$\lambda$に対し,
  $a_\lambda=0$である.
\end{proof}



\begin{prop}
  $\Delta_{\varpi}$は$\Phi$の単純系であり,
  $\Phi^+_{\Delta_{\varpi}}=\Phi_{\varpi}^+$である.
\end{prop}
\begin{proof}
  定義から
  $\Phi_{\varpi}^+\subset \RR_{\geq 0}\Delta_{\varpi}$であり,
  $\Delta_{\varpi}\subset\Phi$である.
  したがって, $\Braket{\Delta_{\varpi}}_\RR=\Braket{\Phi^+}_\RR=\Braket{\Phi}_\RR$.
  \Cref{lem:simple:linidep}から, $\Delta_{\varpi}$は一次独立であるので,
  $\Delta_{\varpi}$は$\Braket{\Phi}_\RR$の基底である.

  また, $\Delta_{\varpi}\subset \Phi_{\varpi}^+$であるので,
  $\RR_{\geq 0}\Delta_{\varpi}\cap \Phi_{\varpi}^-=\emptyset$である.
  $\Phi=\Phi_{\varpi}^+\cup \Phi_{\varpi}^-$であるので,
  \begin{align*}
    \Phi_{\Delta_{\varpi}}^+=\Phi_{\varpi}^+\\
    \Phi_{\Delta_{\varpi}}^-=\Phi_{\varpi}^-
  \end{align*}
  である.
\end{proof}


\begin{cor}
  ルート系$\Phi$に対し, 単純系$\Delta$は存在する.
\end{cor}
\begin{proof}
  $\varpi\in M(\Phi)$とし, $\Delta_\varpi$とすればよい.
\end{proof}
\begin{remark}
  $\varpi\in M(\Phi)$のとり方に, $\Delta_\varpi$は依存する.
\end{remark}

\begin{theorem}
  $\Phi$をルート系とし,
  $\Delta$を単純系とする.
  $\lambda,\mu\in\Delta$かつ$\lambda\neq \mu$なら, $\Braket{\lambda,\mu}\leq 0$.
  
\end{theorem}
\begin{proof}
  \Cref{lemma:cone:sparable}より,
  $\Phi_\Delta^+=\Delta_\varpi^+$となる, $\varpi$がとれる.
  このとき, $\Delta=\Delta_\varpi$であるので,
  \Cref{lem:pidelta:innerprod}よりわかる.
\end{proof}



\begin{definition}
  $\Phi$をルート系とする.
  $\rank(\Phi)=\dim(\Braket{\Phi}_\RR)$
  と定義し, $\Phi$の階数と呼ぶ.
\end{definition}

\begin{remark}
  $\Delta$は
  $\Braket{\Phi}_\RR$の基底であったので,
  $\Delta$のとり方によらず,
  $\numof{\Delta}=\rank(\Phi)$.
\end{remark}

\section{例}

\subsection{$I_2(m)$}
\label{ex:i2m:simple}
$\Phi=\Phi(I_2(m))$とし,
\Cref{ex:i2m:root}と同じ記号を用いる.
$\Phi=\Set{\alpha_i|i\in\Set{0,\ldots,2m-1}}$であり, $\alpha_{i+m}=-\alpha_i$であった.
$\Delta=\Set{\alpha_0,\alpha_{m-1}}$とする.
このとき,
$\alpha_{0}=\alpha(0)$, $\alpha_{m-1}=\alpha\left(\frac{(m-1)\pi}{m}\right)$であったので,
$\Delta$は一次独立であり, $V=\Braket{\Phi}_\RR$の基底である.

\begin{align*}
  \eta_1&=\alpha\left(\frac{\pi}{2}\right),\\
  \eta_2&=\alpha\left(\frac{(m-1)\pi}{m}-\frac{\pi}{2}\right)
  =\alpha\left(\frac{-\pi}{m}+\frac{\pi}{2}\right)
\end{align*}
とおくことにする.
$\Braket{\alpha_0, \eta_1} = 0$であるので, $\RR\alpha_0=H_{\eta_1}$である.
また, 
$\Braket{\alpha_{m-1}, \eta_2} = 0$であるので, $\RR\alpha_0=H_{\eta_2}$である.
さらに,
\begin{align*}
 \Lambda_1&= \Set{\lambda\in V|\Braket{\lambda,\eta_1}\geq 0}\\
 \Lambda_2&= \Set{\lambda\in V|\Braket{\lambda,\eta_2}\geq 0}\\
 \Lambda&=\Lambda_1\cap \Lambda_2
\end{align*}
とおくと,
\begin{align*}
  \Set{a\alpha_0+b\alpha_{m-1}|a\geq 0,b\geq 0}=\Lambda
\end{align*}
である. また, $-\Lambda=\Set{-\lambda|\lambda\in\Lambda}$とすると
\begin{align*}
  \Set{a\alpha_0+b\alpha_{m-1}|a\leq 0,b\leq 0}=-\Lambda
\end{align*}
である.
\begin{align*}
  \Braket{\alpha_i,\eta_1}&=\Braket{\alpha\left(\frac{i\pi}{m}\right),\alpha\left(\frac{\pi}{2}\right)}\\
  &=\cos\left(\frac{i\pi}{m}-\frac{\pi}{2}\right)=\sin\left(\frac{i\pi}{m}\right)\\
\Braket{\alpha_i,\eta_2}&=\Braket{\alpha\left(\frac{i\pi}{m}\right),\alpha\left(\frac{-\pi}{m}+\frac{\pi}{2}\right)}\\
&=\cos\left(\frac{i\pi}{m}-\left(\frac{-\pi}{m}+\frac{\pi}{2}\right)\right)
=\cos\left(\frac{(1+i)\pi}{m}-\frac{\pi}{2}\right)
=\sin\left(\frac{(1+i)\pi}{m}\right)
\end{align*}
であるので,
\begin{align*}
\Set{\alpha_{i}|i\in\Set{0,1,\ldots,m-1}}\subset\Lambda\\
\Set{\alpha_{m+i}|i\in\Set{0,1,\ldots,m-1}}\subset\Lambda
\end{align*}
である.  したがって,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha_{i}|i\in\Set{0,1,\ldots,m-1}}\\
\Phi_\Delta^-&=\Set{\alpha_{m+i}|i\in\Set{0,1,\ldots,m-1}}
\end{align*}
であるので, $\Phi=\Phi_\Delta^+\cup\Phi_\Delta^-$である.
よって$\Delta$は$\Phi$の単純系である.
また,
$\varpi=\eta_1+\eta_2$とおけば,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.
\subsection{$A_{1}\times\cdots\times A_{1}$}
\label{ex:a1n:simple}
\cref{ex:a1n:root}で考えたルート系について考える.
つまり, $\varepsilon_i=\ee_i$とし,
$\Phi=\Set{\varepsilon_k,-\varepsilon_k|k\in\Set{1,\ldots,n}}$
とおく.
\begin{align*}
  \Delta=\Set{\varepsilon_1,\ldots,\varepsilon_n}
\end{align*}
とおくと, $\Delta$は$V$の標準基底である.
したがって, $\Braket{\Phi}_\RR$でもある.
あきらかに, $\Phi_\Delta^+=\Delta$であり,
$\Phi_\Delta^+=\Set{-\varepsilon_k|k\in\Set{1,\ldots,n}}$
である.  
$\Phi=\Phi_\Delta^+\cup\Phi_\Delta^-$であるので,
$\Delta$は$\Phi$の単純系である.
また, $\varpi=\ee_1+\cdots+\ee_n$とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.

\subsection{$A_{n-1}$}
\label{ex:an:simple}
$\Phi=\Phi(A_{n-1})$とし,
\cref{ex:an:root}の記号を用いる.
$\alpha_{i,j}=\ee_i-\ee_j$であり, $\Phi=\Set{\alpha_{i,j}, -\alpha_{i,j}|1\leq i<j\leq n}$である.
\begin{align*}
  \Delta=\Set{\alpha_{1,2},\alpha_{2,3},\ldots,\alpha_{n-1,n}}=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}
\end{align*}
とおく.
$k>0$に対し,
\begin{align*}
\alpha_{i,i+k}&=\alpha_{i,i+1}+\alpha_{i+1,i+2}+\cdots+\alpha_{i+k-1,i+k}
\end{align*}
であるので,
\begin{align*}
  \Set{\alpha_{i,j}|1\leq i<j\leq n}\subset \Phi_\Delta^+
\end{align*}
である.  したがって
\begin{align*}
  \Set{-\alpha_{i,j}|1\leq i<j\leq n}\subset \Phi_\Delta^-
\end{align*}
である.
$\Phi=\Phi_\Delta^+\cup \Phi_\Delta^-$であるので,
$\Phi\subset \Braket{\Delta}_\RR$である.
また,
\begin{align*}
  c_1\alpha_{1,2}+c_2\alpha_{2,3}+\cdots+c_{n-1}\alpha_{n-1,n}=\zzero
\end{align*}
とすると,
\begin{align*}
  &c_1\alpha_{1,2}+c_2\alpha_{2,3}+\cdots+c_{n-1}\alpha_{n-1,n}\\
  &=c_1(\ee_1-\ee_2)+c_2(\ee_2-\ee_3)+\cdots+c_{n-1}(\ee_{n-1}-\ee_n)\\
  &=c_1\ee_1+(c_2-c_1)\ee_2+(c_3-c_2)\ee_3+\cdots+(c_{n-1}-c_{n-2})\ee_{n-1}-c_{n-1}\ee_n
\end{align*}
であるので,
\begin{align*}
  \begin{cases}
    c_1=0 &\\
    -c_{n-1}=0 &\\
    c_i-c_{i-1}=0 &(i=2,3,\ldots,n-1)\\
  \end{cases}
\end{align*}
となる.
したがって全ての$i$に対し$c_i=0$である.
よって, $\Delta$は一次独立である.
したがって, $\Delta$は$\Braket{\Phi}_\RR$の基底である.
$\Delta$は$\Phi$の単純系である.
\begin{align*}
  \eta_{1,k}=\ee_1+\cdots+\ee_k
\end{align*}
とおと,
\begin{align*}
  \Braket{\eta_{1,k},\alpha_{j,j+1}}=
  \begin{cases}
    1 &(k=j)\\
    0 &(k\neq j)
  \end{cases}
\end{align*}
である.
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n-1}\\
  &=(n-1)\ee_1+(n-2)\ee_1+\cdots+\ee_{n-1}
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$B_{n}$}
\label{ex:bn:simple}
$\Phi=\Phi(B_n)$とし,
\cref{ex:bn:root}の記号を用いる.
$\alpha_{i,j}=\ee_i-\ee_j$,
$\beta_{i,j}=\ee_i+\ee_j$,
$\varepsilon_{k}=\ee_k$であった.
$\Set{\varepsilon_{1},\ldots,\varepsilon_n}$は$V$の標準基底であるので,
$V=\Braket{\Phi}_{\RR}$である.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}\cup \Set{\varepsilon_n}
\end{align*}
とおく.
このとき, $1\leq i<j\leq n$, $1\leq k<n$に対し,
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\varepsilon_{k}&=\alpha_{i,n}+\varepsilon_{n}\\
\beta_{i,j}&=\alpha_{i,j}+2\varepsilon_{j}
\end{align*}
とかけるので,
\begin{align*}
  \Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\cup \Set{\varepsilon_k | k\in\Set{1,\ldots,n}}\subset\Phi_\Delta^+
\end{align*}
である.
したがって,
\begin{align*}
  \Set{-\alpha_{i,j},-\beta_{i,j}|1\leq i<j\leq n}\cup \Set{-\varepsilon_k | k\in\Set{1,\ldots,n}}\subset\Phi_\Delta^-
\end{align*}
であるので, $\Phi=\Phi_\Delta^+\cup \Phi_\Delta^-$である.  したがって$\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$である.
また, $\numof{\Delta}=n=\dim(V)$であるので, $\Delta$は$V=\Braket{\Phi}_\RR$の基底である.

\Cref{ex:an:simple}と同様に,
\begin{align*}
  \eta_{1,k}=\ee_1+\cdots+\ee_k
\end{align*}
とおと,
\begin{align*}
  \Braket{\eta_{1,k},\varepsilon_{n}}=
  \begin{cases}
    1 &(k=n)\\
    0 &(k\neq n)
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n}\\
  &=n\ee_1+(n-1)\ee_1+\cdots+2\ee_{n-1}+\ee_{n}
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$C_{n}$}
\label{ex:cn:simple}
$\Phi=\Phi(C_n)$とし
\cref{ex:cn:root}の記号を用いる.
$\varepsilon'_k=2\varepsilon_k$である.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}\cup \Set{\varepsilon'_n}
\end{align*}
とおく.
このとき, $1\leq i<j\leq n$, $1\leq k <n$に対し,
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\beta_{k,n}&=\alpha_{k,n}+\varepsilon'_{n}\\
\beta_{i,j}&=\alpha_{i,n}+\beta_{j,n}\\
\varepsilon'_{k}&=\alpha_{i,n}+\beta_{i,n}
\end{align*}
とかけるので,
\begin{align*}
  \Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\cup \Set{\varepsilon'_k | k\in\Set{1,\ldots,n}}\subset\Phi_\Delta^+
\end{align*}
である. よって, $\Phi=\Phi_\Delta^+\cup \Phi_\Delta^-$であり, $V=\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$かつ$\numof{\Delta}=n$であるので,
$\Delta$は$\Phi$の単純系である.


\Cref{ex:bn:simple}と同様に,
\begin{align*}
  \eta_{1,k}=\ee_1+\cdots+\ee_k
\end{align*}
とおと,
\begin{align*}
  \Braket{\eta_{1,k},\varepsilon'_{n}}=
  \begin{cases}
    2 &(k=n)\\
    0 &(k\neq n)
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n}\\
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$D_{n}$}
\label{ex:dn:simple}
$\Phi=\Phi(D_n)$とし
\cref{ex:dn:root}の記号を用いる.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|i\in\Set{1,\ldots,n-1}}\cup \Set{\beta_{n-1,n}}
\end{align*}
とする.
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\beta_{j,n}&=\alpha_{k,n-1}+\beta_{n-1,n}\\
\beta_{i,j}&=\alpha_{i,n}+\beta{j,n}\\
\end{align*}
であるので, 
\begin{align*}
  \Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\subset\Phi_\Delta^+
\end{align*}
である. したがって,
\begin{align*}
  \Set{-\alpha_{i,j},-\beta_{i,j}|1\leq i<j\leq n}&\subset\Phi_\Delta^-\\
  \Phi&=\Phi_\Delta^+\cup\Phi_\Delta^-
\end{align*}
であるので,
$\Braket{\Delta}_\RR=\Braket{\Phi}_\RR=V$
である.
$\numof{\Delta}=n=\dim(V)$であるので, $\Delta$は$V=\Braket{\Phi}_\RR$の基底であり,
$\Delta$は$\Phi$の単純系である.


\begin{align*}
  \eta_{1,k}&=\ee_1+\cdots+\ee_k\\
  \eta'&=\eta_{1,n}\\
  \eta''&=\eta_{1,n-1}-\ee_n=\ee_1+\cdots+\ee_{n-1}-\ee_n
\end{align*}
とおと, $k<n-1$に対し,
\begin{align*}
  \Braket{\eta_{1,k},\beta_{n-1,n}}&=0\\
  \Braket{\eta',\beta_{n-1,n}}&=2\\
  \Braket{\eta'',\beta_{n-1,n}}&=0\\
  \Braket{\eta'',\alpha_{i,i+1}}&=
  \begin{cases}
    2 &(i=n-1)\\
    0 &(i\neq n-1)
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \varpi&=\eta_{1,1}+\cdots+\eta_{1,n-2}+\eta'+\eta''\\
  &=\eta_{1,1}+\cdots+\eta_{n}-\ee_n\\
  &=n\ee_1+(n-1)\ee_2+\cdots+2\ee_{n-1}
\end{align*}
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.


\subsection{$G_2$}
\label{ex:g2:simple}
$\Phi=\Phi(G_2)$とし,
\cref{ex:g2:root}の記号を用いる.
$n=3$であり,
\begin{align*}
  \alpha_{i,j}&=\ee_i-\ee_j,\\
  \gamma_{i}&=\alpha_{i,1}+\alpha_{i,2}+\alpha_{i,3}
\end{align*}
であった.
\begin{align*}
  \Delta=\Set{\alpha_{1,2},\gamma_{1}}
\end{align*}
とおく.
\begin{align*}
  \alpha_{1,2}&=\ee_1-\ee_2\\
  \gamma_{1}&=-2\ee_1+\ee_2+\ee_3\\
  \gamma_{1}+\alpha_{1,2}&=\alpha_{3,1}\\
  \gamma_{1}+2\alpha_{1,2}&=\alpha_{3,2}\\
  \gamma_{1}+3\alpha_{1,2}&=\alpha_{3,2}+\alpha_{1,2}=\gamma_{2}\\
  2\gamma_{1}+3\alpha_{1,2}&=\gamma_1+\gamma_{2}=-\gamma_3
\end{align*}
である.  したがって,
\begin{align*}
\Set{ \alpha_{1,2},\gamma_{1}, \alpha_{3,1},\alpha_{3,2},\gamma_{2},-\gamma_3}
&\subset
  \Phi_\Delta^+\\
\Set{ \alpha_{2,1},-\gamma_{1}, \alpha_{1,3},\alpha_{2,3},-\gamma_{2},\gamma_3}
&\subset
  \Phi_\Delta^-
\end{align*}
である.
したがって, $\Phi=\Phi_\Delta^+\cup\Phi_\Delta^-$
であり,
$\Braket{\Phi}_\RR=\Braket{\Delta}_\RR$である.
よって, 
\begin{align*}
\Set{ \alpha_{1,2},\gamma_{1}, \alpha_{3,1},\alpha_{3,2},\gamma_{2},-\gamma_3}
&=
  \Phi_\Delta^+\\
\Set{ \alpha_{2,1},-\gamma_{1}, \alpha_{1,3},\alpha_{2,3},-\gamma_{2},\gamma_3}
&=
  \Phi_\Delta^-
\end{align*}
である.
また, $\Delta$は一次独立であるから,
$\Delta$は$\Phi$の単純系である.
\begin{align*}
  \eta_1&=\ee_3\\
  \eta_2&=\ee_1+2\ee_3
\end{align*}
とおけば,
\begin{align*}
  \Braket{\eta_1,\alpha_{1,2}}&=0\\
  \Braket{\eta_2,\alpha_{1,2}}&=1\\
  \Braket{\eta_1,\gamma_{1}}&=1\\
  \Braket{\eta_2,\gamma_{1}}&=0\\
\end{align*}
であるので, $\varpi=\eta_1+\eta_2$
  とすると,
\begin{align*}
\Phi_\Delta^+&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\geq 0}\\
\Phi_\Delta^-&=\Set{\alpha\in\Phi|\Braket{\alpha,\varpi}\leq 0}
\end{align*}
である.

\sectionX{章末問題}
\begin{enumerate}
\item
  $\Phi=\Phi(I_2(3))$,
  $\Phi'=\Phi(A_2)$とする.
  このとき,
  次の条件をみたす$t\colon \RR^2\to \RR^3$を与えよ:
  \begin{enumerate}
    \item 任意の$\alpha,\beta\in \RR^2$に対し, $\Braket{\alpha,\beta}=\Braket{t(\alpha),t(\beta)}$.
    \item $\alpha\in\Phi$に対し, $ t(\sqrt{2}\alpha)\in \Phi'$.
  \end{enumerate}
\item $D_{2\cdot 3}$と$\Set{A_\sigma|\sigma\in S_3}$が同型であることを示せ.
\end{enumerate}

\chapter{同型なルート系}
ルート系が同型であることを定義し,
同型なルート系の例を挙げる.
\section{ルート系の同型}

\begin{definition}
  $\Phi$と$\Phi'$をルート系とする.
  このとき,
  以下を満たす$f$が存在するとき,
  $\Phi$と$\Phi'$は同型であるという:
  \begin{enumerate}
  \item $f$は$\Braket{\Phi}_\RR$から$\Braket{\Phi'}_\RR$への線型同型写像.
  \item $f(\Phi) = \Phi'$.
  \item すべての$\alpha, \beta\in \Phi$に対し,
    $2\frac{\Braket{\alpha,\beta}}{\Braket{\alpha,\alpha}}=2\frac{\Braket{f(\alpha),f(\beta)}}{\Braket{f(\alpha),f(\alpha)}}$.
  \end{enumerate}
\end{definition}

\begin{prop}
  $\Phi$と$\Psi$をルート系とし,
  $f$で同型が与えられているとする.
  $\Delta$を$\Phi$の単純系とすると,
  $f(\Delta)$は$\Psi$の単純系であり,
  $\Psi^{+}_{f(\Delta)}=f(\Phi^+_{\Delta})$,
  $\Psi^{-}_{f(\Delta)}=f(\Phi^-_{\Delta})$
  である.
\end{prop}
\begin{proof}
  $f$は$\Braket{\Phi}_\RR$から$\Braket{\Psi}_\RR$への線型同型写像であるので,
  $\Delta$が一次独立であることから,
  $f(\Delta)$は一次独立であることがわかる.
  また,
  $\alpha=\sum_{\delta\in\Delta}a_\delta \delta\in \Phi$とすると,
  $f(\alpha)=\sum_{\delta\in\Delta}a_\delta f(\delta)$である.
  したがって,
  \begin{align*}
    f(\Phi^+_{\Delta})
    &=\Set{\sum_{\delta\in\Delta}a_\delta f(\delta)|a_\delta\geq 0}\\
    &=\Set{\sum_{\delta\in f(\Delta)}a_{\delta} \delta|a_{\delta}\geq 0}\\
    f(\Phi^-_{\Delta})
    &=\Set{\sum_{\delta\in\Delta}a_\delta f(\delta)|a_\delta\leq 0}\\
    &=\Set{\sum_{\delta\in f(\Delta)}a_{\delta} \delta|a_{\delta}\leq 0}\\
    \Psi&=f(\Phi)=f(\Phi^+_{\Delta})\cup f(\Phi^-_{\Delta})
  \end{align*}
  となる.
  $f(\Delta)$は, $\Psi$の単純系であり,
  $\Psi^{+}_{f(\Delta)}=f(\Phi^+_{\Delta})$,
  $\Psi^{-}_{f(\Delta)}=f(\Phi^-_{\Delta})$
  である.
\end{proof}


以下で,
同型なルート系から決まる鏡映群は同型であることを示す.
\begin{lemma}
  \label{lem:esspart}
  $\Phi\subset V\setminus\Set{\zzero}$とする.
  $\alpha\in\Phi$に対し,
  $s_\alpha\restrictedto{\Braket{\Phi}_{\RR}}$は,
  $\alpha$に関する$U$上の鏡映である.
  また,
  $f\in W(\Phi)$に対し,
  $f\restrictedto{\Braket{\Phi}_{\RR}}$は,
  $\Braket{\Phi}_{\RR}$上の全単射である.
\end{lemma}
\begin{proof}
  $U=\Braket{\Phi}_\RR$とおくと,
  $V=U\oplus U^\perp$と(内部)直和分解できる.

  まずは, $\alpha\in\Phi$に対し,
  $s_\alpha\restrictedto{U}$が$U$上の全単射になることを示す.
  $\alpha\in \Phi$とすると,
  $\alpha\in U$であるから,
  $\RR\alpha\cap U^{\perp}$である.
  したがって,
  \begin{align*}
    V&=\RR\alpha\oplus(H_\alpha\cap U)\oplus U^\perp\\
    U&=\RR\alpha\oplus(H_\alpha\cap U)
  \end{align*}
  と(内部)直和分解できる.
  $\beta\in\RR\alpha$ に対し
  $s_\alpha(\beta)=-\beta\in \RR\alpha\subset U$であり,
  $\beta\in H_\alpha\cap U$ に対し
  $s_\alpha(\beta)=\beta\in H_\alpha\cap U\subset U$である.
  よって,
  \begin{align*}
    s_\alpha\restrictedto{U}\colon
    \Shazo{U}{U}
          {\beta}{s_\alpha(\beta)}
  \end{align*}
  は, $U$上の鏡映である.
  したがって, $U$上の全単射である.

  
  $f\in W(\Phi)$とすると,
  $\alpha_i\in \Phi$を使って
  $f=s_{\alpha_1}\cdots s_{\alpha_l}$とかける.
  $s_\alpha$を$U$に制限すると$U$上の全単射であるので,
  $f$も$U$に制限すると$U$
  上の全単射となる.
\end{proof}
\Cref{lem:esspart}より,
$\Set{w\restrictedto{\Braket{\Phi}_\RR}|w\in W(\Phi)}$
は鏡映群であることがわかる.
%\begin{lemma}

\begin{lemma}
  $\Phi\subset V\setminus\Set{\zzero}$とし,
  \begin{align*}
    W=\Set{w\restrictedto{\Braket{\Phi}_\RR}|w\in W(\Phi)}
  \end{align*}
  とおく.
  このとき
  $W(\Phi)$と$W$は群として同型である.
\end{lemma}
\begin{proof}
  %$W=\Set{w\restrictedto{\Braket{\Phi}_\RR}|w\in W(\Phi)}$とおく.
  $w\in W(\Phi)$に対し,
  $\varphi(w)=w\restrictedto{\Braket{\Phi}_\RR}$
  とおくと,
  $\varphi$は$W(\Phi)$から$W$への全射群準同型写像である.
  また,
  \Cref{lem:esspart:eq}
  より,
  $\varphi$は単射である.
  したがって,
  $W(\Phi)$と$W$は群として同型である.
\end{proof}


\begin{prop}
  $\Phi$と$\Phi'$をルート系とする.
  このとき, $\Phi$と$\Phi'$が同型なら,
  $W(\Phi)$と$W(\Phi')$は群として同型である.
\end{prop}
\begin{proof}
  \begin{align*}
  W&=\Set{w\restrictedto{\Braket{\Phi}_\RR}|w\in W(\Phi)},\\
  W'&=\Set{w\restrictedto{\Braket{\Phi'}_\RR}|w\in W(\Phi')}
  \end{align*}
  とおくと, $W$と$W(\Phi)$, $W'$と$W(\Phi')$はそれぞれ群として同型であるから,
  $W$と$W'$が同型であることを示す.

  $f\colon \Braket{\Phi}_\RR \to \Braket{\Phi'}_\RR$で
  $\Phi$と$\Phi'$の同型が与えられているとする.
  このとき,
  $f$は全単射であるので$f^{-1}$が存在する.
  $w\in W$に対し$\varphi(w)=f\circ w \circ f^{-1}$とおくと,
  $\Braket{\Phi'}_\RR$から
  $\Braket{\Phi'}_\RR$への線型写像である.
  また,
  $w,w'\in W$に対し,
  \begin{align*}
    \varphi(ww')&=f\circ ww' \circ f^{-1}\\
    \varphi(w)\varphi(w')&=(f\circ w\circ f^{-1})(f\circ w' \circ f^{-1})
    =f\circ ww' \circ f^{-1}
  \end{align*}
  となる.
  $\alpha\in \Phi$に対し, $s_\alpha$を考える.
  このとき, $\beta\in\Phi$に対し,
  \begin{align*}
    \varphi(s_{\alpha})(f(\beta))
    &=(f\circ s_\alpha \circ f^{-1})(f(\beta))\\
    &=f(s_\alpha  (f^{-1}(f(\beta)))\\
    &=f(s_\alpha(\beta))\\
    &=f(\beta - 2\frac{\Braket{\alpha,\beta}}{\alpha,\alpha}\alpha)\\
    &=f(\beta) - 2\frac{\Braket{\alpha,\beta}}{\alpha,\alpha}f(\alpha)\\
    s_{f(\alpha)}(f(\beta))
    &=f(\beta) - 2\frac{\Braket{f(\alpha),f(\beta)}}{f(\alpha),f(\alpha)}f(\alpha)\\
    &=f(\beta) - 2\frac{\Braket{\alpha,\beta}}{\alpha,\alpha}f(\alpha)
  \end{align*}
  である.
  $\Braket{f(\Phi)}_\RR=\Braket{\Phi'}_\RR$であることから,
  \begin{align*}
    \varphi(s_\alpha\restrictedto{\Braket{\Phi}_\RR})=s_{f(\alpha)}\restrictedto{\Braket{\Phi'}_\RR}\in W'
  \end{align*}
  であることがわかる.
  したがって,
  \begin{align*}
    \varphi\colon
    \Shazo{W}{W'}
          {w}{\varphi(w)}
  \end{align*}
  は準同型写像であることがわかる.
  また, 同様に
  \begin{align*}
    \psi\colon
    \Shazo{W'}{W}
          {w}{f^{-1}\circ w \circ f}
  \end{align*}
  という準同型写像が定義できるが,
  $\varphi$と$\psi$は互いに逆写像であるから,
  $W$と$W'$は群として同型である.
\end{proof}

\begin{remark}
  $\Phi$と$\Psi$が同型なルート系であるとき,
  $W(\Phi)$と$W(\Psi)$は群として同型である.
  しかし,
  $W(\Phi)$と$W(\Psi)$は群として同型であったとしても,
  $\Phi$と$\Psi$が同型なルート系であるとは限らない.
  例えば, $\bar\alpha=\frac{1}{\|\alpha\|}\alpha$とするとき,
  $\Set{\bar\alpha| \alpha\in \Phi}=\Set{\bar\alpha| \alpha\in \Psi}$
  であれば,
  $\Phi$と$\Psi$が同型でなくとも,
  $W(\Phi)$と$W(\Psi)$は群として同型となる.
\end{remark}

\section{例}
\subsection{$I_2(2)$, $A_1\times A_1$}
$\Phi=\Phi(I_2(2))$とする.
また,
$n=2$とし, 
\cref{ex:a1n:simple}で考えたルート系を
$\Phi'$とする.
$\alpha_0=\varepsilon_2$,
$\alpha_1=-\varepsilon_1$である.
また,
$\alpha_2=-\varepsilon_1$,
$\alpha_3=-\varepsilon_2$であるので,
$\Phi=\Psi$であるから, $W(\Phi)=W(\Phi')$である.

\subsection{$B_2$, $C_2$, $I_2(4)$}
$\Phi=\Phi(B_2)$とし,
$\Phi'=\Phi(C_2)$とする.
このとき,
$f(\alpha_{1,2})=\varepsilon'_2$,
$f(\varepsilon_2)=-\alpha_{1,2}$
で定義される$\Braket{\Phi}_\RR$から$\Braket{\Phi'}_\RR$への線型写像は
$\Phi$と$\Phi'$の同型を与える.
したがって
$W(\Phi)=W(\Phi')$である.

$\Psi=\Phi(I_2(4))$とする.
$\alpha\in \Psi$は
$\|\alpha\|=1$を満たすので,
\begin{align*}
  2\frac{\Braket{\alpha_i,\alpha_j}}{\Braket{\alpha_i,\alpha_i}}
= 2\frac{\Braket{\alpha_j,\alpha_i}}{\Braket{\alpha_j,\alpha_j}}
\end{align*}
である.
一方
$\alpha_{1,2},\varepsilon_2 \in \Phi$について考えると,
\begin{align*}
  2\frac{\Braket{\alpha_{1,2},\varepsilon_2}}{\Braket{\alpha_{1,2},\alpha_{1,2}}}
  &=-1\\
  2\frac{\Braket{\varepsilon_2,\alpha_{1,2}}}{\Braket{\varepsilon_2,\varepsilon_2}}
  &=-2
\end{align*}
であるので,
$\Phi$と$\Psi$は同型ではない.
しかし,
$\bar\alpha=\frac{1}{\|\alpha\|}\alpha$とすると,
$\Psi=\Set{\bar\alpha| \alpha\in \Phi}$
である.
したがって, $W(\Phi)$と$W(\Psi)$は同型である.

\subsection{$I_2(3)$, $A_2$}
$\Phi=\Phi(I_2(3))$とし,
$\Phi'=\Phi(A_2)$と$\Delta'$とする.
$f(\alpha_0)=\alpha_{1,2}$,
$f(\alpha_2)=\alpha_{2,3}$
で定義される$\Braket{\Phi}_\RR$から$\Braket{\Phi'}_\RR$への線型写像は
$\Phi$と$\Phi'$の同型を与える.
したがって
$W(\Phi)=W(\Phi')$である.


\subsection{$B_n$, $C_n$}
$\Phi=\Phi(B_n)$とし,
$\Psi=\Phi(C_n)$とする.
$n\geq 3$ならばこれらは同型ではない.
しかし,
$\bar\alpha=\frac{1}{\|\alpha\|}\alpha$とすると,
$\Set{\bar\alpha| \alpha\in \Phi}=\Set{\bar\alpha| \alpha\in \Psi}$
である.
したがって, $W(\Phi)$と$W(\Psi)$は同型である.


\subsection{$I_2(6)$, $G_2$}
$\nu_1=\ee_1$, $\nu_2=-\frac{3}{2}\ee_1+\frac{\sqrt{3}}{2}\ee_2$とし,
\begin{align*}
  \Phi^+
  &=
  \Set{\nu_1,\nu_2,\nu_2+\nu_1,\nu_2+2\nu_1,,\nu_2+3\nu_1,2\nu_2+3\nu_1}\\
  \Phi^-&=\Set{-\alpha|\alpha\in\Phi^+}\\
  \Phi&=\Phi^+\cup\Phi^-
\end{align*}
とする.
$\Phi'=\Phi(G_2)$とする.
$\Phi'$の元は, $\ee_1+\ee_2+\ee_3$と直交しており,
$\Braket{\Phi'}_\RR=H_{\ee_1+\ee_2+\ee_3}$である.
$f(\alpha_{1,2})=\nu_1$,
$f(\gamma_{1})=\nu_2$で定義される,
$\Braket{\Phi'}_\RR$から
$\Braket{\Phi}_\RR$への線型写像を考える.
直接計算することで,
$f$が$\Phi'$と$\Phi$の同型を与えることが確かめられる.
したがって, $W(\Phi)$と$W(\Phi')$は同型である.
また, $\Delta=\Set{\nu_1,\nu_2}$とおくと,
これは$\Phi$の単純系である.

また
$\Psi=\Phi(I_2(3))$とする.
$\alpha\in \Psi$は
$\|\alpha\|=1$を満たすので,
\begin{align*}
  2\frac{\Braket{\alpha_i,\alpha_j}}{\Braket{\alpha_i,\alpha_i}}
= 2\frac{\Braket{\alpha_j,\alpha_i}}{\Braket{\alpha_j,\alpha_j}}
\end{align*}
である.
一方,
$\nu_{1},\nu_{2} \in \Phi$について考えると,
\begin{align*}
  2\frac{\Braket{\nu_{1},\nu_2}}{\Braket{\nu_{1},\nu_{1}}}
  &=-3\\
  2\frac{\Braket{\nu_{2},\nu_1}}{\Braket{\nu_{2},\nu_{2}}}
  &=-1
\end{align*}
であるので,
$\Phi$と$\Psi$は同型ではない.
しかし,
$\bar\alpha=\frac{1}{\|\alpha\|}\alpha$とすると,
$\Psi=\Set{\bar\alpha| \alpha\in \Phi}$
である.
したがって, $W(\Phi)$と$W(\Psi)$は同型である.


\sectionX{章末問題}
\begin{enumerate}
\item
  $m$を整数とし,
  \Cref{ex:i2m:simple}と同じ記号を用いる.
  $\Phi^+=\Set{\alpha_i|i\in\Set{0,\ldots,m-1}}$とする.
  整数$i$に対し次を求めよ:
  \begin{enumerate}
  \item $\Set{\alpha\in \Phi^+| P_i\alpha\not\in \Phi^+}$.
  \item $\Set{\alpha\in \Phi^+| R_i\alpha\not\in \Phi^+}$.
  \end{enumerate}
\item
  $\Phi^+=\Set{\ee_1-\ee_2,\ee_2-\ee_3,\ee_1-\ee_3}$
  とする.
  各
  $\sigma\in S_3$
  に対し,
  $\Set{\alpha\in \Phi^+|A_\sigma \alpha \not\in \Phi^{+}}$を求めよ.
\end{enumerate}


\chapter{転倒数}
対称群$S_n$の元$\sigma$に対し,
$\numof{\Set{(i,j)|i<j, \sigma(i)>\sigma(j)}}$
は$\sigma$の転倒数と呼ばれ,
$\sigma$の符号を求める際などに使われていた.
対称群$S_n$は$W(\Phi(A_{n-1}))$と群として同型であったので,
$W(\Phi(A_{n-1}))$の元に転倒数が定義されていると思うこともできる.
ここでは,
転倒数を一般の有限鏡映群にも定義することを目標とする.


\section{転倒数}
ここでは特に断らない限り,
$\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
また, $W=W(\Phi)$とする.
%また, $\Phi^+=\Phi_\Delta^+$とする.

\begin{definition}
  $w\in W$に対して,
  \begin{align*}
    \Phi_\Delta^{+}(w)
    &=\Set{\alpha\in\Phi_\Delta^+|w(\alpha)\in \Phi_\Delta^-}
  \end{align*}
  と定義し,
  \begin{align*}
    n_{\Phi_\Delta^+}(w)&=\numof{\Phi_\Delta^{+}(w)}
  \end{align*}
  とおく.
\end{definition}
以下では, 特にことわりのない限り, $n(w)=n_{\Phi_\Delta^+}(w)$とする.
\begin{remark}
  $w\in W$と$X\subset \Phi$に対し,
  $w(X)=\Set{w(\alpha)|\alpha\in X}$とおく.
  このとき, 
  \begin{align*}
    w^{-1}(\Phi_\Delta^-)&=\Set{w^{-1}(\beta)|\beta\in\Phi_\Delta^-}\\
    &=\Set{\alpha|\alpha=w^{-1}(\beta),\beta\in\Phi_\Delta^-}\\
    &=\Set{\alpha|w(\alpha)\in\Phi_\Delta^-}
  \end{align*}
  であるので,
  \begin{align*}
    \Phi_\Delta^{+}(w)
    &=\Set{\alpha\in\Phi_\Delta^+|w(\alpha)\in \Phi_\Delta^-}\\
    &=\Phi_\Delta^+\cap w^{-1}(\Phi_\Delta^{-})
  \end{align*}
  とかける.
\end{remark}
\begin{prop}
  \label{prop:simple:reflect:positive2positive}
  $\alpha\in\Delta$, $\beta\in \Phi_\Delta^+$とする.
  $\alpha\neq\beta$ならば,
  $s_\alpha(\beta)\in \Phi_\Delta^+$かつ
  $s_\alpha(\beta)\neq \alpha$である.
\end{prop}
\begin{proof}
$\beta=\sum_{\delta\in\Delta}c_\delta\delta \in \Phi_\Delta^+\setminus \Set{\alpha}$
とする. $c_\delta\geq 0$である.
$\beta=c_\alpha\alpha$とかけたとすると,
 $\Phi$はルート系であるので,
$\Phi\cap\RR\alpha=\Set{\alpha,-\alpha}$であるから,
$c_\alpha\in\Set{1,-1}$である.
$\beta$は仮定より$\alpha$ではなく,
また $-\alpha\in \Phi_\Delta^-$でもない.
したがって,
$c_{\delta}> 0$をみたす
$\delta\in\Delta\setminus\Set{\alpha}$が存在する.
$\gamma\in\Delta\setminus\Set{\alpha}$が
$c_{\gamma}> 0$をみたすとする.

ルート系の定義より,
$s_\alpha(\Phi)=\Phi$であるので,
$s_\alpha(\beta)\in \Phi$.
$c=2\frac{\Braket{\beta,\alpha}}{\Braket{\alpha,\alpha}}$
とすると,
\begin{align*}
  s_\alpha(\beta)&=\beta-c\alpha\\
  &=c_{\gamma}\gamma +(c_\alpha-c)\alpha + \sum_{\delta\in\Delta\setminus\Set{\gamma,\alpha}}c_\delta\delta.
\end{align*}
$c_\gamma>0$であることから$s_\alpha(\beta)\in\Phi_\Delta^+$であることがわかる.
また$s_\alpha(\beta)=\alpha$とすると,
$\beta=s_\alpha(\alpha)=-\alpha$であり,
$\beta\in\Phi_\Delta^-$となるので$\beta\in\Phi_\Delta^+$に矛盾する.
\end{proof}
\Cref{prop:simple:reflect:positive2positive}から,
$\delta\in\Delta$に対し,
$s_\delta$で負ルートになる正ルートは$\delta$のみであることがわかる.
\begin{cor}
  $\delta\in\Delta$に対し,
  $s_\delta(\Phi_\Delta^+\setminus\Set{\delta})=\Phi_\Delta^+\setminus\Set{\delta}$.
\end{cor}
\begin{proof}
$s_\delta(\Phi_\Delta^+\setminus\Set{\delta})\subset\Phi_\Delta^+\setminus\Set{\delta}$
は\cref{prop:simple:reflect:positive2positive}からわかる.

$s_\delta(\Phi_\Delta^+\setminus\Set{\delta})\supset\Phi_\Delta^+\setminus\Set{\delta}$
を示す.
$\beta\in\Phi_\Delta^+\setminus\Set{\delta}$
とする.
$\gamma=s_\delta(\beta)$とおくと,
\cref{prop:simple:reflect:positive2positive}から,
$\gamma\in \Phi_\Delta^+\setminus\Set{\delta}$である.
$s_\delta s_\delta=\id_V$であるから,
$\beta=s_\delta(s_\delta(\beta))=s_\delta(\gamma)$
と
かけるので, $\beta\in s_\delta(\Phi_\Delta^+\setminus\Set{\delta})$.
\end{proof}
\begin{cor}
  \label{thm:simple:action:x}
  $\delta\in\Delta$とする.
  $s_\delta(\alpha)\in\Phi_\Delta^+$かつ$\alpha\in\Phi_\Delta^-$ならば
  $\delta=-\alpha$である.
\end{cor}
$\Phi_\Delta^{+}(\delta)=\Phi_\Delta^+\cap (s_\delta)^{-1}(\Phi_\Delta^-)$
であるので次のようにも言い換えられる.
\begin{cor}
  $\delta\in\Delta$に対し,
  $\Phi_\Delta^{+}(s_\delta)=\Set{\delta}$.
  特に,
  $n(\delta)=1$.
\end{cor}

$\delta\in\Delta$に対して
$w=s_\delta$となっている場合について $\Phi_\Delta^+(w)$をしらべた.
次に, 一般の$w\in W$に対して,
$\Phi_\Delta^+(w)$を調べる.

\begin{prop}
  \label{prop:n:inverse:same}
  $w\in W$に対し,
  $n(w)=n(w^{-1})$である.
\end{prop}
\begin{proof}
  \begin{align*}
    \Phi_\Delta^+\cap w(\Phi_\Delta^{-})=w(w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-})
  \end{align*}
  である. また, $w$は全単射であるので,
  \begin{align*}
    \numof{w(w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-})}
    &=\numof{w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-}}.
  \end{align*}
  また, $-1$倍する操作も全単射であるから,
  \begin{align*}
    \numof{w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-}}
    &=\numof{-(w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-})}.
  \end{align*}
  $w^{-1}$は線形写像なので,
  \begin{align*}
    -(w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-})
    &= w^{-1}(\Phi_\Delta^-)\cap \Phi_\Delta^{+}.
  \end{align*}
  したがって,
  \begin{align*}
    n(w^{-1})
    &=\numof{\Phi_\Delta^+\cap w(\Phi_\Delta^{-})}\\
    &=\numof{w(w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-})}\\
    &=\numof{w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-}}\\
    &=\numof{-(w^{-1}(\Phi_\Delta^+)\cap \Phi_\Delta^{-})}\\
    &=\numof{w^{-1}(\Phi_\Delta^-)\cap \Phi_\Delta^{+}}\\
    &=n(w).
  \end{align*}
\end{proof}

\begin{lemma}
  \label{lem:n:bruhat}
  $\delta\in\Delta$, $w\in W$とする.
  このとき次が成り立つ:
  \begin{enumerate}
  \item
    \label{item:buruhat:formula:1}
    $w(\delta)\in\Phi_\Delta^+ \iff n(ws_\delta)=n(w)+1$.
  \item
    \label{item:buruhat:formula:-1}
     $w(\delta)\in\Phi_\Delta^- \iff n(ws_\delta)=n(w)-1$.
  \item
    \label{item:buruhat:formula:r:1}
    $w^{-1}(\delta)\in\Phi_\Delta^+ \iff n(s_\delta w)=n(w)+1$.
  \item
    \label{item:buruhat:formula:r:-1}
    $w^{-1}(\delta)\in\Phi_\Delta^- \iff n(s_\delta w)=n(w)-1$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  \begin{align*}
    \Phi_\Delta^{+}(ws_\delta)
    &=\Phi_\Delta^+\cap(ws_\delta)^{-1}(\Phi_\Delta^-)\\
    &=\Phi_\Delta^+\cap(s_\delta)^{-1} w^{-1}(\Phi_\Delta^-)\\
    &=\Phi_\Delta^+\cap s_\delta w^{-1}(\Phi_\Delta^-).
  \end{align*}
  ここで$\delta\in\Delta$に対し,
  \begin{align*}
    \Phi_\Delta^+&=s_\delta(\Phi_\Delta^+\setminus \Set{\delta}) \cup\Set{\delta}\\
    s_\delta(\Phi_\Delta^+\setminus \Set{\delta})\cap \Set{\delta}&=\emptyset
  \end{align*}
  であるので, $\Phi_\Delta^+\cap s_\delta w^{-1}(\Phi_\Delta^-)$を調べるには,
  \begin{align*}
    s_\delta(\Phi_\Delta^+\setminus \Set{\delta}) \cap s_\delta w^{-1}(\Phi_\Delta^-)\\
    \Set{\delta} \cap s_\delta w^{-1}(\Phi_\Delta^-)
  \end{align*}
  をそれぞれ調べればよい.

  まず,
  \begin{align*}
    w(\delta)\in\Phi_\Delta^+ \implies n(ws_\delta)=n(w)+1
  \end{align*}
  について考える.
  $w(\delta)=\alpha$とおく.
  仮定から$w(\delta)\in\Phi_\Delta^+$であるので,
  $\alpha\in\Phi_\Delta^+$であり,
  $-\alpha\in\Phi_\Delta^-$である.
  
  $\delta=w^{-1}(\alpha)$であるので,
  \begin{align*}
    \delta
    &=s_\delta s_\delta(\delta)\\
    &=s_\delta (-\delta)\\
    &=s_\delta(- w^{-1}(\alpha))\\
    &=s_\delta(w^{-1}(-\alpha))
  \end{align*}
  となる. したがって,
  $\delta\in s_\delta(w^{-1}(\Phi_\Delta^-))$である.
  したがって,
  \begin{align*}
    \Set{\delta} \cap s_\delta w^{-1}(\Phi_\Delta^-) = \Set{\delta}
  \end{align*}
  である.
  

  一方
  \begin{align*}
    s_\delta(\Phi_\Delta^+\setminus \Set{\delta})=s_\delta(\Phi_\Delta^+)\setminus\Set{-\delta}
  \end{align*}
  である.
  $\delta=s_\delta(w^{-1}(-\alpha))$であるので,
  $-\delta=s_\delta(w^{-1}(\alpha))$となり,  
  $-\delta\in s_\delta(w^{-1}(\Phi_\Delta^+))$であるから,
  $-\delta\not\in s_\delta(w^{-1}(\Phi_\Delta^-))$である.
  したがって,
  \begin{align*}
    s_\delta(\Phi_\Delta^+\setminus \Set{\delta}) \cap s_\delta w^{-1}(\Phi_\Delta^-)
    &=
    s_\delta(\Phi_\Delta^+) \cap s_\delta w^{-1}(\Phi_\Delta^-)\\
    &=s_\delta(\Phi_\Delta^+ \cap w^{-1}(\Phi_\Delta^-))\\
    &=s_\delta(\Phi_\Delta^+(w))
  \end{align*}
  である. 
  $\delta\not\in s_\delta(\Phi_\Delta^+\setminus \Set{\delta})$
  であるので, $\delta\not\in s_\delta(\Phi_\Delta^+(w))$
  である.

  したがって,
  \begin{align*}
    n(ws_\delta)
    &=\numof{\Phi_\Delta^+(ws_\delta)}\\
    &=\numof{s_\delta(\Phi_\Delta^+(w))}+1\\
    &=\numof{\Phi_\Delta^+(w)}+1\\
    &=n(w)+1
  \end{align*}
  である.
  
  次に,
  \begin{align*}
    w(\delta)\in\Phi_\Delta^- \implies n(ws_\delta)=n(w)-1
  \end{align*}
  について考える.
  $w(\delta)=\alpha$とおく.
  仮定から$w(\delta)\in\Phi_\Delta^-$であるので,
  $\alpha\in\Phi_\Delta^-$であり,
  $-\alpha\in\Phi_\Delta^+$である.
    
  $\delta=w^{-1}(\alpha)$であるので,
  \begin{align*}
    \delta
    &=s_\delta s_\delta(\delta)\\
    &=s_\delta (-\delta)\\
    &=s_\delta(- w^{-1}(\alpha))\\
    &=s_\delta(w^{-1}(-\alpha)).
  \end{align*}
  となる. したがって,
  $\delta\in s_\delta(w^{-1}(\Phi_\Delta^+))$である.
  したがって,
  $\delta\not\in s_\delta(w^{-1}(\Phi_\Delta^-))$であるので,
  \begin{align*}
    \Set{\delta} \cap s_\delta w^{-1}(\Phi_\Delta^-) = \emptyset
  \end{align*}
  である.
  

  一方
  \begin{align*}
    s_\delta(\Phi_\Delta^+\setminus \Set{\delta})=s_\delta(\Phi_\Delta^+)\setminus\Set{-\delta}
  \end{align*}
  である.
  $\delta\in s_\delta(w^{-1}(\Phi_\Delta^+))$であるので,
  $-\delta\in s_\delta(w^{-1}(\Phi_\Delta^-))$である.
  したがって,
  \begin{align*}
    s_\delta(\Phi_\Delta^+\setminus \Set{\delta}) \cap s_\delta w^{-1}(\Phi_\Delta^-)
    &=
    (s_\delta(\Phi_\Delta^+) \cap s_\delta w^{-1}(\Phi_\Delta^-))\setminus\Set{-\delta}\\
    &=s_\delta(\Phi_\Delta^+ \cap w^{-1}(\Phi_\Delta^-))\setminus\Set{-\delta}\\
    &=s_\delta(\Phi_\Delta^+(w))\setminus\Set{-\delta}
  \end{align*}
  である. 

  したがって,
  \begin{align*}
    n(ws_\delta)
    &=\numof{\Phi_\Delta^+(ws_\delta)}\\
    &=\numof{s_\delta(\Phi_\Delta^+(w))}-1\\
    &=\numof{\Phi_\Delta^+(w)}-1\\
    &=n(w)-1
  \end{align*}
  である.

  $w(\delta)$に対し,
  $w(\delta)\in\Phi_\Delta^+$または
  $w(\delta)\in\Phi_\Delta^-$のいずれか一つのみが成り立つので,  
  \cref{item:buruhat:formula:1,item:buruhat:formula:-1}
  が成り立つ.
  
  \Cref{item:buruhat:formula:r:1,item:buruhat:formula:r:-1}
  について考える.
  \Cref{prop:n:inverse:same}より,
  \begin{align*}
    n(w^{-1}s_\delta)&=n((w^{-1}s_\delta)^{-1})\\
    &=n((s_\delta)^{-1}(w^{-1})^{-1})\\
    &=n(s_\delta w)
  \end{align*}
  である.
  したがって,
  \Cref{item:buruhat:formula:1,item:buruhat:formula:-1}
  から,
  \Cref{item:buruhat:formula:r:1,item:buruhat:formula:r:-1}
  が得られる.
\end{proof}

\section{作用の例}

\subsection{$I_2(m)$}
\label{ex:i2m:inversion}


$\Phi=\Phi(I_2(m))$とし,
\cref{ex:i2m:simple}で考えた単純系$\Delta$を考える.
$\Delta=\Set{\alpha_0,\alpha_{m-1}}$,
$\Phi_\Delta^+=\Set{\alpha_i|i\in\Set{0,\ldots,m-1}}$,
$\Phi_\Delta^-=\Set{\alpha_{m+i}|i\in\Set{0,\ldots,m-1}}$であった.
また, $P_i=s_{\alpha_{i}}$であるが,
\begin{align*}
P_0\alpha_i&=\alpha_{m-i},\\
P_{m-1}\alpha_i&=\alpha_{m-2-i}
\end{align*}
である.
したがって,
$0<i<m$に対して,
$P_0(\alpha_i)\in\Phi_\Delta^+$である.
また, $-1<i<m-1$に対して,
$P_{m-1}(\alpha_i)\in\Phi_\Delta^+$である.

$n(w)=n_{\Phi_\Delta^+}(w)$について考える.
まず, $n(R_k)$について考える.
\begin{align*}
  R_k\alpha_i=\alpha_{i+2k}
\end{align*}
であるので
\begin{align*}
\Set{R_k\alpha_i|0\leq i < m}=\Set{\alpha_{i+2k}|0\leq i < m}=\Set{\alpha_{j}|2k \leq j < m+2k}
\end{align*}
となる.
$0\leq k <\frac{m}{2}$のとき, $0\leq 2k<m+2k<2m$であるので,
\begin{align*}
  \Set{R_k\alpha_i|0\leq i < m}\cap \Phi_\Delta^-=\Set{\alpha_m,\alpha_{m+1},\ldots,\alpha_{m-1+2k}}
\end{align*}
であるから,
\begin{align*}
  \Phi_\Delta^+(R_k)=\Set{\alpha_{m-2k},\alpha_{m-2k+1},\ldots,\alpha_{m-1}}
\end{align*}
である.
一方,
$\frac{m}{2}\leq k <m$のとき, $m\leq 2k<m+2k<3m$であるので,
\begin{align*}
  \Set{R_k\alpha_i|0\leq i < m}\cap \Phi_\Delta^-=\Set{\alpha_{2k},\alpha_{2k+1},\ldots,\alpha_{2m-1}}
\end{align*}
であるから,
\begin{align*}
  \Phi_\Delta^+(R_k)=\Set{\alpha_{0},\alpha_{1},\ldots,\alpha_{2m-1-2k}}
\end{align*}
である.
したがって, $0\leq k <\frac{m}{2}$に対し,
\begin{align*}
  n(R_{k})=n(R_{m-k})=2k 
\end{align*}
である.


また, $n(P_k)$については,
\begin{align*}
  P_k\alpha_i=\alpha_{m+2k-i}
\end{align*}
であるので
\begin{align*}
\Set{P_k\alpha_i|0\leq i < m}=\Set{\alpha_{m+2k-i}|0\leq i < m}=\Set{\alpha_{j}|2k <j\leq m+2k}
\end{align*}
となる.
$0\leq k <\frac{m}{2}$のとき, $0\leq 2k<m+2k<2m$であるので,
\begin{align*}
  \Set{P_k\alpha_i|0\leq i < m}\cap \Phi_\Delta^-=\Set{\alpha_{m},\alpha_{m+1},\ldots,\alpha_{m+2k}}
\end{align*}
であるから,
\begin{align*}
  \Phi_\Delta^+(P_k)=\Set{\alpha_{0},\alpha_{1},\ldots,\alpha_{2k}}
\end{align*}
である.
一方,
$\frac{m}{2}\leq k <m$のとき, $m\leq 2k<m+2k<3m$であるので,
\begin{align*}
  \Set{P_k\alpha_i|0\leq i < m}\cap \Phi_\Delta^-=\Set{\alpha_{2k+1},\alpha_{2k+2},\ldots,\alpha_{2m-1}}
\end{align*}
であるから,
\begin{align*}
  \Phi_\Delta^+(P_k)=\Set{\alpha_{2k-m+1},\alpha_{2k-m+2},\ldots,\alpha_{m-1}}
\end{align*}
である. 
したがって, $0\leq k <\frac{m}{2}$に対し,
\begin{align*}
 n(P_{k})=n(P_{m-1-k})=2k+1
\end{align*}
である.




\subsection{$A_{1}\times\cdots\times A_{1}$}
\label{ex:a1n:inversion}
\cref{ex:a1n:simple}で考えたルート系$\Phi$と単純系$\Delta$について考える.
\begin{align*}
  F_i\varepsilon_j=
  \begin{cases}
    -\varepsilon_j &(i=j)\\
    \varepsilon_j &(i\neq j)
  \end{cases}
\end{align*}
であるので,
$i\neq j$に対し,
$s_{\varepsilon_i}(\varepsilon_j)\in\Phi_\Delta^+$
となることは明らかである.
また, $\diag(a_1,\ldots,a_n)\in W(\Phi)$に対し,
\begin{align*}
  \Phi_\Delta^+(\diag(a_1,\ldots,a_n))&=\Set{\varepsilon_i|a_i=-1}\\
  n_{\Phi_\Delta^+}(\diag(a_1,\ldots,a_n))&=\numof{\Set{i|a_i=-1}}
\end{align*}
である.

\subsection{$A_{n-1}$}
\label{ex:an:inversion}
$\Phi=\Phi(A_{n-1})$とし,
\cref{ex:an:simple}の単純系$\Delta$を用いる.
\begin{align*}
  \Delta&=\Set{\alpha_{i,i+1}|1\leq i < n}\\
  \Phi_\Delta^+&=\Set{\alpha_{i,j}|1\leq i<j \leq n}
\end{align*}
である.
$k<l$かつ$\Set{k,l}\neq \Set{i,i+1}$とする.
このとき,
$s_{\alpha_{i,i+1}}(\alpha_{k,l})\in\Phi_\Delta^+$であることを確かめる.
$\tau\in S_n$を$i$と$i+1$を入れ替える互換とする.
このとき, $s_{\alpha_{i,i+1}}(\alpha_{k,l})=\alpha_{\tau(k),\tau(l)}$である.
したがって, $\tau(k)<\tau(l)$を示せば良い.
$j\not\in\Set{i,i+1}$ならば, $\tau(j)=j$であるから,
$k,l\not\in\Set{i,i+1}$のときは$\tau(k)<\tau(l)$である.
$k\in\Set{i,i+1}$のときは,
$i+1< l$であるので, $\tau(k)\leq i+1<l=\tau(l)$である.
$l\in\Set{i,i+1}$のときは,
$k<i$であるので, $\tau(k)= k<i\leq \tau(l)$である.
したがって,
$s_{\alpha_{i,i+1}}(\alpha_{k,l})\in\Phi_\Delta^+$である.

$n(w)=n_{\Phi_\Delta^+}(w)$について考える.
$\sigma\in S_n$とし, $A_\sigma\in W$に対し,
$A_\sigma (\ee_k)=\ee_{\sigma(k)}$であったので,
$A_\sigma(\alpha_{i,j})=\alpha_{\sigma(i),\sigma(j)}$である.
したがって,
\begin{align*}
  \Phi_\Delta^+(A_\sigma)
  &=\Phi_\Delta^+\cap A_{\sigma^{-1}}(\Phi_\Delta^-)\\
  &=\Set{\alpha_{i,j}| i<j}\cap\Set{\alpha_{\sigma^{-1}(k),\sigma^{-1}(l)}| k>l}\\
  &=\Set{\alpha_{i,j}| i<j}\cap\Set{\alpha_{i,j}| \sigma(i)>\sigma(j)}
\end{align*}
であるので,
\begin{align*}
  n(A_\sigma)=\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j)}}
\end{align*}
である.

\subsection{$B_{n}$}
\label{ex:bn:simplereflectposi2posi}
\label{ex:bn:inversion}
$\Phi=\Phi(B_n)$とし,
\cref{ex:bn:simple}の単純系$\Delta$を用いる.
\begin{align*}
  \Delta
  &=\Set{\alpha_{1,2},\ldots,\alpha_{n-1,n}}\cup\Set{\varepsilon_{n}}\\
  \Phi_\Delta^{+}
  &=\Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\cup\Set{\varepsilon_{k}|1\leq k \leq n}\\
\end{align*}
である.
$\tau$を$i$, $i+1$を入れ替える互換とすると
\begin{align*}
s_{\alpha_{i,i+1}}(\alpha_{k,l})&=\alpha_{\tau(k),\tau(l)}\\
s_{\alpha_{i,i+1}}(\beta_{k,l})&=\beta_{\tau(k),\tau(l)}\\
s_{\alpha_{i,i+1}}(\varepsilon_{k})&=\varepsilon_{\tau(k)}
\end{align*}
であるが, $\beta_{k,l}=\beta_{l,k}$であることに注意すると,
$\alpha\in\Phi_\Delta^+\setminus\Set{\alpha_{i,i+1}}$
に対し, $s_{\alpha_{i,i+1}}(\alpha)\in\Phi_\Delta^+$
となっていることが確かめられる.
また, $k<l$に対し,
\begin{align*}
  s_{\varepsilon_{n}}(\alpha_{k,l})&=
  \begin{cases}
    \beta_{k,n} &(n=l)\\
    \alpha_{\tau(k),\tau(l)}&(n\neq l)\\
  \end{cases}\\
s_{\varepsilon_{n}}(\beta_{k,l})&=
  \begin{cases}
    \alpha_{k,n} &(n=l)\\
    \beta_{\tau(k),\tau(l)}&(n\neq l)\\
  \end{cases}\\
  s_{\varepsilon_{n}}(\varepsilon_{k})&=
  \begin{cases}
    -\varepsilon_{n} &(n=l)\\
    \varepsilon_{k}&(n\neq l)\\
  \end{cases}\\
\end{align*}
であるので,
$\alpha\in\Phi_\Delta^+\setminus\Set{\varepsilon_n}$
に対し, $s_{\varepsilon_n}(\alpha)\in\Phi_\Delta^+$
となっていることが確かめられる.

$n(w)=n_{\Phi_\Delta^+}(w)$について考える.
$z_1,\ldots,z_n\in \ZZ^\times$, $\sigma\in S_n$とし,
%$w=\diag(a_1,\ldots,a_n)A_\simga \in W$について考える.
$w=A_\sigma \diag(z_1,\ldots,z_n) \in W$に対し,
\begin{align*}
  w(\alpha_{i,j})&=
  \begin{cases}
    \alpha_{\sigma(i),\sigma(j)}&z_i=z_j=1\\
    -\alpha_{\sigma(i),\sigma(j)}=\alpha_{\sigma(j),\sigma(i)}&z_i=z_j=-1\\
    \beta_{\sigma(i),\sigma(j)}&z_i=1,z_j=-1\\
    -\beta_{\sigma(i),\sigma(j)}&z_i=-1,z_j=1
  \end{cases}\\
  w(\beta_{i,j})&=
  \begin{cases}
    \beta_{\sigma(i),\sigma(j)}&z_i=z_j=1\\
    -\beta_{\sigma(i),\sigma(j)}&z_i=z_j=-1\\
    \alpha_{\sigma(i),\sigma(j)}&z_i=1,z_j=-1\\
    -\alpha_{\sigma(i),\sigma(j)}=\alpha_{\sigma(j),\sigma(i)}&z_i=-1,z_j=1
  \end{cases}\\
  w(\varepsilon_{i})&=
  \begin{cases}
    \varepsilon_{\sigma(i)}&z_i=1\\
    -\varepsilon_{\sigma(i)}&z_i=-1
  \end{cases}
\end{align*}
である.
したがって,
\begin{align*}
  \Phi_\Delta^+(w)
  &=
  \Set{\alpha_{i,j}|i<j,\sigma(i)>\sigma(j),z_i=z_j=1}\\
  &\quad \cup\Set{\alpha_{i,j}|i<j,\sigma(i)<\sigma(j),z_i=z_j=-1}\\
  &\quad \cup\Set{\alpha_{i,j}|i<j,z_i=-1,z_j=1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,\sigma(i)<\sigma(j),z_i=-1,z_j=1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,\sigma(i)>\sigma(j),z_i=1,z_j=-1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,z_i=z_j=-1}\\
  &\quad \cup\Set{\varepsilon_{i}|z_i=-1}
\end{align*}
である.
したがって,
\begin{align*}
  n(w)
  &=\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j),z_i=z_j=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j),z_i=1,z_j=-1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)<\sigma(j),z_i=z_j=-1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)<\sigma(j),z_i=-1,z_j=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,z_i=-1,z_j=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,z_i=z_j=-1}}\\
  &\quad +\numof{\Set{i|z_i=-1}}.
\end{align*}
また,
$A_\sigma \diag(z_1,\ldots,z_n)=\diag(z_{\sigma^{-1}(1)},\ldots,z_{\sigma^{-1}(n)})A_\sigma $であったから, $a_i=z_{\sigma^{-1}(i)}$, つまり,
 $a_{\sigma(i)}=z_{i}$
とおき, $\diag(a_1,\ldots,a_n)A_\sigma\in W$に対しても計算してみると,
\begin{align*}
  w(\alpha_{i,j})&=
  \begin{cases}
    \alpha_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=a_{\sigma(j)}=1\\
    -\alpha_{\sigma(i),\sigma(j)}=\alpha_{\sigma(j),\sigma(i)}&a_{\sigma(i)}=a_{\sigma(j)}=-1\\
    \beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=1,a_{\sigma(j)}=-1\\
    -\beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=-1,a_{\sigma(j)}=1
  \end{cases}\\
  w(\beta_{i,j})&=
  \begin{cases}
    \beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=a_{\sigma(j)}=1\\
    -\beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=a_{\sigma(j)}=-1\\
    \alpha_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=1,a_{\sigma(j)}=-1\\
    -\alpha_{\sigma(i),\sigma(j)}=\alpha_{\sigma(j),\sigma(i)}&a_{\sigma(i)}=-1,a_{\sigma(j)}=1
  \end{cases}\\
  w(\varepsilon_{i})&=
  \begin{cases}
    \varepsilon_{\sigma(i)}&a_{\sigma(i)}=1\\
    -\varepsilon_{\sigma(i)}&a_{\sigma(i)}=-1
  \end{cases}
\end{align*}
となるので,
\begin{align*}
  \Phi_\Delta^+(w)
  &=
  \Set{\alpha_{i,j}|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=1}\\
  &\quad \cup\Set{\alpha_{i,j}|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=-1}\\
  &\quad \cup\Set{\alpha_{i,j}|i<j,a_{\sigma(i)}=-1,a_{\sigma(j)}=1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=-1,a_{\sigma(j)}=1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=1,a_{\sigma(j)}=-1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,a_{\sigma(i)}=a_{\sigma(j)}=-1}\\
  &\quad \cup\Set{\varepsilon_{i}|a_{\sigma(i)}=-1}\\
  n(w)
  &=\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=1,a_{\sigma(j)}=-1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=-1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=-1,a_{\sigma(j)}=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,a_{\sigma(i)}=-1,a_{\sigma(j)}=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,a_{\sigma(i)}=a_{\sigma(j)}=-1}}\\
  &\quad +\numof{\Set{i|a_{\sigma(i)}=-1}}.
\end{align*}

\subsection{$C_{n}$}
$\Phi=\Phi(C_n)$とし
\cref{ex:cn:simple}の単純系$\Delta$を考える.
$S=\Set{s_\delta|\delta\in \Delta}$とおく.
\cref{ex:bn:simple}の単純系を$\Delta'$とすると,
$\Phi_\Delta^+=\Phi_{\Delta'}^+$であり,
$S=\Set{s_\delta|\delta\in \Delta'}$である.
したがって, 
$s_\delta\in S$に対し,
$\alpha\in\Phi_\Delta^+\setminus\Set{\delta}$が
$s_{\delta}(\alpha)\in\Phi_\Delta^+$
みたすことは, 
\cref{ex:bn:simplereflectposi2posi}
と同様に確かめられる.
また, 
$\Phi_\Delta^+=\Phi_{\Delta'}^+$であるので,
$n_{\Phi_\Delta^+}(w)=n_{\Phi_{\Delta}^-}(w)$である.

\subsection{$D_{n}$}
$\Phi=\Phi(D_n)$とし
\cref{ex:dn:simple}で考えた単純系$\Delta$を考える.
$S=\Set{s_\delta|\delta\in \Delta}$とする.
$s_\delta\in S$に対し,
$\alpha\in\Phi_\Delta^+\setminus\Set{\delta}$が
$s_{\delta}(\alpha)\in\Phi_\Delta^+$
みたすことを確認する.
$\delta=\alpha_{i,i+1}$については,
\cref{ex:bn:simplereflectposi2posi}
の議論である.
$\delta=\beta_{n-1,n}$のときについて考える.
$s_{\beta_{n-1,n}}=F_{n-1}F_{n}T_{n-1,n}$
である. したがって$i<j$に対し,
\begin{align*}
  s_{\beta_{n-1,n}}(\alpha_{i,j})
  &=
  \begin{cases}
    \alpha_{i,j}&(i<j<n-1)\\
    \beta_{i,n}&(i<n-1,j=n-1)\\
    \beta_{i,n-1}&(i<n-1,j=n)\\
    \alpha_{n,n-1}=\alpha_{n-1,n}&(i=n-1,j=n)\\
  \end{cases}\\
  s_{\beta_{n-1,n}}(\beta_{i,j})
  &=
  \begin{cases}
    \beta_{i,j}&(i<j<n-1)\\
    \alpha_{i,n}&(i<n-1,j=n-1)\\
    \alpha_{i,n-1}&(i<n-1,j=n)\\
    -\beta_{n,n-1}&(i=n-1,j=n)\\
  \end{cases}
\end{align*}
である.
したがって,
$\alpha\in\Phi_\Delta^+\setminus\Set{\beta_{n-1,n}}$が
$s_{\beta_{n-1,n}}(\alpha)\in\Phi_\Delta^+$
をみたしている.

\cref{ex:bn:simplereflectposi2posi}での議論から,
$w=\diag(a_1,\ldots,a_n)A_\sigma\in W$に対して,
\begin{align*}
  w(\alpha_{i,j})&=
  \begin{cases}
    \alpha_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=a_{\sigma(j)}=1\\
    -\alpha_{\sigma(i),\sigma(j)}=\alpha_{\sigma(j),\sigma(i)}&a_{\sigma(i)}=a_{\sigma(j)}=-1\\
    \beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=1,a_{\sigma(j)}=-1\\
    -\beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=-1,a_{\sigma(j)}=1
  \end{cases}\\
  w(\beta_{i,j})&=
  \begin{cases}
    \beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=a_{\sigma(j)}=1\\
    -\beta_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=a_{\sigma(j)}=-1\\
    \alpha_{\sigma(i),\sigma(j)}&a_{\sigma(i)}=1,a_{\sigma(j)}=-1\\
    -\alpha_{\sigma(i),\sigma(j)}=\alpha_{\sigma(j),\sigma(i)}&a_{\sigma(i)}=-1,a_{\sigma(j)}=1
  \end{cases}
\end{align*}
となるので, $n_{\Phi_\Delta^+}(w)$は,
\begin{align*}
  \Phi_\Delta^+(w)
  &=
  \Set{\alpha_{i,j}|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=1}\\
  &\quad \cup\Set{\alpha_{i,j}|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=-1}\\
  &\quad \cup\Set{\alpha_{i,j}|i<j,a_{\sigma(i)}=-1,a_{\sigma(j)}=1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=-1,a_{\sigma(j)}=1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=1,a_{\sigma(j)}=-1}\\
  &\quad \cup\Set{\beta_{i,j}|i<j,a_{\sigma(i)}=a_{\sigma(j)}=-1}\\
  n(w)
  &=\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)>\sigma(j),a_{\sigma(i)}=1,a_{\sigma(j)}=-1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=a_{\sigma(j)}=-1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,\sigma(i)<\sigma(j),a_{\sigma(i)}=-1,a_{\sigma(j)}=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,a_{\sigma(i)}=-1,a_{\sigma(j)}=1}}\\
  &\quad +\numof{\Set{(i,j)|i<j,a_{\sigma(i)}=a_{\sigma(j)}=-1}}
\end{align*}
となる.


\subsection{$G_2$}
\label{ex:g2:action}
$\Phi=\Phi(G_2)$とし,
\cref{ex:g2:simple}
で考えた単純系$\Delta$を考える.
\begin{align*}
  \alpha_{i,j}&=\ee_i-\ee_j\\
  \gamma_{i}&=-3\ee_i+\sum_{k=1}^{3}\ee_k\\
  \Delta&=\Set{\alpha_{1,2},\gamma_{1}}\\
  \Phi_\Delta^+ 
&=\Set{ \alpha_{1,2},\gamma_{1}, \alpha_{3,1},\alpha_{3,2},\gamma_{2},-\gamma_3}
\end{align*}
であった. \Cref{ex:g2:root}での計算をもとに計算すると,
\begin{align*}
s_{\alpha_{1,2}}(\alpha_{3,1})&=\alpha_{3,2}
&s_{\alpha_{1,2}}(\alpha_{3,2})&=\alpha_{3,1}\\
s_{\alpha_{1,2}}(\gamma_1)&=\gamma_{2}&
s_{\alpha_{1,2}}(\gamma_2)&=\gamma_{1}\\
s_{\alpha_{1,2}}(-\gamma_3)&=-\gamma_{3}&
\end{align*}
である.  どれも$\Phi_\Delta^+$の元である.
また
\begin{align*}
  s_{\gamma_{1}}(\alpha_{1,2})&=-\alpha_{1,3}=\alpha_{3,1}
&s_{\gamma_{1}}(\alpha_{3,1})&=-\alpha_{2,1}=\alpha_{1,2}\\
s_{\gamma_{1}}(\alpha_{3,2})&=\alpha_{3,2}\\
s_{\gamma_{1}}(\gamma_2)&=-\gamma_{3}&
s_{\gamma_{1}}(-\gamma_3)&=\gamma_{2}
\end{align*}
であり, どれも$\Phi_\Delta^+$の元である.

\sectionX{章末問題}
\begin{enumerate}
\item
  \Cref{ex:an:simple}と同じ記号を用い,
  $\Phi=\Phi(A_{2})$について考える.
  このとき,
  $D_{2\cdot m}=\Braket{s_{\eta_1},s_{\eta_2}}_\ZZ$を示せ.
\item
  $m$を整数とし,
  \Cref{ex:i2m:simple}と同じ記号を用いる.
  このとき,
  $\Set{A_\sigma|\sigma\in S_3}=\Braket{s_{\alpha_{1,2}},s_{\alpha_{2,3}}}_\ZZ$を示せ.
\end{enumerate}

\chapter{高さ関数}

対称群$S_n$は隣接互換のなす集合でで生成されていた.
\cref{ex:an:simple}での単純系$\Delta$を考えると,
単純ルートに対する鏡映は隣接互換に相当していた.
ここでは,
高さと呼ばれるルートに対して決まる値を定義し,
有限鏡映群が単純ルートに対する鏡映で生成されることを示す.


\section{高さ関数}
ここでは特に断らない限り,
$\Phi$をルート系とし, $\Delta\subset\Phi$を単純系とする.
また, $\Phi^+=\Phi_\Delta^+$とする.
\begin{definition}
  $\alpha=\sum_{\delta\in\Delta}c_\delta \delta$に対し,
  $\height_\Delta(\alpha)=\sum_{\delta\in\Delta}c_\delta$と定義し,
  $\alpha$の高さと呼ぶ.
\end{definition}

しばらくの間,
$R_0=\Set{s_\alpha|\alpha\in\Delta}$,
$W_0=\Braket{R_0}_\ZZ$
とおく.
%% \begin{lemma}
%%   \label{lem:minimumhtissimple}
%%   $\beta\in\Phi^+$,
%%   $h=\min\Set{\height_\Delta(\gamma)|\gamma\in W_0(\beta)\cap \Phi^+}$とする.
%%   $\gamma\in W_0(\beta)\cap \Phi^+$が$\height_\Delta(\gamma)=h$をみたすなら,
%%   $\gamma\in\Delta$.
%% \end{lemma}
\begin{lemma}
  \label{lem:minimumhtissimple}
  $\beta\in\Phi^+$,
  $h=\min\Set{\height_\Delta(w(\beta))|w\in W_0, w(\beta)\in \Phi^+}$とおく.
  $w\in W_0(\beta)$とする.
  $w(\beta)\in\Phi^+$が$\height_\Delta(w(\beta))=h$をみたすなら,
  $w(\beta)\in\Delta$.
\end{lemma}
\begin{proof}
  $w(\beta)=\sum_{\delta\in\Delta}c_\delta\delta$とする.
  $w(\beta)\in\Phi^+$であるので,
  $c_\gamma\geq 0$である.
  \begin{align*}
    \Braket{w(\beta),w(\beta)}
    &=\Braket{w(\beta),\sum_{\delta\in\Delta}c_\delta\delta}\\
    &=\sum_{\delta\in\Delta}c_\delta\Braket{w(\beta),\delta}
  \end{align*}
  となるが, $\Braket{w(\beta),w(\beta)}>0$であるから,
  $\Braket{w(\beta),\delta}>0$となる$\delta$が存在する.
  $\alpha\in\Delta$が$\Braket{w(\beta),\alpha}>0$をみたすとする.

  $w(\beta)=\alpha$のときは$w(\beta)=\alpha\in\Delta$である.
  $w(\beta)\neq\alpha$のときについて考える.
  $s_\alpha(w(\beta))$を調べる.
  $w(\beta)\in\Phi^+\setminus\Set{\alpha}$だから,
  \cref{prop:simple:reflect:positive2positive}から
  $s_\alpha(w(\beta))\in\Phi^+$がわかる.
  また, $s_\alpha w\in W_0$である.
  一方,  
  $c=2\frac{\Braket{w(\beta),\alpha}}{\Braket{\alpha,\alpha}}$とすると,
  $c>0$であり,
  $s_\alpha(w(\beta))=w(\beta)-c\alpha$
  とかけるので,
  \begin{align*}
    \height_\Delta(s_\alpha(w(\beta)))
    =\height_\Delta(\gamma)-c < \height_\Delta(\gamma)=h
  \end{align*}
  となる.
  これは$h$の最小性に矛盾する.
\end{proof}


\begin{lemma}
  \label{lem:simpleactstrnsitive}
  $W_0(\Delta)=\Phi$
\end{lemma}
\begin{proof}
  $W_0(\Delta)\subset \Phi$は, $\Phi$がルート系であるので明白である.

  $W_0(\Delta)\supset \Phi$について考える.
  $\beta\in \Phi$とする.

  $\beta\in\Phi^+$のときについて考える.
  $h=\min\Set{\height_\Delta(w(\beta))|w\in W_0,w(\beta)\in\Phi^+}$とし,
  $w(\beta)$, $w\in W_0$が$\height_\Delta(w(\beta))=h$をみたすとする.
  $\gamma=w(\beta)$とおくと,
  \cref{lem:minimumhtissimple}より,
  $\gamma\in\Delta$である.
  したがって, $\beta=w^{-1}(\gamma)\in W_0(\Delta)$である.

  $\beta\in\Phi^-$のときは, $-\beta\in\Phi^+$であるので,
  $-\beta=w(\gamma)$をみたす$w\in W_0$と$\gamma\in\Delta$がとれる.
  $s_\gamma(\gamma)=-\gamma$であるから,
  $ws_\gamma(\gamma)=-w(\gamma)=\beta$
  となり$\beta\in W_0(\Delta)$がわかる.
\end{proof}


\begin{theorem}
  $W(\Phi)=W_0$
\end{theorem}
\begin{proof}
  $W(\Phi)\supset W_0=\Braket{R_0}_\ZZ$は,
  $R_0\subset W(\Phi)$であることから,
  明白である.

  $W(\Phi)\subset W_0$について考える.
  $\beta\in\Phi$とする.
  このとき$s_\beta\in W$, $\beta\in\Phi$だから,
  \cref{lem:simpleactstrnsitive}から,
  $\beta=w(\alpha)$をみたす
  $w\in W_0$と$\delta\in\Delta$がとれる.
  したがって,
  \begin{align*}
    s_\beta=s_{w\delta}=ws_\delta w^{-1}
  \end{align*}
  となるが, $w$も$s_\delta$も$W_0$の元だから,
  $s_\beta\in W_0$である.
  したがって, $R(\Phi)\subset W_0$であるので,
  $W(\Phi)=\Braket{R(\Phi)}_\ZZ\subset W_0$である.
\end{proof}


\section{例}

\subsection{$I_2(m)$}
$\Phi=\Phi(I_2(m))$とし,
\cref{ex:i2m:simple}で考えた単純系$\Delta$を考える.
$\Delta=\Set{\alpha_0,\alpha_{m-1}}$,
$\Phi_\Delta^+=\Set{\alpha_i|i\in\Set{0,\ldots,m-1}}$,
$\Phi_\Delta^+=\Set{\alpha_{m+i}|i\in\Set{0,\ldots,m-1}}$であった.
$S=\Set{P_0,P_{m-1}}$とする.
$P_0P_{m-1}=R_{1-m}=R_1$である.
また, $R_i=(R_1)^i$であり, $P_i=R_iP_0$であるから,
$P_i$, $R_i$はいずれも, $S$の元の積として書ける.
つまり
$D_{2\cdot m}=\Braket{S}_\ZZ$
である.

\begin{align*}
  \alpha_0&=\alpha(0)=\begin{pmatrix}0\\1\end{pmatrix}\\
  \alpha_{m-1}&=\alpha(\frac{(m-1)\pi}{m})=
  \begin{pmatrix}\sin(-\frac{(m-1)\pi}{m})\\\cos(-\frac{(m-1)\pi}{m})\end{pmatrix}=
\begin{pmatrix}\sin(-\frac{\pi}{m})\\-\cos(-\frac{\pi}{m})\end{pmatrix}
  \\
  \alpha_{i}&=\alpha(\frac{i\pi}{m})=
  \begin{pmatrix}\sin(-\frac{i\pi}{m})\\\cos(-\frac{i\pi}{m})\end{pmatrix}\\
  &=
  \frac{\sin(-\frac{i\pi}{m})}{\sin(-\frac{\pi}{m})}\alpha_{m-1}
  +
  (\cos(-\frac{i\pi}{m})+\frac{\sin(-\frac{i\pi}{m})\cos(-\frac{\pi}{m})}{\sin(-\frac{\pi}{m})})\alpha_{0}\\
  &=
  \frac{\sin(-\frac{i\pi}{m})}{\sin(-\frac{\pi}{m})}\alpha_{m-1}
  +
  (\frac{\sin(-\frac{i\pi}{m})\cos(-\frac{\pi}{m})+\cos(-\frac{i\pi}{m})\sin(-\frac{\pi}{m})}{\sin(-\frac{\pi}{m})})\alpha_{0}\\
  &=
  \frac{\sin(-\frac{i\pi}{m})}{\sin(-\frac{\pi}{m})}\alpha_{m-1}
  +
  \frac{\sin(-\frac{(1+i)\pi}{m})}{\sin(-\frac{\pi}{m})}\alpha_{0}
\end{align*}
であるので,
\begin{align*}
  \height_{\Delta}(\alpha_i)
  &=
  \frac{\sin(-\frac{i\pi}{m})}{-\sin(\frac{\pi}{m})}
  +
  \frac{\sin(-\frac{(1+i)\pi}{m})}{-\sin(\frac{\pi}{m})}\\
  &=
  \frac{\sin(-\frac{i\pi}{m})+\sin(-\frac{(1+i)\pi}{m})}{\sin(-\frac{\pi}{m})}\\
  &=
  \frac{\sin(-\frac{1}{2}(\frac{(1+i)\pi}{m}+\frac{i\pi}{m}))\cos(-\frac{1}{2}(\frac{(1+i)\pi}{m}-\frac{i\pi}{m}))}{\sin(-\frac{\pi}{m})}\\
  &=
  \frac{\sin(-\frac{(1+2i)\pi}{2m})\cos(-\frac{\pi}{2m})}{\sin(-\frac{\pi}{m})}\\
  &=
  \frac{\sin(-\frac{(1+2i)\pi}{2m})\cos(-\frac{\pi}{2m})}{2\sin(-\frac{\pi}{2m})\cos(-\frac{\pi}{2m})}\\
  &=
  \frac{\sin(-\frac{(1+2i)\pi}{2m})}{2\sin(-\frac{\pi}{2m})}.
\end{align*}
である.
$i\in \Set{0,\ldots,m-1}$で, $\height_\Delta(\alpha_i)>0$となる.
さらに,
$i\in \Set{1,\ldots,m-2}$で, $\height_\Delta(\alpha_i)>1$となる.
また,
$i\in \Set{m,\ldots,2m-1}$で, $\height_\Delta(\alpha_i)<0$となる.
$\height_\Delta(\alpha_i)$は$m$のとり方によっては, 整数ではない値をとることもある.

\subsection{$A_{1}\times\cdots\times A_{1}$}
\cref{ex:a1n:simple}で考えたルート系$\Phi$と単純系$\Delta$について考える.
$\Phi_\Delta^+=\Delta$である.
したがって, $\Phi_\Delta^-=\Set{-\delta|\delta\in\Delta}$である.
よって,
$\delta\in\Phi_\Delta^+$に対し$\height_\Delta(\delta)=1$,
$-\delta\in\Phi_\Delta^-$に対し$\height_\Delta(\delta)=-1$である.
また, $s_\alpha=s_{-\alpha}$であったから,
\begin{align*}
  R(\Phi)
  &=\Set{s_\alpha|\alpha\in\Phi}\\
  &=\Set{s_\alpha|\alpha\in\Phi_\Delta^+}\\
  &=\Set{s_\alpha|\alpha\in\Delta}
\end{align*}
である. $W(\Phi)=\Braket{R(\Phi)}_\ZZ$であったので,
$W(\Phi)$は$\Set{s_\alpha|\alpha\in\Delta}$で生成される.




\subsection{$A_{n-1}$}
\label{ex:an:simplesgens}
$\Phi=\Phi(A_{n-1})$とし,
\cref{ex:an:simple}の単純系$\Delta$を用いる.
$S=\Set{T_{i,i+1}|i\in\Set{1,\ldots,n-1}}=\Set{s_\delta|\delta\in\Delta}$
とする.
$i<j$に対し,
\begin{align*}
T_{i,i+1}T_{i+1,i+2}\cdots T_{j-2,j-1} \alpha_{j-1,j}=\alpha_{i,j}
\end{align*}
である. つまり, $\alpha_{i,j}$に対し,
$w(\alpha_{j-1,j})=\alpha_{i,j}$をみたす
$w\in \Braket{S}_\ZZ$がとれる.
したがって,
\cref{prop:conjbyortho,prop:reflgrpisortho}
から,
\begin{align*}
T_{i,j}=s_{\alpha_{i,j}}=s_{w(\alpha_{j-1,j})}=ws_{\alpha_{j-1,j}}w^{-1}=wT_{j-1,j}w^{-1}
\end{align*}
とかけるので, $T_{i,j}\in \Braket{S}_\ZZ$である.
$R(\Phi)=\Set{T_{i,j}|1\leq i<j\leq n}$であるので,
$W(\Phi)=\Braket{R(\Phi)}_\ZZ=\Braket{S}_\ZZ$である.
これは, 対称群$S_n$が隣接互換で生成されているという事実に対応する.

$k>0$に対し,
\begin{align*}
\alpha_{i,i+k}&=\alpha_{i,i+1}+\alpha_{i+1,i+2}+\cdots+\alpha_{i+k-1,i+k}\\
\alpha_{i,i-k}&=-\alpha_{i,i+1}-\alpha_{i+1,i+2}-\cdots-\alpha_{i+k-1,i+k}
\end{align*}
であるから,
$\height_\Delta(\alpha_{i,j})=j-i$
とかける.
実際,
\begin{align*}
\Delta&=\Set{\alpha_{i,j}|j=i+1}=\Set{\alpha\in\Phi|\height_\Delta(\alpha)=1}\\
\Phi_\Delta^+&=\Set{\alpha_{i,j}|j>i}=\Set{\alpha\in\Phi|\height_\Delta(\alpha)>0}\\
\Phi_\Delta^-&=\Set{\alpha_{i,j}|j<i}=\Set{\alpha\in\Phi|\height_\Delta(\alpha)<0}
\end{align*}
となっている.
この場合, $\alpha\in\Phi$に対し$\height_\Delta(\alpha)$は整数である.
また,
\begin{align*}
  \numof{\Set{\alpha\in\Phi_\Delta^+ | \height_\Delta(\alpha)=h}}
  =n-h
\end{align*}
である.
$\Phi_\Delta^+$の元を以下のように並べる:
\begin{align*}
  \begin{array}{cccccc}
    \alpha_{1,n}&\alpha_{1,n-1}&\cdots&\alpha_{1,4}&\alpha_{1,3}&\alpha_{1,2}\\
    \alpha_{2,n}&\alpha_{2,n-1}&\cdots&\alpha_{2,4}&\alpha_{2,3}\\
    \alpha_{3,n}&\alpha_{2,n-1}&\cdots&\alpha_{3,4}\\
    \vdots      &\vdots&&\\
    \alpha_{n-2,n}&\alpha_{n-2,n-1}\\
    \alpha_{n-1,n}
  \end{array}
\end{align*}
このとき, 各行の一番最後のものが, $\Delta$の元であり,
$\height_\Delta(\alpha)=1$である.
$\alpha$が$\beta$の一つ左にある場合,
もしくは
$\alpha$が$\beta$の一つ上にある場合,
$\height_\Delta(\alpha)=\height_\Delta(\beta)+1$である.


\subsection{$B_{n}$}
\label{ex:bn:simpleges}
$\Phi=\Phi(B_n)$とし,
\cref{ex:bn:simple}の単純系$\Delta$を用いる.
\begin{align*}
  \Delta
  &=\Set{\alpha_{1,2},\ldots,\alpha_{n-1,n}}\cup\Set{\varepsilon_{n}}\\
  \Phi_\Delta^{+}
  &=\Set{\alpha_{i,j},\beta_{i,j}|1\leq i<j\leq n}\cup\Set{\varepsilon_{k}|1\leq k \leq n}
\end{align*}
である.
$S=\Set{s_\delta|\delta\in\Delta}$とする.
$W(\Phi)=\Braket{S}_\ZZ$を確かめる.
$\Phi(A_{n-1})\subset\Phi(B_n)$であり,
いま考えている$\Delta$は\cref{ex:an:simplesgens}で考えた$\Phi(A_{n-1})$の単純系を含んでいるので,
$1\leq i<j\leq n$に対し,
$s_{\alpha_{i,j}}\Braket{S}_\ZZ$
であることがわかる.
また,
\begin{align*}
  s_{\alpha_{i,n}}(\varepsilon_{n})=\varepsilon_{i}
\end{align*}
となるので,
\cref{prop:conjbyortho,prop:reflgrpisortho}
から,
\begin{align*}
  s_{\varepsilon_{i}}=s_{s_{\alpha_{i,n}(\varepsilon_{n})}}=
    s_{\alpha_{i,n}}s_{\varepsilon_{n}}s_{\alpha_{i,n}}^{-1}
\end{align*}
となる.
したがって, $s_{\varepsilon_{i}}\in\Braket{S}_\ZZ$
である.
さらに, $i<j$に対し,
\begin{align*}
  s_{\varepsilon_{j}}(\alpha_{i,j})=\beta_{i,j}
\end{align*}
であるから, 同様に, 
\cref{prop:conjbyortho,prop:reflgrpisortho}
から,
$s_{\beta_{i,k}}\in\Braket{S}_\ZZ$
がわかる.
$R(\Phi)\subset \Braket{S}_\ZZ$であるから,
$W(\Phi)=\Braket{S}_\ZZ$である.


このとき, $1\leq i<j\leq n$, $1\leq k<n$に対し,
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\varepsilon_{k}&=\alpha_{k,n}+\varepsilon_{n}\\
\beta_{i,j}&=\alpha_{i,j}+2\varepsilon_{j}
\end{align*}
とかけていたので,
\begin{align*}
\height_\Delta(\alpha_{i,j})&=j-i\\
\height_\Delta(\varepsilon_{k})&=\height_\Delta(\alpha_{k,n})+\height_\Delta(\varepsilon_{n})\\
&=n-k+1\\
\height_\Delta(\beta_{i,j})&=
\height_\Delta(\alpha_{i,j})+\height_\Delta(2\varepsilon_{j})\\
&=j-i+2(n-j+1)\\
&=2n-j-i+2\\
&=(n-j+1)+(n-i+1)
\end{align*}
である.
したがって$\height_\Delta(\alpha)$は整数である.
$\alpha\in\Phi_\Delta^+$に対し, 確かに$\height_{\Delta}(\alpha)>0$である.
$\height_\Delta(\alpha_{i,j})=1$となるのは$j=i+1$のときのみであり,
$\height_\Delta(\varepsilon_{k})=1$となるのは$k=n$のときのみであることもわかる.
また
$\height_\Delta(\beta_{i,j})>1$である.
$\Phi_\Delta^+$の元を以下のように並べる:
\begin{align*}
  \begin{array}{ccccccccc}
    \beta_{1,2}&\beta_{1,3}&\cdots&\beta_{1,n}&
    \varepsilon_{1}&\alpha_{1,n}&\cdots&\alpha_{1,3}&\alpha_{1,2}\\
    &\beta_{2,3}&\cdots&\beta_{2,n}&
    \varepsilon_{2}&\alpha_{2,n}&\cdots&\alpha_{2,3}\\
    &&\ddots&\vdots&
    \vdots      &\vdots&&\\
    &&&\beta_{n-1,n}&
    \varepsilon_{n-1}&\alpha_{n-1,n}\\
    &&&&
    \varepsilon_{n}
  \end{array}
\end{align*}
このとき, 各行の一番最後のものが, $\Delta$の元であり,
$\height_\Delta(\alpha)=1$である.
$\alpha$が$\beta$の一つ左にある場合,
もしくは
$\alpha$が$\beta$の一つ上にある場合,
$\height_\Delta(\alpha)=\height_\Delta(\beta)+1$である.





\subsection{$C_{n}$}
$\Phi=\Phi(C_n)$とし
\cref{ex:cn:simple}の単純系$\Delta$を考える.
$S=\Set{s_\delta|\delta\in \Delta}$とおく.
\cref{ex:bn:simple}の単純系を$\Delta'$とすると,
$S=\Set{s_\delta|\delta\in \Delta'}$である.
したがって, 
$W(\Phi)=\Braket{S}_\ZZ$であることも,
\cref{ex:bn:simpleges}
と同様に確かめられる.

$1\leq i<j\leq n$, $1\leq k <n$に対し,
\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\beta_{k,n}&=\alpha_{k,n}+\varepsilon'_{n}\\
\beta_{i,j}&=\alpha_{i,n}+\beta_{j,n}\\
\varepsilon'_{k}&=\alpha_{i,n}+\beta_{i,n}
\end{align*}
とかける.
したがって,
\begin{align*}
\height_\Delta(\alpha_{i,j})&=j-i\\
\height_\Delta(\beta_{k,n})&=\height_\Delta(\alpha_{k,n})+\height_\Delta(\varepsilon'_{n})\\
&=n-k+1\\
\height_\Delta(\beta_{i,j})&=\height_\Delta(\alpha_{i,n})+\height_\Delta(\beta_{j,n})\\
&=n-i+n-j+1=2n-i-j+1\\
\height_\Delta(\varepsilon'_{k})&=\height_\Delta(\alpha_{i,n})+\height_\Delta(\beta_{i,n})\\
&=n-i+n-i+1=2n-2i+1
\end{align*}
である.
したがって$\height_\Delta(\alpha)$は整数である.
$\alpha\in\Phi_\Delta^+$に対し, 確かに$\height_{\Delta}(\alpha)>0$である.
$\height_\Delta(\alpha_{i,j})=1$となるのは$j=i+1$のときのみであり,
$\height_\Delta(\varepsilon_{k})=1$となるのは$k=n$のときのみであることもわかる.
また
$\height_\Delta(\beta_{i,j})>1$である.

$\Phi_\Delta^+$の元を以下のように並べる:
\begin{align*}
  \begin{array}{ccccccccc}
    \varepsilon'_{1}&\beta_{1,2}&\beta_{1,3}&\cdots&\beta_{1,n}&
    \alpha_{1,n}&\cdots&\alpha_{1,3}&\alpha_{1,2}\\
    &\varepsilon'_{2}&\beta_{2,3}&\cdots&\beta_{2,n}&
    \alpha_{2,n}&\cdots&\alpha_{2,3}\\
    &&\ddots&\ddots&
    \vdots      &\vdots&&\\
    &&&\varepsilon'_{n-1}&\beta_{n-1,n}&\alpha_{n-1,n}\\
    &&&&\varepsilon'_{n}
  \end{array}
\end{align*}
このとき, 各行の一番最後のものが, $\Delta$の元であり,
$\height_\Delta(\alpha)=1$である.
$\alpha$が$\beta$の一つ左にある場合,
もしくは
$\alpha$が$\beta$の一つ上にある場合,
$\height_\Delta(\alpha)=\height_\Delta(\beta)+1$である.

\subsection{$D_{n}$}
$\Phi=\Phi(D_n)$とし
\cref{ex:dn:simple}で考えた単純系$\Delta$を考える.
$S=\Set{s_\delta|\delta\in \Delta}$とする.

$W(\Phi)=\Braket{S}_\ZZ$であることを確認する.
$s_{\alpha_{1,2}},\ldots,s_{\alpha_{n-1,n}}\in S$
であるので$s_{\alpha_{i,j}}\in\Braket{S}_\ZZ$である.
また, $s_{\alpha_{i,j}}(\beta_{n-1,n})\in\Braket{S}_\ZZ$は
\cref{ex:bn:simpleges}
と同様に確かめられる.

\begin{align*}
\alpha_{i,j}&=\sum_{k=i}^{j-1}\alpha_{k,k+1}\\
\beta_{i,n}&=\alpha_{i,n-1}+\beta_{n-1,n}\\
\beta_{i,j}&=\alpha_{i,n}+\beta{j,n}
\end{align*}
であるので, 
\begin{align*}
  \height_\Delta(\alpha_{i,j})&=j-i\\
  \height_\Delta(\beta_{i,n})&=\height_\Delta(\alpha_{i,n-1})+\height_\Delta(\beta_{n-1,n})=n-1-i+1=n-i=2n-i-n\\
\height_\Delta(\beta_{i,j})&=\height_\Delta(\alpha_{i,n})+\height_\Delta(\beta_{j,n})=n-i+n-j=2n-i-j
\end{align*}
である. 
したがって, $\height_\Delta(\alpha)$は整数である.
また,
$\alpha\in\Phi_\Delta^+$に対し, 確かに$\height_{\Delta}(\alpha)>0$である.
$\height_\Delta(\alpha_{i,j})=1$となるのは$j=i+1$のときのみであり,
$\height_\Delta(\beta_{i,j})=1$となるのは$i=n-1,j=n$のときのみであることもわかる.

さらに,
\begin{align*}
  \height_\Delta(\alpha_{i,i+h})&=h\\
  \height_\Delta(\beta_{i,2n-i-h})&=h
\end{align*}
ともかけるので,
\begin{align*}
  &\Set{\alpha\in\Phi|\height_\Delta(\alpha)=h}\\
  &=\Set{\alpha_{i,i+h}|i\in\Set{1,\ldots,n-h}}
  \cup
  \Set{\beta_{i,2n-i-h}|1\leq i < 2n-i-h\leq n}\\
  &=\Set{\alpha_{i,i+h}|i\in\Set{1,\ldots,n-h}}
  \cup
  \Set{\beta_{i,2n-i-h}|\min\Set{1,n-h} \leq i < \frac{2n-h}{2}}
\end{align*}
である.  したがって,
$\Set{\alpha\in\Phi|\height_\Delta(\alpha)=h}$は,
$1\leq h<n$のときには,
\begin{align*}
\Set{\alpha_{i,i+h}|i\in\Set{1,\ldots,n-h}}
  \cup
  \Set{\beta_{i,2n-i-h}|n-h \leq i < n-\frac{h}{2}}
\end{align*}
であり, $n\leq h $のときには,
\begin{align*}
\Set{\beta_{i,2n-i-h}|1 \leq i < n-\frac{h}{2}}
\end{align*}
である.

\subsection{$G_2$}
$\Phi=\Phi(G_2)$とし,
\cref{ex:g2:simple}
で考えた単純系$\Delta$を考える.
\begin{align*}
  \alpha_{i,j}&=\ee_i-\ee_j\\
  \gamma_{i}&=-3\ee_i+\sum_{k=1}^{3}\ee_k\\
  \Delta&=\Set{\alpha_{1,2},\gamma_{1}}\\
  \Phi_\Delta^+ 
&=\Set{ \alpha_{1,2},\gamma_{1}, \alpha_{3,1},\alpha_{3,2},\gamma_{2},-\gamma_3}
\end{align*}
であった. \Cref{ex:g2:root}での計算をもとに計算すると,
\begin{align*}
  s_{\gamma_{1}}(\alpha_{1,2})&=\alpha_{3,1}\\
  s_{\alpha_{1,2}}s_{\gamma_{1}}(\alpha_{1,2})=
  s_{\alpha_{1,2}}(\alpha_{3,1})&=\alpha_{3,2}\\
  s_{\alpha_{1,2}}(\gamma_1)&=\gamma_{2}\\
  s_{\gamma_{1}}s_{\alpha_{1,2}}(\gamma_1)=
  s_{\gamma_{1}}(\gamma_2)&=-\gamma_{3}
\end{align*}
となる.  したがって, $\Set{s_\alpha |\alpha\in\Phi_\Delta^+}\subset\Braket{S}_\ZZ$
である.
よって, $W(\Phi)=\Braket{S}_\ZZ$である.


\cref{ex:g2:simple}での計算から,
\begin{align*}
\alpha_{3,1}&=  \gamma_{1}+\alpha_{1,2}\\
\alpha_{3,2}&=  \gamma_{1}+2\alpha_{1,2}\\
\gamma_{2}&= \gamma_{1}+3\alpha_{1,2}\\
-\gamma_3&= 2\gamma_{1}+3\alpha_{1,2}
\end{align*}
であったので,
\begin{align*}
  \height_\Delta(\alpha_{1,2})&=\height_\Delta(\beta_{1})=1\\
  \height_\Delta(\alpha_{3,1})&=  2\\
  \height_\Delta(\alpha_{3,2})&=  3\\
  \height_\Delta(\gamma_{2})&= 4\\
  \height_\Delta(-\gamma_3)&= 5
\end{align*}
であることがわかる.

\sectionX{章末問題}
\begin{enumerate}
\item
  $D_{2\cdot m}$について考える.
  \begin{enumerate}
  \item
    $D_{2\cdot m}=\Braket{\Set{P_1,P_{m-1}}}$
    を示せ.
  \item
    $\min\Set{l|P_i=S_1S_2\cdots S_l, S_i\in \Set{P_1,P_{m-1}}}$
    を求めよ.
  \item
    $\min\Set{l|R_i=S_1S_2\cdots S_l, S_i\in \Set{P_1,P_{m-1}}}$
    を求めよ.
  \end{enumerate}
\item 各$\sigma\in S_n$に対し,
    $\min\Set{l|A_\sigma=S_1S_2\cdots S_l, S_i\in \Set{T_{1,2},T_{2,3}}}$
    を求めよ.  
\end{enumerate}

\chapter{長さ関数}

有限鏡映群は単純ルートに対応する鏡映で生成されている.
有限鏡映群の元を単純ルートに対応する鏡映の積として書いたときの長さについて
ここでは考える.

\section{長さ関数}
$\Phi$をルート系, $\Delta$を単純系,
$\Phi^+=\Phi_\Delta^+$,
$\Phi^-=\Phi_\Delta^-$, $W=W(\Phi)$とする.

\begin{definition}
  $w\in W$に対し,
  \begin{align*}
    \ell_\Delta(w)=\min\Set{l|\delta_1,\ldots,\delta_l\in \Delta, w=s_{\delta_1}\cdots s_{\delta_l}}.
  \end{align*}
  とおき, $w$の長さと呼ぶ.
  ただし, $\ell_\Delta(\id)=0$とする.
\end{definition}
\begin{definition}
  $w\in W$に対し,
  \begin{align*}
    w=s_{\delta_1}\cdots s_{\delta_{\ell_\Delta(w)}},\quad (\delta_i\in \Delta)
  \end{align*}
  となる積の形を簡約表示と呼ぶ.  
\end{definition}
\begin{prop}
  $w\in W$に対し, 次が成り立つ:
  \begin{enumerate}
  \item
    \label{item:len:nilisid}
    $\ell_\Delta(w)=0 \iff w=\id$.
  \item
    \label{item:len:1issimple}
    $\ell_\Delta(w)-1 \iff \exists \delta\in\Delta$ such that $w=s_\delta$.
  \item
    \label{item:len:inversestable}
    $\ell_\Delta(w)=\ell_\Delta(w^{-1})$.
  \item
    \label{item:len:det}
    $w=s_{\delta_1}\cdots s_{\delta_l}$ ($\delta_i\in\Delta$)
    であるとき, $\det(w)=(-1)^l$.
    特に,
    $\det(w)=(-1)^{\ell_\Delta(w)}$.
  \end{enumerate}
\end{prop}
\begin{proof}
  \Cref{item:len:nilisid,item:len:1issimple}
  は$\ell_\Delta(w)$の定義から明らか.

  \Cref{item:len:inversestable}について考える.
  $w=s_1\cdots s_l$, $s_i=s_{\delta_i}$, $\delta_i\in \Delta$とすると,
  $s_i^2=\id$であるので,
  \begin{align*}
    w^{-1}
    &=s_l^{-1}\cdots s_1^{-1}
    &=s_l\cdots s_1
  \end{align*}
  である. したがって, $\ell_\Delta(w) \geq \ell_\Delta(w^{-1})$.
  また,
  $w^{-1}$からはじめて,
  同様に$\ell_\Delta(w) \leq \ell_\Delta(w^{-1})$.

  \Cref{item:len:det}について考える.
  $w=s_1\cdots s_l$, $s_i=s_{\delta_i}$, $\delta_i\in \Delta$とすると,
  \begin{align*}
    \det(w)&=\det(s_1\cdots s_{l})\\
    &=\det(s_1)\cdots \det(s_{l})\\
    &=(-1)^{l}.
  \end{align*}
\end{proof}

\begin{remark}
  $\alpha\in\Phi$に対し, $\det(s_\alpha)=-1$であるから,
  $w=s_{\alpha_1}\cdots s_{\alpha_r}=s_{\alpha'_1}\cdots s_{\alpha'_l}$
  となる$\alpha_i, \alpha'_i\in \Phi$に対し,
  $\det(w)=(-1)^r=(-1)^l$となり,
  $l$と$r$の偶奇は等しいことがわかる.
\end{remark}


$w$の表示を簡約にするにはどうしたらよいかについて考える.



\begin{lemma}
  \label{lem:formula:conjdeletion}
  $\alpha_i\in\Phi$とし,
  $w=s_{\alpha_1}\cdots s_{\alpha_r}$とする.
  $\alpha\in\Phi$とし,
  $\beta=w(\alpha)$とする.
  このと, $s_\beta w s_\alpha=w$
\end{lemma}
\begin{proof}
\cref{prop:conjbyortho,prop:reflgrpisortho}
から,
\begin{align*}
  s_\beta=ws_\alpha w^{-1}
\end{align*}
であるので,
\begin{align*}
  s_\beta w=ws_\alpha 
\end{align*}
である.
したがって,
\begin{align*}
  s_\beta w s_\alpha=ws_\alpha s_\alpha= w. 
\end{align*}
\end{proof}

\begin{lemma}
  \label{lem:deletion:primitive}
  $\delta_1,\ldots,\delta_r \in\Delta$とし,
  $w_{k,l}=s_{\delta_k}s_{\delta_{k+1}}\cdots s_{\delta_l}$
  とする, ただし, $k>l$のときには$w_{k,l}=\id$と約束する.
  $\delta_i=w_{i+1,j-1}(\delta_j)$
  を満たす $1\leq i < j \leq r$
  に対し,
  \begin{align*}
    w=w_{1,i-1}w_{i+1,j-1}w_{j+1,r}
  \end{align*}
  である.
\end{lemma}

\begin{proof}
  \cref{lem:formula:conjdeletion}
  を用いれば,
  \begin{align*}
    w_{i,j}=
    s_{\delta_i}w_{i+1,j-1}s_{\delta_j}
    =w_{i+1,j-1}
  \end{align*}
  が言えるので,
  \begin{align*}
    w=w_{1,i-1}w_{i+1,j-1}w_{j+1,r}
  \end{align*}
  である.
\end{proof}

\begin{lemma}
  \label{lem:deletion:primitive:fixed4i}
  $\delta_1,\ldots,\delta_r \in\Delta$とし,
  $w_{k,l}=s_{\delta_k}s_{\delta_{k+1}}\cdots s_{\delta_l}$
  とする, ただし, $k>l$のときには$w_{k,l}=\id$と約束する.
  $w_{1,j-1}(\delta_{j})\in\Phi^-$ならば,
  \begin{align*}
    w=w_{1,i-1}w_{i+1,j-1}w_{j+1,r}
  \end{align*}
  となる, $1\leq i < j$
  が存在する.
\end{lemma}

\begin{proof}
  $\delta_{j}\in\Delta$であるので, 
  $w_{j-1,j-1}\delta_{j}=\delta_{j}\in\Phi^+$である.
  したがって
  \begin{align*}
    \Set{i\in\Set{1,\ldots,j}|w_{i,j-1}(\delta_{j})\in\Phi^+}\neq \emptyset
  \end{align*}
  であるので,
  \begin{align*}
    i=\min\Set{i\in\Set{1,\ldots,j}|w_{i,j-1}(\delta_{j})\in\Phi^+}-1
  \end{align*}
  とおく.
  一方, $w_{1,j-1}(\delta_{j})\in\Phi^-$であるので,
  $1\leq i$である. このとき,
  $\alpha=w_{i+1,j-1}(\delta_{j})$とおくと,
  \begin{align*}
    \alpha\in \Phi^+\\
   s_{\delta_{i}} (\alpha)\in \Phi^-
  \end{align*}
  である.
  $s_{\delta_{i}}(\alpha)\in \Phi^-$かつ
  $\alpha \in \Phi^+$となるのは,
  $\alpha=\delta_i$のときのみであるので,
  $w_{i+1,j-1}(\delta_{j})=\alpha=\delta_i$である.
  したがって, \cref{lem:deletion:primitive}より,
  \begin{align*}
    w=w_{1,i-1}w_{i+1,j-1}w_{j+1,r}
  \end{align*}
  である.
\end{proof}

\begin{prop}
  \label{thm:deletionproperty}
  $\delta_1,\ldots,\delta_r \in\Delta$とし,
  $w_{k,l}=s_{\delta_k}s_{\delta_{k+1}}\cdots s_{\delta_l}$
  とする, ただし, $k>l$のときには$w_{k,l}=\id$と約束する.
  $w=s_{\delta_1}\cdots s_{\delta_r}$
  とおく.
  $r>n_{\Phi^+}(w)$ならば,
  \begin{align*}
    w=w_{1,i-1}w_{i+1,j-1}w_{j+1,r}
  \end{align*}  
  となる, $1\leq i < j \leq r$
  が存在する.
\end{prop}

\begin{proof}
  \Cref{lem:n:bruhat}から,
  \begin{align*}
    w_{1,l-1}(\delta_{l})\in\Phi^+ \implies n_{\Phi^+}(w_{1,l})=n_{\Phi^+}(w_{1,l-1})+1\\
    w_{1,l-1}(\delta_{l})\in\Phi^- \implies n_{\Phi^+}(w_{1,l})=n_{\Phi^+}(w_{1,l-1})-1
  \end{align*}
  である.  $n_{\Phi^+}(w)<r$であることから,
  \begin{align*}
    1=n_{\Phi^+}(w_{1,1})<n_{\Phi^+}(w_{1,2})<n_{\Phi^+}(w_{1,3})<\cdots<n_{\Phi^+}(w_{1,j-2})<n_{\Phi^+}(w_{1,j-1})>n_{\Phi^+}(w_{1,j})
  \end{align*}
  となる$j\leq r$が存在する.
  このとき, $w_{1,j-1}(\delta_{j})\in\Phi^-$である.
  したがって,
  \cref{lem:deletion:primitive:fixed4i}より,
  \begin{align*}
    w=w_{1,i-1}w_{i+1,j-1}w_{j+1,r}
  \end{align*}
  である.
  
\end{proof}

\begin{cor}
  \label{prop:n=l}
  $w\in W$に対し, $n(w)=\ell_\Delta(w)$.
\end{cor}
\begin{proof}
  $\delta_i\in\Delta$とし,
  $w=s_{\delta_1}\cdots s_{\delta_r}$
  であるとする.

  $r>n(w)$なら,
  \cref{thm:deletionproperty}より,  
  $\delta'_i\in\Delta$をつかって,
  $w=s_{\delta'_1}\cdots s_{\delta'_{r-2}}$とできる
  したがって, $\ell_\Delta(w) \leq n(w)$である.

  一方で,
  \cref{lem:n:bruhat}
  より,
  $w\in W$, $\delta\in \Delta$に対し
  $n(ws_\delta)\leq n(w)+1$である.
  したがって,
  \begin{align*}
    n(w)&=n(s_{\delta_1}\cdots s_{\delta_{r-1}}s_{\delta_r})\\
    &\leq n(s_{\delta_1}\cdots s_{\delta_{r-1}})+1\\
    &\vdots\\
    &\leq r.
  \end{align*}
  
\end{proof}


したがって, \cref{lem:n:bruhat}は$\ell_\Delta(w)$に読み替えられる.
\begin{theorem}
  \label{thm:l:bruhat}
  $\delta\in\Delta$, $w\in W$とする.
  このとき次が成り立つ:
  \begin{enumerate}
  \item
    $w(\delta)\in\Phi^+ \iff \ell_\Delta(ws_\delta)=\ell_\Delta(w)+1$.
  \item $w(\delta)\in\Phi^- \iff \ell_\Delta(ws_\delta)=\ell_\Delta(w)-1$.
  \item
    $w^{-1}(\delta)\in\Phi^+ \iff \ell_\Delta(s_\delta w)=\ell_\Delta(w)+1$.
  \item
    $w^{-1}(\delta)\in\Phi^- \iff \ell_\Delta(s_\delta w)=\ell_\Delta(w)-1$.
  \end{enumerate}
\end{theorem}

\begin{remark}
  \Cref{thm:deletionproperty}を繰り返し用いるだけで必ず簡約表示にたどり着く.
\end{remark}

\begin{remark}
  $\ell_\Delta(w)=n(w)=\numof{\Phi_\Delta^+(w)}$であるので,
  $\ell_\Delta(w)$, つまり簡約表示の長さ, は,
  $\Phi_{\Delta}^+(w)$を使って求められる.
  $\Phi_{\Delta}^+(w)\subset \Phi_\Delta^+$であるから,
  $\ell_\Delta(w)\leq \numof{\Phi_\Delta^+}=\frac{1}{2}\numof{\Phi}$である.
\end{remark}
\begin{definition}
  $\ell_\Delta(w)=\frac{1}{2}\numof{\Phi}$
  となる$w\in W$を$W$の最長元と呼ぶ.
\end{definition}

\begin{prop}
  $\delta_i\in\Delta$とし,
  $w_{k}=s_{\delta_1}s_{\delta_{2}}\cdots s_{\delta_k}$
  とする, ただし, $w_{0}=\id$と約束する.
  $w=w_{r}^{-1}$とする.
  $\alpha_k$を,
  \begin{align*}
    \alpha_k=w_{k-1}(\delta_{k})
  \end{align*}
  とする.
  %$\alpha_1=\delta_1$である.
  このとき,
  \begin{align*}
    \Phi^+(w)=\Set{\alpha_1,\ldots,\alpha_r}
  \end{align*}
  である.
  とくに,
  $r=\ell_\Delta(w)$ならば, 次が成り立つ:
  \begin{enumerate}
  \item
    $\Phi^+(w)=\Set{\alpha_1,\ldots,\alpha_r}$.
  \item
    $i\neq j$ならば$\alpha_i\neq \alpha_j$.
  \end{enumerate}
\end{prop}

\begin{proof}
  $\beta\in\Phi^+(w)$とする.
  定義から,
  $w_{0}^{-1}(\beta)=\beta\in\Phi^+$かつ$w_r^{-1}(\beta)=w(\beta)\in\Phi^-$である.
  したがって, $w_{i-1}^{-1}(\beta)\in \Phi^+$かつ$w_{i}^{-1}(\beta)\in \Phi^-$
  をみたす$1\leq i\leq r$が存在する.
  \begin{align*}
    w_{i}^{-1}(\beta)=(w_{i-1}s_{\delta_i})^{-1}(\beta)
    =(s_{\delta_i})^{-1}(w_{i-1})^{-1}(\beta)
    =s_{\delta_i}(w_{i-1})^{-1}(\beta)
  \end{align*}
  である.
  $(w_{i-1})^{-1}(\beta)\in \Phi^+$かつ$s_{\delta_i}(w_{i-1})^{-1}(\beta)\in\Phi^-$
  であるので,
  \cref{thm:simple:action:x}より,
  $\delta_i=(w_{i-1})^{-1}(\beta)$である.
  したがって,
  $\beta=w_{i-1}(\delta_i)=\alpha_i$である.

  
  $r=\ell_\Delta(w)$のときについて考える.
  \Cref{prop:n=l}より,
  \begin{align*}
    r=\ell_\Delta(w)=n(w)=\numof{\Phi^+(w)}
  \end{align*}
  である.
  一方で, $\Phi^+(w)\subset \Set{\alpha_1,\ldots,\alpha_r}$
  であるので,
  \begin{align*}
    \numof{\Phi^+(w)}\leq \numof{\Set{\alpha_1,\ldots,\alpha_r}}\leq r
  \end{align*}
  である.
  よって,
  $\numof{\Set{\alpha_1,\ldots,\alpha_r}}=r$であるが,
  このとき, $\alpha_k$は相異なる.

\end{proof}


\begin{prop}
  $\delta_i\in \Delta$とし, $w=s_{\delta_1}\cdots s_{\delta_r}$とする.
  $r=\ell_\Delta(w)$とする.
  $\alpha\in \Delta$が$\ell_\Delta(ws_\alpha)< \ell_\Delta(w)$をみたすとき,
  \begin{align*}
    ws_\alpha=s_{\delta_1}\cdots s_{\delta_{i-1}}s_{\delta_{i+1}}\cdots s_{\delta_{r}}
  \end{align*}
  をみたす$i$が存在する.
\end{prop}
\begin{proof}
  $\ell_\Delta(ws_\alpha)\leq \ell_\Delta(w)$であるので,
  \cref{thm:l:bruhat}から, $w(\alpha)\in\Phi^-$であることがわかる.

  また, $\delta_{r+1}=\alpha$とおくと,
  $s_{\delta_{1}}\cdots s_{\delta_{r}}(\delta_{r+1})\in \Phi^-$であるから,
  \cref{lem:deletion:primitive:fixed4i}
  より, $s_{\delta_{1}}\cdots s_{\delta_{r+1}}$には,
  \begin{align*}
    s_{\delta_{1}}\cdots s_{\delta_{r+1}}
    =s_{\delta_{1}}\cdots s_{\delta_{i-1}}
    s_{\delta_{i+1}}\cdots s_{\delta_{r}}
  \end{align*}
  をみたす$i$が存在する.
\end{proof}

\begin{cor}
$w\in W$, $\delta\in\Delta$とする.
  このとき次は同値:
  \begin{enumerate}
  \item $\ell_\Delta(ws_\delta)<\ell_\Delta(w)$
  \item $w=s_{\delta_1}\cdots s_{\delta_{i-1}}\cdot s_{\delta_{i+1}}\cdots s_{\delta_r}\cdot s_\delta$が簡約表示であるような,
    $\delta_i\in \Delta$がとれる.
  \end{enumerate}
\end{cor}


\section{例}
\label{ex:i2m:len}
\subsection{$I_2(m)$}
$\Phi=\Phi(I_2(m))$とし,
\cref{ex:i2m:simple}で考えた単純系$\Delta$を考える.
$\Delta=\Set{\alpha_0,\alpha_{m-1}}$であった.
$S=\Set{P_0,P_{m-1}=P_{-1}}$とする.
$S$の元の積を考えたとき,
$P_0P_0=\id$,
$P_{-1}P_{-1}=\id$であるので,
同じ元が並んだ場合は簡約表示ではない.
したがって,
簡約表示は,
以下のいずれかになる:
\begin{align*}
P_0P_{-1}P_0P_{-1}\cdots P_0P_{-1}&\\
P_{-1}P_0P_{-1}P_0\cdots P_{-1}P_0&\\
P_0P_{-1}P_0P_{-1}\cdots P_0P_{-1}&P_0\\
P_{-1}P_0P_{-1}P_0\cdots P_{-1}P_0&P_{-1}.
\end{align*}


$n_{\Phi_\Delta^+}(w)$については,
\cref{ex:i2m:inversion}の議論から,
\begin{align*}
  n(R_{k})&=n(R_{-k})=2k\\
  n(P_{k})&=n(P_{-1-k})=2k+1
\end{align*}
であることがわかっている.
\begin{align*}
  P_0P_{-1}&=R_1\\
  P_{-1}P_0&=R_{-1}
\end{align*}
であるので,
\begin{align*}
  (P_0P_{-1})^k&=R_k\\
  (P_{-1}P_0)^k&=R_{-k}\\
  (P_0P_{-1})^kP_0&=R_kP_0=P_{k}\\
  (P_{-1}P_0)^kP_{-1}&=R_{-k}P_{-1}=P_{-k-1}
\end{align*}
である.
したがって,
$0 \leq k\leq \frac{m}{2}$に対し,
\begin{align*}
  R_k&=(P_0P_{-1})^k\\
  R_{-k}&=(P_{-1}P_0)^k\\
  P_k&=(P_0P_{-1})^kP_0\\
  P_{-k}&=(P_{-1}P_0)^kP_{-1}
\end{align*}
は簡約表示である.


$\numof{\Phi_\Delta^+}=\frac{1}{2}\numof{\Phi}=m$である.
$m=2M$のとき,
$R_{M}=R_{-M}$であるが,
$\ell_\Delta(R_{M})=\ell_\Delta(R_{M})=m$がなりたつので,
この元が最長である.
$m=2M+1$のとき,
$P_{M}=P_{-M}$であるが,
$\ell_\Delta(R_{M})=\ell_\Delta(R_{M})=m$がなりたつので,
この元が最長である.

\subsection{$A_{1}\times\cdots\times A_{1}$}
\Cref{ex:a1n:simple}で考えたルート系$\Phi$と単純系$\Delta$について考える.
\Cref{ex:a1n:inversion}での議論から,
$w=\diag(a_1,\ldots,a_n)\in W(\Phi)$に対し,
$n_{\Phi_\Delta^+}(w)=\numof{\Set{i|a_i=-1}}$であった.
$l=n(w)$,
$\Set{i|a_i=-1}=\Set{i_1,\ldots,i_l}$とする.
このとき, $\ell_\Delta(w)=n_{\Phi_\Delta^+}(w)=l$であり,
$w=F_{i_1}\cdots F_{i_l}$
であるので, これが$w$の簡約表示である.

\subsection{$A_{n-1}$}
\label{ex:an:len}
$\Phi=\Phi(A_{n-1})$とし,
\cref{ex:an:simple}の単純系$\Delta$を用いる.
$W=W(\Phi)$とする.
\cref{ex:an:inversion}での計算により,
$\sigma\in S_n$, $w=A_\sigma\in W$に対し,
\begin{align*}
  \ell_\Delta(w)=n_{\Phi_\Delta^+}(w)=\numof{\Set{(i,j)|i<j, \sigma(i)>\sigma(j)}}
\end{align*}
である.

また,
$\omega_0\in S_n$を
\begin{align*}
\omega_0(i)=n+1-i
\end{align*}
で定義する.  このとき,
\begin{align*}
  A_{\omega_0}=
  \begin{pmatrix}
    0&\cdots&0&1\\
    0&\cdots&1&0\\
    &\vdots&&\\
    1&\cdots&0&0
  \end{pmatrix}
\end{align*}
である.  $w_0=A_{\omega_0}$とおくと,
$w_0(\alpha_{i,j})=\alpha_{j,i}=-\alpha_{i,j}$であるので,
$\Phi_\Delta^+(w)=\Phi_\Delta^+$である.
したがって, $\ell(w_0)=\frac{1}{2}\numof{\Phi}=\binom{n}{2}=\frac{n(n-1)}{2}$
であり, $w_0$は最長である.

\subsection{$B_{n}$}
\label{ex:bn:len}
$\Phi=\Phi(B_n)$とし,
\cref{ex:bn:simple}の単純系$\Delta$を用いる.
$w_0=\diag(-1,\ldots,-1)=-E_n$とすると,
$\Phi_\Delta^+(w_0)=\Phi_\Delta^+$である.
したがって, $\ell_\Delta(w_0)=\frac{1}{2}\numof{\Phi}=n^2$であり,
最長である.

\subsection{$C_{n}$}
$\Phi=\Phi(C_n)$とし,
\cref{ex:cn:simple}の単純系$\Delta$を用いる.
$W(\Phi)=W(\Phi(B_n))$
であるが,
\Cref{ex:bn:len}であつかった単純系を$\Delta'$とすると,
$\Set{s_\delta|\delta\in \Delta}=\Set{s_\delta|\delta\in \Delta'}$
であるので,
$w\in W(\Phi)$に対し,
$\ell_\Delta(w)=\ell_{\Delta'}(w)$
である.

\subsection{$D_{n}$}
$\Phi=\Phi(D_n)$とし,
\cref{ex:dn:simple}の単純系$\Delta$を用いる.
$W=W(\Phi)$とする.
$n$が偶数のとき,
$w_0=\diag(-1,\ldots,-1)\in W$である.
$w_0(\alpha_{i,n})=-\beta_{i,n}$,
$w_0(\beta_{i,n})=-\alpha_{i,n}$
である.
したがって, $\Phi_\Delta^+(w_0)=\Phi_\Delta^+$であるので,
$\ell_\Delta(w_0)=\frac{1}{2}\numof{\Phi}=n^2$であり,
最長である.
$n$が奇数のとき,
$w_0=\diag(-1,\ldots,-1,1)\in W$である.
$\Phi_\Delta^+(w_0)=\Phi_\Delta^+$である.
したがって, $\ell_\Delta(w_0)=\frac{1}{2}\numof{\Phi}=n^2$であり,
最長である.

\subsection{$G_2$}
$\Phi=\Phi(G_2)$とし,
\cref{ex:g2:simple}
で考えた単純系$\Delta$を考える.
$s=s_{\alpha_{1,2}}$, $s'=s_{\gamma_{1}}$とすると,
\Cref{ex:g2:action}で計算したとおり,
\begin{align*}
s's(\alpha_{1,2})&=-s'(\alpha_{1,2})=-(\alpha_{3,1})\\
s's(\alpha_{3,1})&=s'(\alpha_{3,2})=\alpha_{3,2}\\
s's(\alpha_{3,2})&=s'(\alpha_{3,1})=\alpha_{1,2}\\
s's(\gamma_1)&=s'(\gamma_{2})=-\gamma_{3}\\
s's(\gamma_2)&=s'(\gamma_{1})=-\gamma_1\\
s's(-\gamma_3)&=s'(-\gamma_{3})=\gamma_2
\end{align*}
である.
\begin{align*}
(s's)^3(\alpha_{1,2})&=(s's)^2(-(\alpha_{3,1}))=(s's)(-(\alpha_{3,2}))=-\alpha_{1,2}\\
(s's)^3(\alpha_{3,1})&=(s's)^2(\alpha_{3,2})=-\alpha_{3,1}\\
(s's)^3(\alpha_{3,2})&=(s's)^2(\alpha_{1,2})=-\alpha_{3,2}\\
(s's)^3(\gamma_1)&=(s's)^2(-\gamma_{3})=(s's)(\gamma_{2})=-\gamma_{1}\\
(s's)^3(\gamma_2)&=(s's)^2(-\gamma_1)=(s's)(\gamma_{3})=-\gamma_{2}\\
(s's)^3(-\gamma_3)&=(s's)^2(\gamma_2)=(s's)(-\gamma_{1})=\gamma_{3}
\end{align*}
となるので,
$(s's)^3$が最長元である.

\sectionX{章末問題}
\begin{enumerate}
\item 
$\Phi=\Phi(A_{2})$とし,
\cref{ex:an:simple}の単純系$\Delta$を用いる.
$W=W(\Phi)$とする.
  各$i$に対し, $\Set{A_\sigma\in W|\ell_\Delta(A_\sigma)=i}$を求めよ.
\item 
$\Phi=\Phi(A_{2})$とし,
\cref{ex:an:simple}の単純系$\Delta$を用いる.
\begin{enumerate}
\item 各$\sigma\in S_3$に対し,
  $\Set{\delta\in \Delta|\ell_\Delta(A_\sigma s_\delta)>\ell_\Delta(A_\sigma)}$を求めよ.
\item 各$\sigma\in S_3$に対し,
  $\Set{\delta\in \Delta|\ell_\Delta(s_\delta A_\sigma)>\ell_\Delta(A_\sigma)}$を求めよ.
\end{enumerate}

\end{enumerate}


\chapter{Bruhat order}

有限鏡映群は単純ルートに対応する鏡映で生成されている.
単純ルートに対応する鏡映の積によって誘導される半順序についてここでは定義する.

\section{Bruhat order}
$\Phi$をルート系とし, $\Delta$を単純系とし,
$W=W(\Phi)$とする.

$W_l=\Set{w\in W|\ell_\Delta(w)=l}$とおき,
$W_l$を求めることを考える.
\begin{lemma}
  $W_{l+1}\subset \Set{ws_\delta|w\in W_l,\delta\in\Delta}$である.
\end{lemma}
\begin{proof}
  $w\in W_{l+1}$とする.
  このとき,
  $w=s_{\delta_1}\cdots s_{\delta_l}s_{\delta_{l+1}}$
  を満たす$\delta_i\in\Delta$が存在するはずである.
  $w'=s_{\delta_1}\cdots s_{\delta_l}$
  とおく.
  もし$\ell_\Delta(w')<l$なら,
  $w'=s_{\delta'_1}\cdots s_{\delta'_{k}}$, $k<l$
  をみたす$\delta'_i\in\Delta$がとれるが,
  $w=w's_{l+1}=s_{\delta'_1}\cdots s_{\delta'_{k}}s_{\delta_{l+1}}$
  とかける. したがって, $\ell_\Delta(w)<l+1$となるので,
  $w\in W_{l+1}$に矛盾する.
  したがって, $w'\in W_{l}$である.
\end{proof}
\begin{cor}
  $0<l< \frac{1}{2}\numof{\Phi}$に対し,
  $W_{l+1}=\Set{ws_\delta|w\in W_l,\delta\in\Delta}\setminus W_{l-1}$.
\end{cor}
$W_{0}=\Set{\id}$, $W_{1}=\Set{s_\delta|\delta\in\Delta}$であるので,
$W_{l+1}=\Set{ws_\delta|\delta\in\Delta}\setminus W_{l-1}$を計算していくことで,
すべての$l$に対し, $W_{l}$が求められる.

\begin{definition}
  $u,w\in W$が次を満たすとき, $u\rightleq w$とする:
  つぎを満たす$\delta_1,\ldots,\delta_l\in\Delta$, $k$が存在する:
  \begin{enumerate}
    \item $0\leq k\leq l=\ell(w)$.
    \item $w=s_{\delta_1}\cdots s_{\delta_l}$.
    \item $u=s_{\delta_1}\cdots s_{\delta_k}$.
  \end{enumerate}
  $\rightleq$を右弱順序と呼ぶ.
\end{definition}
\begin{prop}
  $W$は$\rightleq$で$\ell_\Delta$をランク関数とする半順序集合になる.
\end{prop}
\begin{prop}
  $\ell_\Delta(u)+1=\ell_\Delta(w)$であるとき次は同値:
  \begin{enumerate}
  \item $u\leftleq w$
  \item $us_{\delta}= w$となる$\delta\in\Delta$が存在する.
  \end{enumerate}
\end{prop}

\begin{definition}
  $u,w\in W$が次を満たすとき, $u\leftleq w$とする:
  つぎを満たす$\delta_1,\ldots,\delta_l\in\Delta$, $k$が存在する:
  \begin{enumerate}
    \item $0\leq k\leq l=\ell(w)$.
    \item $w=s_{\delta_1}\cdots s_{\delta_l}$.
    \item $u=s_{\delta_k}\cdots s_{\delta_l}$.
  \end{enumerate}
  $\rightleq$を右弱順序と呼ぶ.
\end{definition}
\begin{prop}
  $W$は$\leftleq$で$\ell_\Delta$をランク関数とする半順序集合になる.
\end{prop}
\begin{prop}
  $\ell_\Delta(u)+1=\ell_\Delta(w)$であるとき次は同値:
  \begin{enumerate}
  \item $u\leftleq w$
  \item $s_{\delta} u= w$となる$\delta\in\Delta$が存在する.
  \end{enumerate}
\end{prop}
\begin{remark}
  $w\in W$に対し, $\varphi(w^{-1})\in W$とおくと,
  $w$は$W$上の全単射であり,
  $w,w'\in W$に対し以下は同値:
  \begin{enumerate}
    \item $w\leftleq v$
    \item $\varphi(w) \rightleq \varphi(v)$
  \end{enumerate}
\end{remark}
\begin{definition}
  $u,w\in W$が次を満たすとき, $u\strongleq w$とする:
  つぎを満たす$\delta_1,\ldots,\delta_l\in\Delta$, $i_1,\ldots,i_k$ が存在する:
  \begin{enumerate}
    \item $i_1 <\cdots <i_k\leq l$.
    \item $l=\ell(w)$.
    \item $w=s_{\delta_1}\cdots s_{\delta_l}$.
    \item $u=s_{\delta_{i_1}}\cdots s_{\delta_{i_k}}$.
  \end{enumerate}
  $\strongleq$を強ブリュア順序と呼ぶ.
\end{definition}
\begin{prop}
  $W$は$\strongleq$で$\ell_\Delta$をランク関数とする半順序集合になる.
\end{prop}

\begin{prop}
  $\ell_\Delta(u)+1=\ell_\Delta(w)$であるとき次は同値:
  \begin{enumerate}
  \item $u\strongleq w$
  \item $s_{\delta} u= w$または$s_{\delta} u= w$となる$\delta\in\Delta$が存在する.
  \end{enumerate}
\end{prop}


\section{例}
\subsection{$I_2(m)$}
$\Phi=\Phi(I_2(m))$とし,
\cref{ex:i2m:simple}で考えた単純系$\Delta$を考える.
$W=W(\Phi)$とし,
$W_l=\Set{w\in W|\ell_\Delta(w)=l}$とすると,
\cref{ex:i2m:len}での議論から,
\begin{align*}
  W_{2k}&=\Set{(P_0P_{-1})^k, (P_{-1}P_0)^k}\\
  W_{2k+1}&=\Set{(P_0P_{-1})^kP_0, (P_{-1}P_0)^kP_{-1}}\\
\end{align*}
である.
\begin{align*}
  \id \rightleq  P_0  \rightleq  P_0P_{-1} \rightleq  P_0P_{-1}P_0 \rightleq \cdots\\
  \id \rightleq  P_{-1}  \rightleq  P_{-1}P_0 \rightleq  P_{-1}P_0P_{-1} \rightleq \cdots
\end{align*}
であるが, $\ell_\Delta(u)+1=\ell_\Delta(w)$かつ$u \rightleq w$となるところに
線を引いたものを考える.
これを, $\rightleq$のHasse図と呼ぶ.
$m$が偶数のときは, 次のようになる:
\begin{align*}
  \begin{array}{clccccclc}
    &P_0P_{-1}P_0P_{-1}\cdots P_{0}P_{-1}&&&\bullet&&&P_{-1}P_0P_{-1}P_{0}\cdots P_{-1}P_0\\
    &&&&\nearrow\phantom{\bullet}\nwarrow&\\
    &P_0P_{-1}P_0P_{-1}\cdots P_{0}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}P_{0}\cdots P_{-1}\\
    &&&&\vdots\phantom{\nearrow\bullet\nwarrow}\vdots\\
    &P_0P_{-1}P_0P_{-1}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0P_{-1}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}&\\
    &&&&\nwarrow\phantom{\bullet}\nearrow&\\
    &\id &&&\bullet &&&\id
  \end{array}
\end{align*}
$m$が奇数のときは, 次のようになる:
\begin{align*}
    \begin{array}{clccccclc}
    &P_0P_{-1}P_0P_{-1}\cdots P_{-1}P_{0}&&&\bullet&&&P_{-1}P_0P_{-1}P_{0}\cdots P_{0}P_{-1}\\
    &&&&\nearrow\phantom{\bullet}\nwarrow&\\
    &P_0P_{-1}P_0P_{-1}\cdots P_{-1}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}P_{0}\cdots P_{0}\\
    &&&&\vdots\phantom{\nearrow\bullet\swarrow}\vdots\\
    &P_0P_{-1}P_0P_{-1}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0P_{-1}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}&\\
    &&&&\nwarrow\phantom{\bullet}\nearrow&\\
    &\id &&&\bullet &&&\id
  \end{array}
\end{align*}

また, 
\begin{align*}
  \id \leftleq  P_0  \leftleq  P_{-1}P_0 \leftleq  P_0P_{-1}P_0 \leftleq \cdots\\
  \id \leftleq  P_{-1}  \leftleq  P_0P_{-1} \leftleq  P_{-1}P_0P_{-1} \leftleq \cdots
\end{align*}
であるので, $\leftleq$についても同様に書くと,
$m$が偶数のときは, 次のようになる:
\begin{align*}
  \begin{array}{crcccccrc}
    &P_{-1}P_0P_{-1}\cdots P_{0}P_{-1}P_0&&&\bullet&&&P_0P_{-1}P_{0}\cdots P_{-1}P_0P_{-1}\\
    &&&&\nearrow\phantom{\bullet}\nwarrow&\\
    &P_0P_{-1}P_0P_{-1}\cdots P_{0}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_{0}P_{-1}\cdots P_0P_{-1}\\
    &&&&\vdots\phantom{\nearrow\bullet\swarrow}\vdots\\
    &P_{-1}P_0P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{0}P_{-1}P_{0}P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_{-1}P_0P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_0P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}&\\
    &&&&\nwarrow\phantom{\bullet}\nearrow&\\
    &\id &&&\bullet &&&\id
  \end{array}
\end{align*}
$m$が奇数のときは, 次のようになる:
\begin{align*}
  \begin{array}{crcccccrc}
    &P_0P_{-1}P_0P_{-1}\cdots P_{0}P_{-1}P_0&&&\bullet&&&P_{-1}P_0P_{-1}P_{0}\cdots P_{-1}P_0P_{-1}\\
    &&&&\nearrow\phantom{\bullet}\nwarrow&\\
    &P_{-1}P_0P_{-1}P_0P_{-1}\cdots P_{0}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_0P_{-1}P_{0}P_{-1}\cdots P_0P_{-1}\\
    &&&&\vdots\phantom{\nearrow\bullet\swarrow}\vdots\\
    &P_{-1}P_0P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{0}P_{-1}P_{0}P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_{-1}P_0P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_0P_{-1}\\
    &&&&\uparrow\phantom{\nearrow\,\,\nwarrow}\uparrow&\\
    &P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}&\\
    &&&&\nwarrow\phantom{\bullet}\nearrow&\\
    &\id &&&\bullet &&&\id
  \end{array}
\end{align*}


\newcommand{\xarrow}{\makebox[0pt][l]{$\nwarrow$}\nearrow}
また, $\strongleq$については, $\ell_\Delta(u)<\ell_\Delta(w)$ならば, $u\strongleq w$となるので,
$m$が偶数なら,
\begin{align*}
  \begin{array}{crcccccrc}
    &P_{-1}P_0P_{-1}\cdots P_{0}P_{-1}P_0&&&\bullet&&&P_0P_{-1}P_{0}\cdots P_{-1}P_0P_{-1}\\
    &&&&\nearrow\phantom{\bullet}\nwarrow&\\
    &P_0P_{-1}P_0P_{-1}\cdots P_{0}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_{0}P_{-1}\cdots P_0P_{-1}\\
    &&&&\vdots\phantom{\nearrow\bullet\swarrow}\vdots\\
    &P_{-1}P_0P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{0}P_{-1}P_{0}P_{-1}\\
    &&&&\uparrow\phantom{\bullet}\xarrow\phantom{\bullet}\uparrow&\\
    &P_{-1}P_0P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}\\
    &&&&\uparrow\phantom{\bullet}\xarrow\phantom{\bullet}\uparrow&\\
    &P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_0P_{-1}\\
    &&&&\uparrow\phantom{\bullet}\xarrow\phantom{\bullet}\uparrow&\\
    &P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}&\\
    &&&&\nwarrow\phantom{\bullet}\nearrow&\\
    &\id &&&\bullet &&&\id
  \end{array}
\end{align*}
$m$が奇数なら,
\begin{align*}
  \begin{array}{crcccccrc}
    &P_0P_{-1}P_0P_{-1}\cdots P_{0}P_{-1}P_0&&&\bullet&&&P_{-1}P_0P_{-1}P_{0}\cdots P_{-1}P_0P_{-1}\\
    &&&&\nearrow\phantom{\bullet}\nwarrow&\\
    &P_{-1}P_0P_{-1}P_0P_{-1}\cdots P_{0}&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_0P_{-1}P_{0}P_{-1}\cdots P_0P_{-1}\\
    &&&&\vdots\phantom{\nearrow\bullet\swarrow}\vdots\\
    &P_{-1}P_0P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{0}P_{-1}P_{0}P_{-1}\\
    &&&&\uparrow\phantom{\bullet}\xarrow\phantom{\bullet}\uparrow&\\
    &P_{-1}P_0P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}P_0P_{-1}\\
    &&&&\uparrow\phantom{\bullet}\xarrow\phantom{\bullet}\uparrow&\\
    &P_{-1}P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_0P_{-1}\\
    &&&&\uparrow\phantom{\bullet}\xarrow\phantom{\bullet}\uparrow&\\
    &P_0&&&\bullet\phantom{\nearrow\bullet\nwarrow}\bullet&&&P_{-1}&\\
    &&&&\nwarrow\phantom{\bullet}\nearrow&\\
    &\id &&&\bullet &&&\id
  \end{array}
\end{align*}
である.

\subsection{$A_{1}\times\cdots\times A_{1}$}
%\label{ex:a1n:inversion}
\Cref{ex:a1n:simple}で考えたルート系$\Phi$と単純系$\Delta$について考える.
\begin{align*}
  W(\Phi)=\Set{\diag(a_1,\ldots,a_n)|a_i\in \ZZ^\times}
\end{align*}
である.
\begin{align*}
  \diag(a_1,\ldots,a_n)\diag(b_1,\ldots,b_n)
  &=\diag(a_1b_1,\ldots,a_nb_n)\\
  &=\diag(b_1,\ldots,b_n)\diag(a_1,\ldots,a_n)
\end{align*}
であるので, $W(\Phi)$は可換群である.
したがって, $w,u\in W(\Phi)$に対し, 次は同値である:
\begin{enumerate}
  \item $u\leftleq w$.
  \item $u\rightleq w$.
  \item $u\strongleq w$.
\end{enumerate}
$W(\Phi)$の元$\diag(a_1,\ldots,a_n)$に対し,
$\Set{i |a_i=1}$を対応させる写像$f$を考えると,
$f$は$W(\Phi)$から$2^{\Set{1,\ldots,n}}$への全単射である.
また
$u\strongleq w$であることと$f(u)\subset f(w)$が同値である.



\sectionX{章末問題}
\begin{enumerate}
  \item $W(\Phi(A_1\times A_1\times A_1))$に関し, $\strongleq$のHasse図をかけ.
  \item $W(\Phi(A_2))$に関し, $\strongleq$のHasse図をかけ.
  \item $W(\Phi(A_2))$に関し, $\rightleq$のHasse図をかけ.
  \item $W(\Phi(A_2))$に関し, $\leftleq$のHasse図をかけ.
\end{enumerate}

